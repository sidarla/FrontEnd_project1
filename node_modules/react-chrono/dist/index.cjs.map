{"version":3,"file":"index.cjs","sources":["../src/utils/propMigration.ts","../node_modules/.pnpm/cssfilter@0.0.10/node_modules/cssfilter/lib/default.js","../node_modules/.pnpm/cssfilter@0.0.10/node_modules/cssfilter/lib/util.js","../node_modules/.pnpm/cssfilter@0.0.10/node_modules/cssfilter/lib/parser.js","../node_modules/.pnpm/cssfilter@0.0.10/node_modules/cssfilter/lib/css.js","../node_modules/.pnpm/cssfilter@0.0.10/node_modules/cssfilter/lib/index.js","../node_modules/.pnpm/xss@1.0.15/node_modules/xss/lib/util.js","../node_modules/.pnpm/xss@1.0.15/node_modules/xss/lib/default.js","../node_modules/.pnpm/xss@1.0.15/node_modules/xss/lib/parser.js","../node_modules/.pnpm/xss@1.0.15/node_modules/xss/lib/xss.js","../node_modules/.pnpm/xss@1.0.15/node_modules/xss/lib/index.js","../src/components/common/themes/index.ts","../src/utils/index.ts","../src/utils/validation.ts","../node_modules/.pnpm/dayjs@1.11.19/node_modules/dayjs/dayjs.min.js","../node_modules/.pnpm/use-debounce@10.0.6_react@19.2.0/node_modules/use-debounce/dist/index.module.js","../src/utils/mediaQueryUtils.ts","../src/components/effects/useMatchMedia.ts","../src/models/TimelineI18n.ts","../src/hooks/useI18n.ts","../src/utils/textResolver.ts","../src/components/contexts/TimelineContextProvider.tsx","../node_modules/.pnpm/classnames@2.5.1/node_modules/classnames/index.js","../src/components/effects/useNewScrollPosition.ts","../src/hooks/useSlideshowProgress.ts","../node_modules/.pnpm/@vanilla-extract+recipes@0.5.7_@vanilla-extract+css@1.17.5/node_modules/@vanilla-extract/recipes/dist/createRuntimeFn-62c9670f.esm.js","../node_modules/.pnpm/@vanilla-extract+private@1.0.9/node_modules/@vanilla-extract/private/dist/vanilla-extract-private.esm.js","../node_modules/.pnpm/@vanilla-extract+dynamic@2.1.5/node_modules/@vanilla-extract/dynamic/dist/vanilla-extract-dynamic.esm.js","../src/styles/theme-bridge.ts","../src/hooks/utils.ts","../src/hooks/useBackground.ts","../src/hooks/useMeasureHeight.ts","../src/hooks/useEscapeKey.ts","../src/hooks/useOutsideClick.ts","../src/hooks/useTimelineKeyboardNavigation.ts","../src/utils/timelineUtils.ts","../src/hooks/accessibility/useRovingTabIndex.ts","../src/hooks/accessibility/useAriaLiveRegion.tsx","../src/hooks/accessibility/usePrefersReducedMotion.ts","../src/hooks/useTimelineScrolling.ts","../src/hooks/useTimelineItemNavigation.ts","../src/utils/propUtils.ts","../src/hooks/useTimelineNavigation.ts","../src/hooks/useTimelineMode.ts","../src/hooks/useTimelineMedia.ts","../src/utils/throttle.ts","../src/hooks/useTimelineScroll.ts","../src/hooks/useTimelineSearch.ts","../src/hooks/useCardSize.ts","../src/hooks/useFullscreen.ts","../src/components/icons/arrow-down.tsx","../src/components/icons/check.tsx","../src/components/icons/chev-down.tsx","../src/components/icons/chev-left.tsx","../src/components/icons/chev-right.tsx","../src/components/icons/close.tsx","../src/components/icons/layout.tsx","../src/components/icons/maximize.tsx","../src/components/icons/minimize.tsx","../src/components/icons/minus.tsx","../src/components/icons/moon.tsx","../src/components/icons/plus.tsx","../src/components/icons/stop.tsx","../src/components/icons/sun.tsx","../src/components/icons/para.tsx","../src/components/icons/chevs-left.tsx","../src/components/icons/chevs-right.tsx","../src/components/icons/replay-icon.tsx","../src/components/timeline-elements/timeline-control/timeline-control.tsx","../src/components/timeline-elements/fullscreen-button/index.tsx","../src/components/timeline-elements/fullscreen-control/index.tsx","../src/components/elements/list/list-item.tsx","../src/components/elements/list/list.tsx","../src/components/elements/popover/index.tsx","../src/components/timeline/timeline-popover-elements.tsx","../src/components/timeline/timeline-toolbar.tsx","../src/components/fonts/google-fonts.ts","../src/components/fonts/font-provider.tsx","../src/components/timeline-elements/timeline-item-title/timeline-card-title.tsx","../src/components/timeline-elements/timeline-card/hooks/useTimelineCard.ts","../src/components/timeline-elements/timeline-card/timeline-point/timeline-point.tsx","../src/utils/comparison.ts","../src/components/effects/useSlideshow.ts","../src/components/timeline-elements/timeline-card-media/hooks/useMediaLoad.ts","../src/components/timeline-elements/timeline-card-media/hooks/useYouTubeDetection.ts","../src/components/timeline-elements/timeline-card-media/hooks/useToggleControls.ts","../src/components/timeline-elements/timeline-card-media/hooks/useViewOptions.ts","../src/components/timeline-elements/timeline-card-media/components/ErrorMessage.tsx","../src/components/timeline-elements/timeline-card-media/components/VideoPlayer.tsx","../src/components/timeline-elements/timeline-card-media/components/YoutubePlayer.tsx","../src/components/timeline-elements/timeline-card-media/components/ImageDisplay.tsx","../src/components/timeline-elements/timeline-card-media/components/MediaContent.tsx","../src/components/timeline-elements/memoized/title-memo.tsx","../src/components/timeline-elements/timeline-card-media/timeline-card-media-buttons.tsx","../src/components/timeline-elements/memoized/show-hide-button.tsx","../src/components/timeline-elements/memoized/expand-button-memo.tsx","../src/components/timeline-elements/memoized/subtitle-memo.tsx","../src/components/timeline-elements/memoized/details-text-memo.tsx","../src/components/timeline-elements/timeline-card-media/components/ContentDisplay.tsx","../src/components/timeline-elements/timeline-card-media/timeline-card-media.tsx","../src/components/timeline-elements/timeline-card-content/content-footer.tsx","../src/components/timeline-elements/timeline-card-content/content-header.tsx","../src/components/timeline-elements/timeline-card-content/text-or-content.tsx","../src/components/timeline-elements/timeline-card-content/details-text.tsx","../src/components/timeline-elements/nested-timeline-renderer/nested-timeline-cards.tsx","../src/components/timeline-elements/nested-timeline-renderer/nested-timeline-renderer.tsx","../src/components/timeline-elements/timeline-card-content/timeline-card-content.tsx","../src/components/timeline-elements/timeline-card/timeline-card-portal/timeline-card-portal.tsx","../src/components/timeline-elements/timeline-card/timeline-horizontal-card.tsx","../src/components/timeline-horizontal/timeline-horizontal.tsx","../src/components/timeline-vertical/timeline-point.tsx","../src/components/timeline-vertical/timeline-vertical-item.tsx","../src/components/timeline-vertical/timeline-vertical.tsx","../src/components/timeline/TimelineView.tsx","../src/components/timeline/timeline.tsx","../src/components/common/error-boundary/TimelineErrorBoundary.tsx","../src/components/index.tsx"],"sourcesContent":["/**\n * Backward compatibility utilities for migrating from old to new prop structure\n */\n\nimport {\n  TimelinePropsV2,\n  LegacyTimelineProps,\n} from '../models/TimelinePropsV2';\nimport { TimelineProps } from '../models/TimelineModel';\n\n/**\n * Maps legacy props to new grouped structure\n */\nexport function migrateLegacyProps(\n  legacyProps: TimelineProps,\n): TimelinePropsV2 {\n  const newProps: any = {\n    // Core props remain the same\n    items: legacyProps.items || [],\n    mode: mapLegacyMode(legacyProps.mode),\n    children: legacyProps.children,\n    theme: legacyProps.theme,\n    activeItemIndex: legacyProps.activeItemIndex,\n    allowDynamicUpdate: legacyProps.allowDynamicUpdate,\n    id: legacyProps.uniqueId,\n    onItemSelected: legacyProps.onItemSelected,\n    onScrollEnd: legacyProps.onScrollEnd,\n    onThemeChange: legacyProps.onThemeChange,\n    onRestartSlideshow: legacyProps.onRestartSlideshow,\n  };\n\n  // Layout configuration\n  if (hasLayoutProps(legacyProps)) {\n    newProps.layout = {\n      cardWidth: legacyProps.cardWidth,\n      cardHeight: legacyProps.cardHeight,\n      pointSize: legacyProps.timelinePointDimension,\n      lineWidth: legacyProps.lineWidth,\n      itemWidth: legacyProps.itemWidth,\n      responsive:\n        legacyProps.responsiveBreakPoint !== undefined ||\n        legacyProps.enableBreakPoint !== undefined\n          ? {\n              ...(legacyProps.responsiveBreakPoint !== undefined && {\n                breakpoint: legacyProps.responsiveBreakPoint,\n              }),\n              ...(legacyProps.enableBreakPoint !== undefined && {\n                enabled: legacyProps.enableBreakPoint,\n              }),\n            }\n          : undefined,\n      positioning:\n        mapLegacyCardPosition(legacyProps.cardPositionHorizontal) !==\n          undefined || legacyProps.flipLayout !== undefined\n          ? {\n              ...(mapLegacyCardPosition(legacyProps.cardPositionHorizontal) !==\n                undefined && {\n                cardPosition: mapLegacyCardPosition(\n                  legacyProps.cardPositionHorizontal,\n                ),\n              }),\n              ...(legacyProps.flipLayout !== undefined && {\n                flipLayout: legacyProps.flipLayout,\n              }),\n            }\n          : undefined,\n      timelineHeight: legacyProps.timelineHeight,\n    };\n  }\n\n  // Interaction configuration\n  if (hasInteractionProps(legacyProps)) {\n    newProps.interaction = {\n      ...(legacyProps.disableNavOnKey === true && {\n        keyboardNavigation: false,\n      }),\n      ...(legacyProps.disableClickOnCircle === true && { pointClick: false }),\n      ...(legacyProps.disableAutoScrollOnClick === true && {\n        autoScroll: false,\n      }),\n      ...(legacyProps.focusActiveItemOnLoad !== undefined && {\n        focusOnLoad: legacyProps.focusActiveItemOnLoad,\n      }),\n      ...(legacyProps.highlightCardsOnHover !== undefined && {\n        cardHover: legacyProps.highlightCardsOnHover,\n      }),\n      ...(legacyProps.disableInteraction !== undefined && {\n        disabled: legacyProps.disableInteraction,\n      }),\n    };\n  }\n\n  // Content configuration\n  if (hasContentProps(legacyProps)) {\n    newProps.content = {\n      allowHTML: legacyProps.parseDetailsAsHTML,\n      readMore: legacyProps.useReadMore,\n      textOverlay: legacyProps.textOverlay,\n      dateFormat: legacyProps.titleDateFormat,\n      compactText: legacyProps.textDensity === 'HIGH',\n      semanticTags: legacyProps.semanticTags\n        ? {\n            ...(legacyProps.semanticTags.cardTitle && {\n              title: legacyProps.semanticTags.cardTitle,\n            }),\n            ...(legacyProps.semanticTags.cardSubtitle && {\n              subtitle: legacyProps.semanticTags.cardSubtitle,\n            }),\n          }\n        : undefined,\n    };\n  }\n\n  // Display configuration\n  if (hasDisplayProps(legacyProps)) {\n    newProps.display = {\n      borderless: legacyProps.borderLessCards,\n      cardsDisabled: legacyProps.cardLess,\n      pointsDisabled: legacyProps.disableTimelinePoint,\n      pointShape: legacyProps.timelinePointShape,\n      allCardsVisible: legacyProps.showAllCardsHorizontal,\n      toolbar:\n        legacyProps.disableToolbar === true ||\n        legacyProps.toolbarPosition !== undefined\n          ? {\n              ...(legacyProps.disableToolbar === true && { enabled: false }),\n              ...(legacyProps.toolbarPosition !== undefined && {\n                position: legacyProps.toolbarPosition,\n              }),\n            }\n          : undefined,\n      scrollable: legacyProps.scrollable,\n    };\n  }\n\n  // Media configuration\n  if (hasMediaProps(legacyProps)) {\n    newProps.media = {\n      ...(legacyProps.mediaHeight !== undefined && {\n        height: legacyProps.mediaHeight,\n      }),\n      ...(legacyProps.mediaSettings?.align !== undefined && {\n        align: legacyProps.mediaSettings.align,\n      }),\n      ...(legacyProps.mediaSettings?.fit !== undefined && {\n        fit: legacyProps.mediaSettings.fit,\n      }),\n    };\n  }\n\n  // Animation configuration\n  if (hasAnimationProps(legacyProps)) {\n    newProps.animation = {\n      slideshow: {\n        ...(legacyProps.slideShow !== undefined && {\n          enabled: legacyProps.slideShow,\n        }),\n        ...(legacyProps.slideItemDuration !== undefined && {\n          duration: legacyProps.slideItemDuration,\n        }),\n        ...(legacyProps.slideShowType !== undefined && {\n          type: mapLegacySlideshowType(legacyProps.slideShowType),\n        }),\n        ...(legacyProps.showProgressOnSlideshow !== undefined && {\n          showProgress: legacyProps.showProgressOnSlideshow,\n        }),\n        ...(legacyProps.showOverallSlideshowProgress !== undefined && {\n          showOverallProgress: legacyProps.showOverallSlideshowProgress,\n        }),\n      },\n    };\n  }\n\n  // Style configuration\n  if (hasStyleProps(legacyProps)) {\n    newProps.style = {\n      ...(legacyProps.classNames !== undefined && {\n        classNames: legacyProps.classNames,\n      }),\n      ...(legacyProps.fontSizes !== undefined && {\n        fontSizes: legacyProps.fontSizes,\n      }),\n    };\n  }\n\n  // Accessibility configuration\n  if (hasAccessibilityProps(legacyProps)) {\n    newProps.accessibility = {\n      ...(legacyProps.buttonTexts !== undefined && {\n        buttonTexts: legacyProps.buttonTexts,\n      }),\n    };\n  }\n\n  // Dark mode configuration\n  if (\n    legacyProps.darkMode !== undefined ||\n    legacyProps.enableDarkToggle !== undefined\n  ) {\n    newProps.darkMode = {\n      ...(legacyProps.darkMode !== undefined && {\n        enabled: legacyProps.darkMode,\n      }),\n      ...(legacyProps.enableDarkToggle !== undefined && {\n        showToggle: legacyProps.enableDarkToggle,\n      }),\n    };\n  }\n\n  return newProps as TimelinePropsV2;\n}\n\n/**\n * Issues deprecation warnings for legacy props\n */\nexport function warnDeprecatedProps(props: TimelineProps): void {\n  const deprecationWarnings: string[] = [];\n\n  // Check for deprecated layout props\n  if (props.timelinePointDimension !== undefined) {\n    deprecationWarnings.push(\n      'timelinePointDimension is deprecated. Use layout.pointSize instead.',\n    );\n  }\n  if (props.cardPositionHorizontal !== undefined) {\n    deprecationWarnings.push(\n      'cardPositionHorizontal is deprecated. Use layout.positioning.cardPosition instead.',\n    );\n  }\n\n  // Check for deprecated interaction props\n  if (props.disableNavOnKey !== undefined) {\n    deprecationWarnings.push(\n      'disableNavOnKey is deprecated. Use interaction.keyboardNavigation instead.',\n    );\n  }\n  if (props.disableClickOnCircle !== undefined) {\n    deprecationWarnings.push(\n      'disableClickOnCircle is deprecated. Use interaction.pointClick instead.',\n    );\n  }\n  if (props.disableAutoScrollOnClick !== undefined) {\n    deprecationWarnings.push(\n      'disableAutoScrollOnClick is deprecated. Use interaction.autoScroll instead.',\n    );\n  }\n\n  // Check for deprecated content props\n  if (props.parseDetailsAsHTML !== undefined) {\n    deprecationWarnings.push(\n      'parseDetailsAsHTML is deprecated. Use content.allowHTML instead.',\n    );\n  }\n  if (props.textDensity !== undefined) {\n    deprecationWarnings.push(\n      'textDensity is deprecated. Use content.compactText instead.',\n    );\n  }\n\n  // Check for deprecated display props\n  if (props.borderLessCards !== undefined) {\n    deprecationWarnings.push(\n      'borderLessCards is deprecated. Use display.borderless instead.',\n    );\n  }\n  if (props.cardLess !== undefined) {\n    deprecationWarnings.push(\n      'cardLess is deprecated. Use display.cardsDisabled instead.',\n    );\n  }\n  if (props.showAllCardsHorizontal !== undefined) {\n    deprecationWarnings.push(\n      'showAllCardsHorizontal is deprecated. Use display.allCardsVisible instead.',\n    );\n  }\n\n  // Check for removed props\n  if (props.noUniqueId !== undefined) {\n    deprecationWarnings.push(\n      'noUniqueId is deprecated and no longer needed. Use the id prop if you need custom IDs.',\n    );\n  }\n  if (props.isChild !== undefined) {\n    deprecationWarnings.push(\n      'isChild is an internal prop and should not be used directly.',\n    );\n  }\n\n  // Log warnings in development\n  if (\n    process.env.NODE_ENV === 'development' &&\n    deprecationWarnings.length > 0\n  ) {\n    console.warn(\n      'React Chrono: Deprecated props detected. Please migrate to the new grouped prop structure:\\n' +\n        deprecationWarnings.map((warning) => `  • ${warning}`).join('\\n') +\n        '\\n\\nFor migration guide, visit: https://github.com/prabhuignoto/react-chrono/blob/master/MIGRATION.md',\n    );\n  }\n}\n\n// Helper functions for prop detection\n\nfunction hasLayoutProps(props: TimelineProps): boolean {\n  return !!(\n    props.cardWidth ||\n    props.cardHeight ||\n    props.timelinePointDimension ||\n    props.lineWidth ||\n    props.itemWidth ||\n    props.responsiveBreakPoint ||\n    props.enableBreakPoint ||\n    props.cardPositionHorizontal ||\n    props.flipLayout\n  );\n}\n\nfunction hasInteractionProps(props: TimelineProps): boolean {\n  return !!(\n    props.disableNavOnKey !== undefined ||\n    props.disableClickOnCircle !== undefined ||\n    props.disableAutoScrollOnClick !== undefined ||\n    props.focusActiveItemOnLoad !== undefined ||\n    props.highlightCardsOnHover !== undefined ||\n    props.disableInteraction !== undefined\n  );\n}\n\nfunction hasContentProps(props: TimelineProps): boolean {\n  return !!(\n    props.parseDetailsAsHTML !== undefined ||\n    props.useReadMore !== undefined ||\n    props.textOverlay !== undefined ||\n    props.titleDateFormat ||\n    props.textDensity ||\n    props.semanticTags\n  );\n}\n\nfunction hasDisplayProps(props: TimelineProps): boolean {\n  return !!(\n    props.borderLessCards !== undefined ||\n    props.cardLess !== undefined ||\n    props.disableTimelinePoint !== undefined ||\n    props.timelinePointShape ||\n    props.showAllCardsHorizontal !== undefined ||\n    props.disableToolbar !== undefined ||\n    props.toolbarPosition ||\n    props.scrollable !== undefined\n  );\n}\n\nfunction hasMediaProps(props: TimelineProps): boolean {\n  return !!(props.mediaHeight || props.mediaSettings);\n}\n\nfunction hasAnimationProps(props: TimelineProps): boolean {\n  return !!(\n    props.slideShow !== undefined ||\n    props.slideItemDuration ||\n    props.slideShowType ||\n    props.showProgressOnSlideshow !== undefined ||\n    props.showOverallSlideshowProgress !== undefined\n  );\n}\n\nfunction hasStyleProps(props: TimelineProps): boolean {\n  return !!(props.classNames || props.fontSizes);\n}\n\nfunction hasAccessibilityProps(props: TimelineProps): boolean {\n  return !!props.buttonTexts;\n}\n\n// Mapping functions\n\nfunction mapLegacyMode(mode?: string): TimelinePropsV2['mode'] {\n  switch (mode) {\n    case 'VERTICAL':\n      return 'vertical';\n    case 'HORIZONTAL':\n      return 'horizontal';\n    case 'VERTICAL_ALTERNATING':\n      return 'alternating';\n    case 'HORIZONTAL_ALL':\n      return 'horizontal-all';\n    default:\n      return 'alternating'; // Default mode\n  }\n}\n\nfunction mapLegacyCardPosition(\n  position?: 'TOP' | 'BOTTOM',\n): 'top' | 'bottom' | undefined {\n  switch (position) {\n    case 'TOP':\n      return 'top';\n    case 'BOTTOM':\n      return 'bottom';\n    default:\n      return undefined;\n  }\n}\n\nfunction mapLegacySlideshowType(\n  type?: string,\n): 'reveal' | 'slide' | 'fade' | undefined {\n  switch (type) {\n    case 'slide_in':\n    case 'slide_from_sides':\n      return 'slide';\n    case 'reveal':\n      return 'reveal';\n    default:\n      return 'fade';\n  }\n}\n","/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nfunction getDefaultWhiteList () {\n  // 白名单值说明：\n  // true: 允许该属性\n  // Function: function (val) { } 返回true表示允许该属性，其他值均表示不允许\n  // RegExp: regexp.test(val) 返回true表示允许该属性，其他值均表示不允许\n  // 除上面列出的值外均表示不允许\n  var whiteList = {};\n\n  whiteList['align-content'] = false; // default: auto\n  whiteList['align-items'] = false; // default: auto\n  whiteList['align-self'] = false; // default: auto\n  whiteList['alignment-adjust'] = false; // default: auto\n  whiteList['alignment-baseline'] = false; // default: baseline\n  whiteList['all'] = false; // default: depending on individual properties\n  whiteList['anchor-point'] = false; // default: none\n  whiteList['animation'] = false; // default: depending on individual properties\n  whiteList['animation-delay'] = false; // default: 0\n  whiteList['animation-direction'] = false; // default: normal\n  whiteList['animation-duration'] = false; // default: 0\n  whiteList['animation-fill-mode'] = false; // default: none\n  whiteList['animation-iteration-count'] = false; // default: 1\n  whiteList['animation-name'] = false; // default: none\n  whiteList['animation-play-state'] = false; // default: running\n  whiteList['animation-timing-function'] = false; // default: ease\n  whiteList['azimuth'] = false; // default: center\n  whiteList['backface-visibility'] = false; // default: visible\n  whiteList['background'] = true; // default: depending on individual properties\n  whiteList['background-attachment'] = true; // default: scroll\n  whiteList['background-clip'] = true; // default: border-box\n  whiteList['background-color'] = true; // default: transparent\n  whiteList['background-image'] = true; // default: none\n  whiteList['background-origin'] = true; // default: padding-box\n  whiteList['background-position'] = true; // default: 0% 0%\n  whiteList['background-repeat'] = true; // default: repeat\n  whiteList['background-size'] = true; // default: auto\n  whiteList['baseline-shift'] = false; // default: baseline\n  whiteList['binding'] = false; // default: none\n  whiteList['bleed'] = false; // default: 6pt\n  whiteList['bookmark-label'] = false; // default: content()\n  whiteList['bookmark-level'] = false; // default: none\n  whiteList['bookmark-state'] = false; // default: open\n  whiteList['border'] = true; // default: depending on individual properties\n  whiteList['border-bottom'] = true; // default: depending on individual properties\n  whiteList['border-bottom-color'] = true; // default: current color\n  whiteList['border-bottom-left-radius'] = true; // default: 0\n  whiteList['border-bottom-right-radius'] = true; // default: 0\n  whiteList['border-bottom-style'] = true; // default: none\n  whiteList['border-bottom-width'] = true; // default: medium\n  whiteList['border-collapse'] = true; // default: separate\n  whiteList['border-color'] = true; // default: depending on individual properties\n  whiteList['border-image'] = true; // default: none\n  whiteList['border-image-outset'] = true; // default: 0\n  whiteList['border-image-repeat'] = true; // default: stretch\n  whiteList['border-image-slice'] = true; // default: 100%\n  whiteList['border-image-source'] = true; // default: none\n  whiteList['border-image-width'] = true; // default: 1\n  whiteList['border-left'] = true; // default: depending on individual properties\n  whiteList['border-left-color'] = true; // default: current color\n  whiteList['border-left-style'] = true; // default: none\n  whiteList['border-left-width'] = true; // default: medium\n  whiteList['border-radius'] = true; // default: 0\n  whiteList['border-right'] = true; // default: depending on individual properties\n  whiteList['border-right-color'] = true; // default: current color\n  whiteList['border-right-style'] = true; // default: none\n  whiteList['border-right-width'] = true; // default: medium\n  whiteList['border-spacing'] = true; // default: 0\n  whiteList['border-style'] = true; // default: depending on individual properties\n  whiteList['border-top'] = true; // default: depending on individual properties\n  whiteList['border-top-color'] = true; // default: current color\n  whiteList['border-top-left-radius'] = true; // default: 0\n  whiteList['border-top-right-radius'] = true; // default: 0\n  whiteList['border-top-style'] = true; // default: none\n  whiteList['border-top-width'] = true; // default: medium\n  whiteList['border-width'] = true; // default: depending on individual properties\n  whiteList['bottom'] = false; // default: auto\n  whiteList['box-decoration-break'] = true; // default: slice\n  whiteList['box-shadow'] = true; // default: none\n  whiteList['box-sizing'] = true; // default: content-box\n  whiteList['box-snap'] = true; // default: none\n  whiteList['box-suppress'] = true; // default: show\n  whiteList['break-after'] = true; // default: auto\n  whiteList['break-before'] = true; // default: auto\n  whiteList['break-inside'] = true; // default: auto\n  whiteList['caption-side'] = false; // default: top\n  whiteList['chains'] = false; // default: none\n  whiteList['clear'] = true; // default: none\n  whiteList['clip'] = false; // default: auto\n  whiteList['clip-path'] = false; // default: none\n  whiteList['clip-rule'] = false; // default: nonzero\n  whiteList['color'] = true; // default: implementation dependent\n  whiteList['color-interpolation-filters'] = true; // default: auto\n  whiteList['column-count'] = false; // default: auto\n  whiteList['column-fill'] = false; // default: balance\n  whiteList['column-gap'] = false; // default: normal\n  whiteList['column-rule'] = false; // default: depending on individual properties\n  whiteList['column-rule-color'] = false; // default: current color\n  whiteList['column-rule-style'] = false; // default: medium\n  whiteList['column-rule-width'] = false; // default: medium\n  whiteList['column-span'] = false; // default: none\n  whiteList['column-width'] = false; // default: auto\n  whiteList['columns'] = false; // default: depending on individual properties\n  whiteList['contain'] = false; // default: none\n  whiteList['content'] = false; // default: normal\n  whiteList['counter-increment'] = false; // default: none\n  whiteList['counter-reset'] = false; // default: none\n  whiteList['counter-set'] = false; // default: none\n  whiteList['crop'] = false; // default: auto\n  whiteList['cue'] = false; // default: depending on individual properties\n  whiteList['cue-after'] = false; // default: none\n  whiteList['cue-before'] = false; // default: none\n  whiteList['cursor'] = false; // default: auto\n  whiteList['direction'] = false; // default: ltr\n  whiteList['display'] = true; // default: depending on individual properties\n  whiteList['display-inside'] = true; // default: auto\n  whiteList['display-list'] = true; // default: none\n  whiteList['display-outside'] = true; // default: inline-level\n  whiteList['dominant-baseline'] = false; // default: auto\n  whiteList['elevation'] = false; // default: level\n  whiteList['empty-cells'] = false; // default: show\n  whiteList['filter'] = false; // default: none\n  whiteList['flex'] = false; // default: depending on individual properties\n  whiteList['flex-basis'] = false; // default: auto\n  whiteList['flex-direction'] = false; // default: row\n  whiteList['flex-flow'] = false; // default: depending on individual properties\n  whiteList['flex-grow'] = false; // default: 0\n  whiteList['flex-shrink'] = false; // default: 1\n  whiteList['flex-wrap'] = false; // default: nowrap\n  whiteList['float'] = false; // default: none\n  whiteList['float-offset'] = false; // default: 0 0\n  whiteList['flood-color'] = false; // default: black\n  whiteList['flood-opacity'] = false; // default: 1\n  whiteList['flow-from'] = false; // default: none\n  whiteList['flow-into'] = false; // default: none\n  whiteList['font'] = true; // default: depending on individual properties\n  whiteList['font-family'] = true; // default: implementation dependent\n  whiteList['font-feature-settings'] = true; // default: normal\n  whiteList['font-kerning'] = true; // default: auto\n  whiteList['font-language-override'] = true; // default: normal\n  whiteList['font-size'] = true; // default: medium\n  whiteList['font-size-adjust'] = true; // default: none\n  whiteList['font-stretch'] = true; // default: normal\n  whiteList['font-style'] = true; // default: normal\n  whiteList['font-synthesis'] = true; // default: weight style\n  whiteList['font-variant'] = true; // default: normal\n  whiteList['font-variant-alternates'] = true; // default: normal\n  whiteList['font-variant-caps'] = true; // default: normal\n  whiteList['font-variant-east-asian'] = true; // default: normal\n  whiteList['font-variant-ligatures'] = true; // default: normal\n  whiteList['font-variant-numeric'] = true; // default: normal\n  whiteList['font-variant-position'] = true; // default: normal\n  whiteList['font-weight'] = true; // default: normal\n  whiteList['grid'] = false; // default: depending on individual properties\n  whiteList['grid-area'] = false; // default: depending on individual properties\n  whiteList['grid-auto-columns'] = false; // default: auto\n  whiteList['grid-auto-flow'] = false; // default: none\n  whiteList['grid-auto-rows'] = false; // default: auto\n  whiteList['grid-column'] = false; // default: depending on individual properties\n  whiteList['grid-column-end'] = false; // default: auto\n  whiteList['grid-column-start'] = false; // default: auto\n  whiteList['grid-row'] = false; // default: depending on individual properties\n  whiteList['grid-row-end'] = false; // default: auto\n  whiteList['grid-row-start'] = false; // default: auto\n  whiteList['grid-template'] = false; // default: depending on individual properties\n  whiteList['grid-template-areas'] = false; // default: none\n  whiteList['grid-template-columns'] = false; // default: none\n  whiteList['grid-template-rows'] = false; // default: none\n  whiteList['hanging-punctuation'] = false; // default: none\n  whiteList['height'] = true; // default: auto\n  whiteList['hyphens'] = false; // default: manual\n  whiteList['icon'] = false; // default: auto\n  whiteList['image-orientation'] = false; // default: auto\n  whiteList['image-resolution'] = false; // default: normal\n  whiteList['ime-mode'] = false; // default: auto\n  whiteList['initial-letters'] = false; // default: normal\n  whiteList['inline-box-align'] = false; // default: last\n  whiteList['justify-content'] = false; // default: auto\n  whiteList['justify-items'] = false; // default: auto\n  whiteList['justify-self'] = false; // default: auto\n  whiteList['left'] = false; // default: auto\n  whiteList['letter-spacing'] = true; // default: normal\n  whiteList['lighting-color'] = true; // default: white\n  whiteList['line-box-contain'] = false; // default: block inline replaced\n  whiteList['line-break'] = false; // default: auto\n  whiteList['line-grid'] = false; // default: match-parent\n  whiteList['line-height'] = false; // default: normal\n  whiteList['line-snap'] = false; // default: none\n  whiteList['line-stacking'] = false; // default: depending on individual properties\n  whiteList['line-stacking-ruby'] = false; // default: exclude-ruby\n  whiteList['line-stacking-shift'] = false; // default: consider-shifts\n  whiteList['line-stacking-strategy'] = false; // default: inline-line-height\n  whiteList['list-style'] = true; // default: depending on individual properties\n  whiteList['list-style-image'] = true; // default: none\n  whiteList['list-style-position'] = true; // default: outside\n  whiteList['list-style-type'] = true; // default: disc\n  whiteList['margin'] = true; // default: depending on individual properties\n  whiteList['margin-bottom'] = true; // default: 0\n  whiteList['margin-left'] = true; // default: 0\n  whiteList['margin-right'] = true; // default: 0\n  whiteList['margin-top'] = true; // default: 0\n  whiteList['marker-offset'] = false; // default: auto\n  whiteList['marker-side'] = false; // default: list-item\n  whiteList['marks'] = false; // default: none\n  whiteList['mask'] = false; // default: border-box\n  whiteList['mask-box'] = false; // default: see individual properties\n  whiteList['mask-box-outset'] = false; // default: 0\n  whiteList['mask-box-repeat'] = false; // default: stretch\n  whiteList['mask-box-slice'] = false; // default: 0 fill\n  whiteList['mask-box-source'] = false; // default: none\n  whiteList['mask-box-width'] = false; // default: auto\n  whiteList['mask-clip'] = false; // default: border-box\n  whiteList['mask-image'] = false; // default: none\n  whiteList['mask-origin'] = false; // default: border-box\n  whiteList['mask-position'] = false; // default: center\n  whiteList['mask-repeat'] = false; // default: no-repeat\n  whiteList['mask-size'] = false; // default: border-box\n  whiteList['mask-source-type'] = false; // default: auto\n  whiteList['mask-type'] = false; // default: luminance\n  whiteList['max-height'] = true; // default: none\n  whiteList['max-lines'] = false; // default: none\n  whiteList['max-width'] = true; // default: none\n  whiteList['min-height'] = true; // default: 0\n  whiteList['min-width'] = true; // default: 0\n  whiteList['move-to'] = false; // default: normal\n  whiteList['nav-down'] = false; // default: auto\n  whiteList['nav-index'] = false; // default: auto\n  whiteList['nav-left'] = false; // default: auto\n  whiteList['nav-right'] = false; // default: auto\n  whiteList['nav-up'] = false; // default: auto\n  whiteList['object-fit'] = false; // default: fill\n  whiteList['object-position'] = false; // default: 50% 50%\n  whiteList['opacity'] = false; // default: 1\n  whiteList['order'] = false; // default: 0\n  whiteList['orphans'] = false; // default: 2\n  whiteList['outline'] = false; // default: depending on individual properties\n  whiteList['outline-color'] = false; // default: invert\n  whiteList['outline-offset'] = false; // default: 0\n  whiteList['outline-style'] = false; // default: none\n  whiteList['outline-width'] = false; // default: medium\n  whiteList['overflow'] = false; // default: depending on individual properties\n  whiteList['overflow-wrap'] = false; // default: normal\n  whiteList['overflow-x'] = false; // default: visible\n  whiteList['overflow-y'] = false; // default: visible\n  whiteList['padding'] = true; // default: depending on individual properties\n  whiteList['padding-bottom'] = true; // default: 0\n  whiteList['padding-left'] = true; // default: 0\n  whiteList['padding-right'] = true; // default: 0\n  whiteList['padding-top'] = true; // default: 0\n  whiteList['page'] = false; // default: auto\n  whiteList['page-break-after'] = false; // default: auto\n  whiteList['page-break-before'] = false; // default: auto\n  whiteList['page-break-inside'] = false; // default: auto\n  whiteList['page-policy'] = false; // default: start\n  whiteList['pause'] = false; // default: implementation dependent\n  whiteList['pause-after'] = false; // default: implementation dependent\n  whiteList['pause-before'] = false; // default: implementation dependent\n  whiteList['perspective'] = false; // default: none\n  whiteList['perspective-origin'] = false; // default: 50% 50%\n  whiteList['pitch'] = false; // default: medium\n  whiteList['pitch-range'] = false; // default: 50\n  whiteList['play-during'] = false; // default: auto\n  whiteList['position'] = false; // default: static\n  whiteList['presentation-level'] = false; // default: 0\n  whiteList['quotes'] = false; // default: text\n  whiteList['region-fragment'] = false; // default: auto\n  whiteList['resize'] = false; // default: none\n  whiteList['rest'] = false; // default: depending on individual properties\n  whiteList['rest-after'] = false; // default: none\n  whiteList['rest-before'] = false; // default: none\n  whiteList['richness'] = false; // default: 50\n  whiteList['right'] = false; // default: auto\n  whiteList['rotation'] = false; // default: 0\n  whiteList['rotation-point'] = false; // default: 50% 50%\n  whiteList['ruby-align'] = false; // default: auto\n  whiteList['ruby-merge'] = false; // default: separate\n  whiteList['ruby-position'] = false; // default: before\n  whiteList['shape-image-threshold'] = false; // default: 0.0\n  whiteList['shape-outside'] = false; // default: none\n  whiteList['shape-margin'] = false; // default: 0\n  whiteList['size'] = false; // default: auto\n  whiteList['speak'] = false; // default: auto\n  whiteList['speak-as'] = false; // default: normal\n  whiteList['speak-header'] = false; // default: once\n  whiteList['speak-numeral'] = false; // default: continuous\n  whiteList['speak-punctuation'] = false; // default: none\n  whiteList['speech-rate'] = false; // default: medium\n  whiteList['stress'] = false; // default: 50\n  whiteList['string-set'] = false; // default: none\n  whiteList['tab-size'] = false; // default: 8\n  whiteList['table-layout'] = false; // default: auto\n  whiteList['text-align'] = true; // default: start\n  whiteList['text-align-last'] = true; // default: auto\n  whiteList['text-combine-upright'] = true; // default: none\n  whiteList['text-decoration'] = true; // default: none\n  whiteList['text-decoration-color'] = true; // default: currentColor\n  whiteList['text-decoration-line'] = true; // default: none\n  whiteList['text-decoration-skip'] = true; // default: objects\n  whiteList['text-decoration-style'] = true; // default: solid\n  whiteList['text-emphasis'] = true; // default: depending on individual properties\n  whiteList['text-emphasis-color'] = true; // default: currentColor\n  whiteList['text-emphasis-position'] = true; // default: over right\n  whiteList['text-emphasis-style'] = true; // default: none\n  whiteList['text-height'] = true; // default: auto\n  whiteList['text-indent'] = true; // default: 0\n  whiteList['text-justify'] = true; // default: auto\n  whiteList['text-orientation'] = true; // default: mixed\n  whiteList['text-overflow'] = true; // default: clip\n  whiteList['text-shadow'] = true; // default: none\n  whiteList['text-space-collapse'] = true; // default: collapse\n  whiteList['text-transform'] = true; // default: none\n  whiteList['text-underline-position'] = true; // default: auto\n  whiteList['text-wrap'] = true; // default: normal\n  whiteList['top'] = false; // default: auto\n  whiteList['transform'] = false; // default: none\n  whiteList['transform-origin'] = false; // default: 50% 50% 0\n  whiteList['transform-style'] = false; // default: flat\n  whiteList['transition'] = false; // default: depending on individual properties\n  whiteList['transition-delay'] = false; // default: 0s\n  whiteList['transition-duration'] = false; // default: 0s\n  whiteList['transition-property'] = false; // default: all\n  whiteList['transition-timing-function'] = false; // default: ease\n  whiteList['unicode-bidi'] = false; // default: normal\n  whiteList['vertical-align'] = false; // default: baseline\n  whiteList['visibility'] = false; // default: visible\n  whiteList['voice-balance'] = false; // default: center\n  whiteList['voice-duration'] = false; // default: auto\n  whiteList['voice-family'] = false; // default: implementation dependent\n  whiteList['voice-pitch'] = false; // default: medium\n  whiteList['voice-range'] = false; // default: medium\n  whiteList['voice-rate'] = false; // default: normal\n  whiteList['voice-stress'] = false; // default: normal\n  whiteList['voice-volume'] = false; // default: medium\n  whiteList['volume'] = false; // default: medium\n  whiteList['white-space'] = false; // default: normal\n  whiteList['widows'] = false; // default: 2\n  whiteList['width'] = true; // default: auto\n  whiteList['will-change'] = false; // default: auto\n  whiteList['word-break'] = true; // default: normal\n  whiteList['word-spacing'] = true; // default: normal\n  whiteList['word-wrap'] = true; // default: normal\n  whiteList['wrap-flow'] = false; // default: auto\n  whiteList['wrap-through'] = false; // default: wrap\n  whiteList['writing-mode'] = false; // default: horizontal-tb\n  whiteList['z-index'] = false; // default: auto\n\n  return whiteList;\n}\n\n\n/**\n * 匹配到白名单上的一个属性时\n *\n * @param {String} name\n * @param {String} value\n * @param {Object} options\n * @return {String}\n */\nfunction onAttr (name, value, options) {\n  // do nothing\n}\n\n/**\n * 匹配到不在白名单上的一个属性时\n *\n * @param {String} name\n * @param {String} value\n * @param {Object} options\n * @return {String}\n */\nfunction onIgnoreAttr (name, value, options) {\n  // do nothing\n}\n\nvar REGEXP_URL_JAVASCRIPT = /javascript\\s*\\:/img;\n\n/**\n * 过滤属性值\n *\n * @param {String} name\n * @param {String} value\n * @return {String}\n */\nfunction safeAttrValue(name, value) {\n  if (REGEXP_URL_JAVASCRIPT.test(value)) return '';\n  return value;\n}\n\n\nexports.whiteList = getDefaultWhiteList();\nexports.getDefaultWhiteList = getDefaultWhiteList;\nexports.onAttr = onAttr;\nexports.onIgnoreAttr = onIgnoreAttr;\nexports.safeAttrValue = safeAttrValue;\n","module.exports = {\n  indexOf: function (arr, item) {\n    var i, j;\n    if (Array.prototype.indexOf) {\n      return arr.indexOf(item);\n    }\n    for (i = 0, j = arr.length; i < j; i++) {\n      if (arr[i] === item) {\n        return i;\n      }\n    }\n    return -1;\n  },\n  forEach: function (arr, fn, scope) {\n    var i, j;\n    if (Array.prototype.forEach) {\n      return arr.forEach(fn, scope);\n    }\n    for (i = 0, j = arr.length; i < j; i++) {\n      fn.call(scope, arr[i], i, arr);\n    }\n  },\n  trim: function (str) {\n    if (String.prototype.trim) {\n      return str.trim();\n    }\n    return str.replace(/(^\\s*)|(\\s*$)/g, '');\n  },\n  trimRight: function (str) {\n    if (String.prototype.trimRight) {\n      return str.trimRight();\n    }\n    return str.replace(/(\\s*$)/g, '');\n  }\n};\n","/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar _ = require('./util');\n\n\n/**\n * 解析style\n *\n * @param {String} css\n * @param {Function} onAttr 处理属性的函数\n *   参数格式： function (sourcePosition, position, name, value, source)\n * @return {String}\n */\nfunction parseStyle (css, onAttr) {\n  css = _.trimRight(css);\n  if (css[css.length - 1] !== ';') css += ';';\n  var cssLength = css.length;\n  var isParenthesisOpen = false;\n  var lastPos = 0;\n  var i = 0;\n  var retCSS = '';\n\n  function addNewAttr () {\n    // 如果没有正常的闭合圆括号，则直接忽略当前属性\n    if (!isParenthesisOpen) {\n      var source = _.trim(css.slice(lastPos, i));\n      var j = source.indexOf(':');\n      if (j !== -1) {\n        var name = _.trim(source.slice(0, j));\n        var value = _.trim(source.slice(j + 1));\n        // 必须有属性名称\n        if (name) {\n          var ret = onAttr(lastPos, retCSS.length, name, value, source);\n          if (ret) retCSS += ret + '; ';\n        }\n      }\n    }\n    lastPos = i + 1;\n  }\n\n  for (; i < cssLength; i++) {\n    var c = css[i];\n    if (c === '/' && css[i + 1] === '*') {\n      // 备注开始\n      var j = css.indexOf('*/', i + 2);\n      // 如果没有正常的备注结束，则后面的部分全部跳过\n      if (j === -1) break;\n      // 直接将当前位置调到备注结尾，并且初始化状态\n      i = j + 1;\n      lastPos = i + 1;\n      isParenthesisOpen = false;\n    } else if (c === '(') {\n      isParenthesisOpen = true;\n    } else if (c === ')') {\n      isParenthesisOpen = false;\n    } else if (c === ';') {\n      if (isParenthesisOpen) {\n        // 在圆括号里面，忽略\n      } else {\n        addNewAttr();\n      }\n    } else if (c === '\\n') {\n      addNewAttr();\n    }\n  }\n\n  return _.trim(retCSS);\n}\n\nmodule.exports = parseStyle;\n","/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar DEFAULT = require('./default');\nvar parseStyle = require('./parser');\nvar _ = require('./util');\n\n\n/**\n * 返回值是否为空\n *\n * @param {Object} obj\n * @return {Boolean}\n */\nfunction isNull (obj) {\n  return (obj === undefined || obj === null);\n}\n\n/**\n * 浅拷贝对象\n *\n * @param {Object} obj\n * @return {Object}\n */\nfunction shallowCopyObject (obj) {\n  var ret = {};\n  for (var i in obj) {\n    ret[i] = obj[i];\n  }\n  return ret;\n}\n\n/**\n * 创建CSS过滤器\n *\n * @param {Object} options\n *   - {Object} whiteList\n *   - {Function} onAttr\n *   - {Function} onIgnoreAttr\n *   - {Function} safeAttrValue\n */\nfunction FilterCSS (options) {\n  options = shallowCopyObject(options || {});\n  options.whiteList = options.whiteList || DEFAULT.whiteList;\n  options.onAttr = options.onAttr || DEFAULT.onAttr;\n  options.onIgnoreAttr = options.onIgnoreAttr || DEFAULT.onIgnoreAttr;\n  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;\n  this.options = options;\n}\n\nFilterCSS.prototype.process = function (css) {\n  // 兼容各种奇葩输入\n  css = css || '';\n  css = css.toString();\n  if (!css) return '';\n\n  var me = this;\n  var options = me.options;\n  var whiteList = options.whiteList;\n  var onAttr = options.onAttr;\n  var onIgnoreAttr = options.onIgnoreAttr;\n  var safeAttrValue = options.safeAttrValue;\n\n  var retCSS = parseStyle(css, function (sourcePosition, position, name, value, source) {\n\n    var check = whiteList[name];\n    var isWhite = false;\n    if (check === true) isWhite = check;\n    else if (typeof check === 'function') isWhite = check(value);\n    else if (check instanceof RegExp) isWhite = check.test(value);\n    if (isWhite !== true) isWhite = false;\n\n    // 如果过滤后 value 为空则直接忽略\n    value = safeAttrValue(name, value);\n    if (!value) return;\n\n    var opts = {\n      position: position,\n      sourcePosition: sourcePosition,\n      source: source,\n      isWhite: isWhite\n    };\n\n    if (isWhite) {\n\n      var ret = onAttr(name, value, opts);\n      if (isNull(ret)) {\n        return name + ':' + value;\n      } else {\n        return ret;\n      }\n\n    } else {\n\n      var ret = onIgnoreAttr(name, value, opts);\n      if (!isNull(ret)) {\n        return ret;\n      }\n\n    }\n  });\n\n  return retCSS;\n};\n\n\nmodule.exports = FilterCSS;\n","/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar DEFAULT = require('./default');\nvar FilterCSS = require('./css');\n\n\n/**\n * XSS过滤\n *\n * @param {String} css 要过滤的CSS代码\n * @param {Object} options 选项：whiteList, onAttr, onIgnoreAttr\n * @return {String}\n */\nfunction filterCSS (html, options) {\n  var xss = new FilterCSS(options);\n  return xss.process(html);\n}\n\n\n// 输出\nexports = module.exports = filterCSS;\nexports.FilterCSS = FilterCSS;\nfor (var i in DEFAULT) exports[i] = DEFAULT[i];\n\n// 在浏览器端使用\nif (typeof window !== 'undefined') {\n  window.filterCSS = module.exports;\n}\n","module.exports = {\n  indexOf: function (arr, item) {\n    var i, j;\n    if (Array.prototype.indexOf) {\n      return arr.indexOf(item);\n    }\n    for (i = 0, j = arr.length; i < j; i++) {\n      if (arr[i] === item) {\n        return i;\n      }\n    }\n    return -1;\n  },\n  forEach: function (arr, fn, scope) {\n    var i, j;\n    if (Array.prototype.forEach) {\n      return arr.forEach(fn, scope);\n    }\n    for (i = 0, j = arr.length; i < j; i++) {\n      fn.call(scope, arr[i], i, arr);\n    }\n  },\n  trim: function (str) {\n    if (String.prototype.trim) {\n      return str.trim();\n    }\n    return str.replace(/(^\\s*)|(\\s*$)/g, \"\");\n  },\n  spaceIndex: function (str) {\n    var reg = /\\s|\\n|\\t/;\n    var match = reg.exec(str);\n    return match ? match.index : -1;\n  },\n};\n","/**\n * default settings\n *\n * @author Zongmin Lei<leizongmin@gmail.com>\n */\n\nvar FilterCSS = require(\"cssfilter\").FilterCSS;\nvar getDefaultCSSWhiteList = require(\"cssfilter\").getDefaultWhiteList;\nvar _ = require(\"./util\");\n\nfunction getDefaultWhiteList() {\n  return {\n    a: [\"target\", \"href\", \"title\"],\n    abbr: [\"title\"],\n    address: [],\n    area: [\"shape\", \"coords\", \"href\", \"alt\"],\n    article: [],\n    aside: [],\n    audio: [\n      \"autoplay\",\n      \"controls\",\n      \"crossorigin\",\n      \"loop\",\n      \"muted\",\n      \"preload\",\n      \"src\",\n    ],\n    b: [],\n    bdi: [\"dir\"],\n    bdo: [\"dir\"],\n    big: [],\n    blockquote: [\"cite\"],\n    br: [],\n    caption: [],\n    center: [],\n    cite: [],\n    code: [],\n    col: [\"align\", \"valign\", \"span\", \"width\"],\n    colgroup: [\"align\", \"valign\", \"span\", \"width\"],\n    dd: [],\n    del: [\"datetime\"],\n    details: [\"open\"],\n    div: [],\n    dl: [],\n    dt: [],\n    em: [],\n    figcaption: [],\n    figure: [],\n    font: [\"color\", \"size\", \"face\"],\n    footer: [],\n    h1: [],\n    h2: [],\n    h3: [],\n    h4: [],\n    h5: [],\n    h6: [],\n    header: [],\n    hr: [],\n    i: [],\n    img: [\"src\", \"alt\", \"title\", \"width\", \"height\", \"loading\"],\n    ins: [\"datetime\"],\n    kbd: [],\n    li: [],\n    mark: [],\n    nav: [],\n    ol: [],\n    p: [],\n    pre: [],\n    s: [],\n    section: [],\n    small: [],\n    span: [],\n    sub: [],\n    summary: [],\n    sup: [],\n    strong: [],\n    strike: [],\n    table: [\"width\", \"border\", \"align\", \"valign\"],\n    tbody: [\"align\", \"valign\"],\n    td: [\"width\", \"rowspan\", \"colspan\", \"align\", \"valign\"],\n    tfoot: [\"align\", \"valign\"],\n    th: [\"width\", \"rowspan\", \"colspan\", \"align\", \"valign\"],\n    thead: [\"align\", \"valign\"],\n    tr: [\"rowspan\", \"align\", \"valign\"],\n    tt: [],\n    u: [],\n    ul: [],\n    video: [\n      \"autoplay\",\n      \"controls\",\n      \"crossorigin\",\n      \"loop\",\n      \"muted\",\n      \"playsinline\",\n      \"poster\",\n      \"preload\",\n      \"src\",\n      \"height\",\n      \"width\",\n    ],\n  };\n}\n\nvar defaultCSSFilter = new FilterCSS();\n\n/**\n * default onTag function\n *\n * @param {String} tag\n * @param {String} html\n * @param {Object} options\n * @return {String}\n */\nfunction onTag(tag, html, options) {\n  // do nothing\n}\n\n/**\n * default onIgnoreTag function\n *\n * @param {String} tag\n * @param {String} html\n * @param {Object} options\n * @return {String}\n */\nfunction onIgnoreTag(tag, html, options) {\n  // do nothing\n}\n\n/**\n * default onTagAttr function\n *\n * @param {String} tag\n * @param {String} name\n * @param {String} value\n * @return {String}\n */\nfunction onTagAttr(tag, name, value) {\n  // do nothing\n}\n\n/**\n * default onIgnoreTagAttr function\n *\n * @param {String} tag\n * @param {String} name\n * @param {String} value\n * @return {String}\n */\nfunction onIgnoreTagAttr(tag, name, value) {\n  // do nothing\n}\n\n/**\n * default escapeHtml function\n *\n * @param {String} html\n */\nfunction escapeHtml(html) {\n  return html.replace(REGEXP_LT, \"&lt;\").replace(REGEXP_GT, \"&gt;\");\n}\n\n/**\n * default safeAttrValue function\n *\n * @param {String} tag\n * @param {String} name\n * @param {String} value\n * @param {Object} cssFilter\n * @return {String}\n */\nfunction safeAttrValue(tag, name, value, cssFilter) {\n  // unescape attribute value firstly\n  value = friendlyAttrValue(value);\n\n  if (name === \"href\" || name === \"src\") {\n    // filter `href` and `src` attribute\n    // only allow the value that starts with `http://` | `https://` | `mailto:` | `/` | `#`\n    value = _.trim(value);\n    if (value === \"#\") return \"#\";\n    if (\n      !(\n        value.substr(0, 7) === \"http://\" ||\n        value.substr(0, 8) === \"https://\" ||\n        value.substr(0, 7) === \"mailto:\" ||\n        value.substr(0, 4) === \"tel:\" ||\n        value.substr(0, 11) === \"data:image/\" ||\n        value.substr(0, 6) === \"ftp://\" ||\n        value.substr(0, 2) === \"./\" ||\n        value.substr(0, 3) === \"../\" ||\n        value[0] === \"#\" ||\n        value[0] === \"/\"\n      )\n    ) {\n      return \"\";\n    }\n  } else if (name === \"background\") {\n    // filter `background` attribute (maybe no use)\n    // `javascript:`\n    REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;\n    if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {\n      return \"\";\n    }\n  } else if (name === \"style\") {\n    // `expression()`\n    REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex = 0;\n    if (REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value)) {\n      return \"\";\n    }\n    // `url()`\n    REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex = 0;\n    if (REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)) {\n      REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;\n      if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {\n        return \"\";\n      }\n    }\n    if (cssFilter !== false) {\n      cssFilter = cssFilter || defaultCSSFilter;\n      value = cssFilter.process(value);\n    }\n  }\n\n  // escape `<>\"` before returns\n  value = escapeAttrValue(value);\n  return value;\n}\n\n// RegExp list\nvar REGEXP_LT = /</g;\nvar REGEXP_GT = />/g;\nvar REGEXP_QUOTE = /\"/g;\nvar REGEXP_QUOTE_2 = /&quot;/g;\nvar REGEXP_ATTR_VALUE_1 = /&#([a-zA-Z0-9]*);?/gim;\nvar REGEXP_ATTR_VALUE_COLON = /&colon;?/gim;\nvar REGEXP_ATTR_VALUE_NEWLINE = /&newline;?/gim;\n// var REGEXP_DEFAULT_ON_TAG_ATTR_3 = /\\/\\*|\\*\\//gm;\nvar REGEXP_DEFAULT_ON_TAG_ATTR_4 =\n  /((j\\s*a\\s*v\\s*a|v\\s*b|l\\s*i\\s*v\\s*e)\\s*s\\s*c\\s*r\\s*i\\s*p\\s*t\\s*|m\\s*o\\s*c\\s*h\\s*a):/gi;\n// var REGEXP_DEFAULT_ON_TAG_ATTR_5 = /^[\\s\"'`]*(d\\s*a\\s*t\\s*a\\s*)\\:/gi;\n// var REGEXP_DEFAULT_ON_TAG_ATTR_6 = /^[\\s\"'`]*(d\\s*a\\s*t\\s*a\\s*)\\:\\s*image\\//gi;\nvar REGEXP_DEFAULT_ON_TAG_ATTR_7 =\n  /e\\s*x\\s*p\\s*r\\s*e\\s*s\\s*s\\s*i\\s*o\\s*n\\s*\\(.*/gi;\nvar REGEXP_DEFAULT_ON_TAG_ATTR_8 = /u\\s*r\\s*l\\s*\\(.*/gi;\n\n/**\n * escape double quote\n *\n * @param {String} str\n * @return {String} str\n */\nfunction escapeQuote(str) {\n  return str.replace(REGEXP_QUOTE, \"&quot;\");\n}\n\n/**\n * unescape double quote\n *\n * @param {String} str\n * @return {String} str\n */\nfunction unescapeQuote(str) {\n  return str.replace(REGEXP_QUOTE_2, '\"');\n}\n\n/**\n * escape html entities\n *\n * @param {String} str\n * @return {String}\n */\nfunction escapeHtmlEntities(str) {\n  return str.replace(REGEXP_ATTR_VALUE_1, function replaceUnicode(str, code) {\n    return code[0] === \"x\" || code[0] === \"X\"\n      ? String.fromCharCode(parseInt(code.substr(1), 16))\n      : String.fromCharCode(parseInt(code, 10));\n  });\n}\n\n/**\n * escape html5 new danger entities\n *\n * @param {String} str\n * @return {String}\n */\nfunction escapeDangerHtml5Entities(str) {\n  return str\n    .replace(REGEXP_ATTR_VALUE_COLON, \":\")\n    .replace(REGEXP_ATTR_VALUE_NEWLINE, \" \");\n}\n\n/**\n * clear nonprintable characters\n *\n * @param {String} str\n * @return {String}\n */\nfunction clearNonPrintableCharacter(str) {\n  var str2 = \"\";\n  for (var i = 0, len = str.length; i < len; i++) {\n    str2 += str.charCodeAt(i) < 32 ? \" \" : str.charAt(i);\n  }\n  return _.trim(str2);\n}\n\n/**\n * get friendly attribute value\n *\n * @param {String} str\n * @return {String}\n */\nfunction friendlyAttrValue(str) {\n  str = unescapeQuote(str);\n  str = escapeHtmlEntities(str);\n  str = escapeDangerHtml5Entities(str);\n  str = clearNonPrintableCharacter(str);\n  return str;\n}\n\n/**\n * unescape attribute value\n *\n * @param {String} str\n * @return {String}\n */\nfunction escapeAttrValue(str) {\n  str = escapeQuote(str);\n  str = escapeHtml(str);\n  return str;\n}\n\n/**\n * `onIgnoreTag` function for removing all the tags that are not in whitelist\n */\nfunction onIgnoreTagStripAll() {\n  return \"\";\n}\n\n/**\n * remove tag body\n * specify a `tags` list, if the tag is not in the `tags` list then process by the specify function (optional)\n *\n * @param {array} tags\n * @param {function} next\n */\nfunction StripTagBody(tags, next) {\n  if (typeof next !== \"function\") {\n    next = function () {};\n  }\n\n  var isRemoveAllTag = !Array.isArray(tags);\n  function isRemoveTag(tag) {\n    if (isRemoveAllTag) return true;\n    return _.indexOf(tags, tag) !== -1;\n  }\n\n  var removeList = [];\n  var posStart = false;\n\n  return {\n    onIgnoreTag: function (tag, html, options) {\n      if (isRemoveTag(tag)) {\n        if (options.isClosing) {\n          var ret = \"[/removed]\";\n          var end = options.position + ret.length;\n          removeList.push([\n            posStart !== false ? posStart : options.position,\n            end,\n          ]);\n          posStart = false;\n          return ret;\n        } else {\n          if (!posStart) {\n            posStart = options.position;\n          }\n          return \"[removed]\";\n        }\n      } else {\n        return next(tag, html, options);\n      }\n    },\n    remove: function (html) {\n      var rethtml = \"\";\n      var lastPos = 0;\n      _.forEach(removeList, function (pos) {\n        rethtml += html.slice(lastPos, pos[0]);\n        lastPos = pos[1];\n      });\n      rethtml += html.slice(lastPos);\n      return rethtml;\n    },\n  };\n}\n\n/**\n * remove html comments\n *\n * @param {String} html\n * @return {String}\n */\nfunction stripCommentTag(html) {\n  var retHtml = \"\";\n  var lastPos = 0;\n  while (lastPos < html.length) {\n    var i = html.indexOf(\"<!--\", lastPos);\n    if (i === -1) {\n      retHtml += html.slice(lastPos);\n      break;\n    }\n    retHtml += html.slice(lastPos, i);\n    var j = html.indexOf(\"-->\", i);\n    if (j === -1) {\n      break;\n    }\n    lastPos = j + 3;\n  }\n  return retHtml;\n}\n\n/**\n * remove invisible characters\n *\n * @param {String} html\n * @return {String}\n */\nfunction stripBlankChar(html) {\n  var chars = html.split(\"\");\n  chars = chars.filter(function (char) {\n    var c = char.charCodeAt(0);\n    if (c === 127) return false;\n    if (c <= 31) {\n      if (c === 10 || c === 13) return true;\n      return false;\n    }\n    return true;\n  });\n  return chars.join(\"\");\n}\n\nexports.whiteList = getDefaultWhiteList();\nexports.getDefaultWhiteList = getDefaultWhiteList;\nexports.onTag = onTag;\nexports.onIgnoreTag = onIgnoreTag;\nexports.onTagAttr = onTagAttr;\nexports.onIgnoreTagAttr = onIgnoreTagAttr;\nexports.safeAttrValue = safeAttrValue;\nexports.escapeHtml = escapeHtml;\nexports.escapeQuote = escapeQuote;\nexports.unescapeQuote = unescapeQuote;\nexports.escapeHtmlEntities = escapeHtmlEntities;\nexports.escapeDangerHtml5Entities = escapeDangerHtml5Entities;\nexports.clearNonPrintableCharacter = clearNonPrintableCharacter;\nexports.friendlyAttrValue = friendlyAttrValue;\nexports.escapeAttrValue = escapeAttrValue;\nexports.onIgnoreTagStripAll = onIgnoreTagStripAll;\nexports.StripTagBody = StripTagBody;\nexports.stripCommentTag = stripCommentTag;\nexports.stripBlankChar = stripBlankChar;\nexports.attributeWrapSign = '\"';\nexports.cssFilter = defaultCSSFilter;\nexports.getDefaultCSSWhiteList = getDefaultCSSWhiteList;\n","/**\n * Simple HTML Parser\n *\n * @author Zongmin Lei<leizongmin@gmail.com>\n */\n\nvar _ = require(\"./util\");\n\n/**\n * get tag name\n *\n * @param {String} html e.g. '<a hef=\"#\">'\n * @return {String}\n */\nfunction getTagName(html) {\n  var i = _.spaceIndex(html);\n  var tagName;\n  if (i === -1) {\n    tagName = html.slice(1, -1);\n  } else {\n    tagName = html.slice(1, i + 1);\n  }\n  tagName = _.trim(tagName).toLowerCase();\n  if (tagName.slice(0, 1) === \"/\") tagName = tagName.slice(1);\n  if (tagName.slice(-1) === \"/\") tagName = tagName.slice(0, -1);\n  return tagName;\n}\n\n/**\n * is close tag?\n *\n * @param {String} html 如：'<a hef=\"#\">'\n * @return {Boolean}\n */\nfunction isClosing(html) {\n  return html.slice(0, 2) === \"</\";\n}\n\n/**\n * parse input html and returns processed html\n *\n * @param {String} html\n * @param {Function} onTag e.g. function (sourcePosition, position, tag, html, isClosing)\n * @param {Function} escapeHtml\n * @return {String}\n */\nfunction parseTag(html, onTag, escapeHtml) {\n  \"use strict\";\n\n  var rethtml = \"\";\n  var lastPos = 0;\n  var tagStart = false;\n  var quoteStart = false;\n  var currentPos = 0;\n  var len = html.length;\n  var currentTagName = \"\";\n  var currentHtml = \"\";\n\n  chariterator: for (currentPos = 0; currentPos < len; currentPos++) {\n    var c = html.charAt(currentPos);\n    if (tagStart === false) {\n      if (c === \"<\") {\n        tagStart = currentPos;\n        continue;\n      }\n    } else {\n      if (quoteStart === false) {\n        if (c === \"<\") {\n          rethtml += escapeHtml(html.slice(lastPos, currentPos));\n          tagStart = currentPos;\n          lastPos = currentPos;\n          continue;\n        }\n        if (c === \">\" || currentPos === len - 1) {\n          rethtml += escapeHtml(html.slice(lastPos, tagStart));\n          currentHtml = html.slice(tagStart, currentPos + 1);\n          currentTagName = getTagName(currentHtml);\n          rethtml += onTag(\n            tagStart,\n            rethtml.length,\n            currentTagName,\n            currentHtml,\n            isClosing(currentHtml)\n          );\n          lastPos = currentPos + 1;\n          tagStart = false;\n          continue;\n        }\n        if (c === '\"' || c === \"'\") {\n          var i = 1;\n          var ic = html.charAt(currentPos - i);\n\n          while (ic.trim() === \"\" || ic === \"=\") {\n            if (ic === \"=\") {\n              quoteStart = c;\n              continue chariterator;\n            }\n            ic = html.charAt(currentPos - ++i);\n          }\n        }\n      } else {\n        if (c === quoteStart) {\n          quoteStart = false;\n          continue;\n        }\n      }\n    }\n  }\n  if (lastPos < len) {\n    rethtml += escapeHtml(html.substr(lastPos));\n  }\n\n  return rethtml;\n}\n\nvar REGEXP_ILLEGAL_ATTR_NAME = /[^a-zA-Z0-9\\\\_:.-]/gim;\n\n/**\n * parse input attributes and returns processed attributes\n *\n * @param {String} html e.g. `href=\"#\" target=\"_blank\"`\n * @param {Function} onAttr e.g. `function (name, value)`\n * @return {String}\n */\nfunction parseAttr(html, onAttr) {\n  \"use strict\";\n\n  var lastPos = 0;\n  var lastMarkPos = 0;\n  var retAttrs = [];\n  var tmpName = false;\n  var len = html.length;\n\n  function addAttr(name, value) {\n    name = _.trim(name);\n    name = name.replace(REGEXP_ILLEGAL_ATTR_NAME, \"\").toLowerCase();\n    if (name.length < 1) return;\n    var ret = onAttr(name, value || \"\");\n    if (ret) retAttrs.push(ret);\n  }\n\n  // 逐个分析字符\n  for (var i = 0; i < len; i++) {\n    var c = html.charAt(i);\n    var v, j;\n    if (tmpName === false && c === \"=\") {\n      tmpName = html.slice(lastPos, i);\n      lastPos = i + 1;\n      lastMarkPos = html.charAt(lastPos) === '\"' || html.charAt(lastPos) === \"'\" ? lastPos : findNextQuotationMark(html, i + 1);\n      continue;\n    }\n    if (tmpName !== false) {\n      if (\n        i === lastMarkPos\n      ) {\n        j = html.indexOf(c, i + 1);\n        if (j === -1) {\n          break;\n        } else {\n          v = _.trim(html.slice(lastMarkPos + 1, j));\n          addAttr(tmpName, v);\n          tmpName = false;\n          i = j;\n          lastPos = i + 1;\n          continue;\n        }\n      }\n    }\n    if (/\\s|\\n|\\t/.test(c)) {\n      html = html.replace(/\\s|\\n|\\t/g, \" \");\n      if (tmpName === false) {\n        j = findNextEqual(html, i);\n        if (j === -1) {\n          v = _.trim(html.slice(lastPos, i));\n          addAttr(v);\n          tmpName = false;\n          lastPos = i + 1;\n          continue;\n        } else {\n          i = j - 1;\n          continue;\n        }\n      } else {\n        j = findBeforeEqual(html, i - 1);\n        if (j === -1) {\n          v = _.trim(html.slice(lastPos, i));\n          v = stripQuoteWrap(v);\n          addAttr(tmpName, v);\n          tmpName = false;\n          lastPos = i + 1;\n          continue;\n        } else {\n          continue;\n        }\n      }\n    }\n  }\n\n  if (lastPos < html.length) {\n    if (tmpName === false) {\n      addAttr(html.slice(lastPos));\n    } else {\n      addAttr(tmpName, stripQuoteWrap(_.trim(html.slice(lastPos))));\n    }\n  }\n\n  return _.trim(retAttrs.join(\" \"));\n}\n\nfunction findNextEqual(str, i) {\n  for (; i < str.length; i++) {\n    var c = str[i];\n    if (c === \" \") continue;\n    if (c === \"=\") return i;\n    return -1;\n  }\n}\n\nfunction findNextQuotationMark(str, i) {\n  for (; i < str.length; i++) {\n    var c = str[i];\n    if (c === \" \") continue;\n    if (c === \"'\" || c === '\"') return i;\n    return -1;\n  }\n}\n\nfunction findBeforeEqual(str, i) {\n  for (; i > 0; i--) {\n    var c = str[i];\n    if (c === \" \") continue;\n    if (c === \"=\") return i;\n    return -1;\n  }\n}\n\nfunction isQuoteWrapString(text) {\n  if (\n    (text[0] === '\"' && text[text.length - 1] === '\"') ||\n    (text[0] === \"'\" && text[text.length - 1] === \"'\")\n  ) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction stripQuoteWrap(text) {\n  if (isQuoteWrapString(text)) {\n    return text.substr(1, text.length - 2);\n  } else {\n    return text;\n  }\n}\n\nexports.parseTag = parseTag;\nexports.parseAttr = parseAttr;\n","/**\n * filter xss\n *\n * @author Zongmin Lei<leizongmin@gmail.com>\n */\n\nvar FilterCSS = require(\"cssfilter\").FilterCSS;\nvar DEFAULT = require(\"./default\");\nvar parser = require(\"./parser\");\nvar parseTag = parser.parseTag;\nvar parseAttr = parser.parseAttr;\nvar _ = require(\"./util\");\n\n/**\n * returns `true` if the input value is `undefined` or `null`\n *\n * @param {Object} obj\n * @return {Boolean}\n */\nfunction isNull(obj) {\n  return obj === undefined || obj === null;\n}\n\n/**\n * get attributes for a tag\n *\n * @param {String} html\n * @return {Object}\n *   - {String} html\n *   - {Boolean} closing\n */\nfunction getAttrs(html) {\n  var i = _.spaceIndex(html);\n  if (i === -1) {\n    return {\n      html: \"\",\n      closing: html[html.length - 2] === \"/\",\n    };\n  }\n  html = _.trim(html.slice(i + 1, -1));\n  var isClosing = html[html.length - 1] === \"/\";\n  if (isClosing) html = _.trim(html.slice(0, -1));\n  return {\n    html: html,\n    closing: isClosing,\n  };\n}\n\n/**\n * shallow copy\n *\n * @param {Object} obj\n * @return {Object}\n */\nfunction shallowCopyObject(obj) {\n  var ret = {};\n  for (var i in obj) {\n    ret[i] = obj[i];\n  }\n  return ret;\n}\n\nfunction keysToLowerCase(obj) {\n  var ret = {};\n  for (var i in obj) {\n    if (Array.isArray(obj[i])) {\n      ret[i.toLowerCase()] = obj[i].map(function (item) {\n        return item.toLowerCase();\n      });\n    } else {\n      ret[i.toLowerCase()] = obj[i];\n    }\n  }\n  return ret;\n}\n\n/**\n * FilterXSS class\n *\n * @param {Object} options\n *        whiteList (or allowList), onTag, onTagAttr, onIgnoreTag,\n *        onIgnoreTagAttr, safeAttrValue, escapeHtml\n *        stripIgnoreTagBody, allowCommentTag, stripBlankChar\n *        css{whiteList, onAttr, onIgnoreAttr} `css=false` means don't use `cssfilter`\n */\nfunction FilterXSS(options) {\n  options = shallowCopyObject(options || {});\n\n  if (options.stripIgnoreTag) {\n    if (options.onIgnoreTag) {\n      console.error(\n        'Notes: cannot use these two options \"stripIgnoreTag\" and \"onIgnoreTag\" at the same time'\n      );\n    }\n    options.onIgnoreTag = DEFAULT.onIgnoreTagStripAll;\n  }\n  if (options.whiteList || options.allowList) {\n    options.whiteList = keysToLowerCase(options.whiteList || options.allowList);\n  } else {\n    options.whiteList = DEFAULT.whiteList;\n  }\n\n  this.attributeWrapSign = options.singleQuotedAttributeValue === true ? \"'\" : DEFAULT.attributeWrapSign;\n\n  options.onTag = options.onTag || DEFAULT.onTag;\n  options.onTagAttr = options.onTagAttr || DEFAULT.onTagAttr;\n  options.onIgnoreTag = options.onIgnoreTag || DEFAULT.onIgnoreTag;\n  options.onIgnoreTagAttr = options.onIgnoreTagAttr || DEFAULT.onIgnoreTagAttr;\n  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;\n  options.escapeHtml = options.escapeHtml || DEFAULT.escapeHtml;\n  this.options = options;\n\n  if (options.css === false) {\n    this.cssFilter = false;\n  } else {\n    options.css = options.css || {};\n    this.cssFilter = new FilterCSS(options.css);\n  }\n}\n\n/**\n * start process and returns result\n *\n * @param {String} html\n * @return {String}\n */\nFilterXSS.prototype.process = function (html) {\n  // compatible with the input\n  html = html || \"\";\n  html = html.toString();\n  if (!html) return \"\";\n\n  var me = this;\n  var options = me.options;\n  var whiteList = options.whiteList;\n  var onTag = options.onTag;\n  var onIgnoreTag = options.onIgnoreTag;\n  var onTagAttr = options.onTagAttr;\n  var onIgnoreTagAttr = options.onIgnoreTagAttr;\n  var safeAttrValue = options.safeAttrValue;\n  var escapeHtml = options.escapeHtml;\n  var attributeWrapSign = me.attributeWrapSign;\n  var cssFilter = me.cssFilter;\n\n  // remove invisible characters\n  if (options.stripBlankChar) {\n    html = DEFAULT.stripBlankChar(html);\n  }\n\n  // remove html comments\n  if (!options.allowCommentTag) {\n    html = DEFAULT.stripCommentTag(html);\n  }\n\n  // if enable stripIgnoreTagBody\n  var stripIgnoreTagBody = false;\n  if (options.stripIgnoreTagBody) {\n    stripIgnoreTagBody = DEFAULT.StripTagBody(\n      options.stripIgnoreTagBody,\n      onIgnoreTag\n    );\n    onIgnoreTag = stripIgnoreTagBody.onIgnoreTag;\n  }\n\n  var retHtml = parseTag(\n    html,\n    function (sourcePosition, position, tag, html, isClosing) {\n      var info = {\n        sourcePosition: sourcePosition,\n        position: position,\n        isClosing: isClosing,\n        isWhite: Object.prototype.hasOwnProperty.call(whiteList, tag),\n      };\n\n      // call `onTag()`\n      var ret = onTag(tag, html, info);\n      if (!isNull(ret)) return ret;\n\n      if (info.isWhite) {\n        if (info.isClosing) {\n          return \"</\" + tag + \">\";\n        }\n\n        var attrs = getAttrs(html);\n        var whiteAttrList = whiteList[tag];\n        var attrsHtml = parseAttr(attrs.html, function (name, value) {\n          // call `onTagAttr()`\n          var isWhiteAttr = _.indexOf(whiteAttrList, name) !== -1;\n          var ret = onTagAttr(tag, name, value, isWhiteAttr);\n          if (!isNull(ret)) return ret;\n\n          if (isWhiteAttr) {\n            // call `safeAttrValue()`\n            value = safeAttrValue(tag, name, value, cssFilter);\n            if (value) {\n              return name + '=' + attributeWrapSign + value + attributeWrapSign;\n            } else {\n              return name;\n            }\n          } else {\n            // call `onIgnoreTagAttr()`\n            ret = onIgnoreTagAttr(tag, name, value, isWhiteAttr);\n            if (!isNull(ret)) return ret;\n            return;\n          }\n        });\n\n        // build new tag html\n        html = \"<\" + tag;\n        if (attrsHtml) html += \" \" + attrsHtml;\n        if (attrs.closing) html += \" /\";\n        html += \">\";\n        return html;\n      } else {\n        // call `onIgnoreTag()`\n        ret = onIgnoreTag(tag, html, info);\n        if (!isNull(ret)) return ret;\n        return escapeHtml(html);\n      }\n    },\n    escapeHtml\n  );\n\n  // if enable stripIgnoreTagBody\n  if (stripIgnoreTagBody) {\n    retHtml = stripIgnoreTagBody.remove(retHtml);\n  }\n\n  return retHtml;\n};\n\nmodule.exports = FilterXSS;\n","/**\n * xss\n *\n * @author Zongmin Lei<leizongmin@gmail.com>\n */\n\nvar DEFAULT = require(\"./default\");\nvar parser = require(\"./parser\");\nvar FilterXSS = require(\"./xss\");\n\n/**\n * filter xss function\n *\n * @param {String} html\n * @param {Object} options { whiteList, onTag, onTagAttr, onIgnoreTag, onIgnoreTagAttr, safeAttrValue, escapeHtml }\n * @return {String}\n */\nfunction filterXSS(html, options) {\n  var xss = new FilterXSS(options);\n  return xss.process(html);\n}\n\nexports = module.exports = filterXSS;\nexports.filterXSS = filterXSS;\nexports.FilterXSS = FilterXSS;\n\n(function () {\n  for (var i in DEFAULT) {\n    exports[i] = DEFAULT[i];\n  }\n  for (var j in parser) {\n    exports[j] = parser[j];\n  }\n})();\n\n// using `xss` on the browser, output `filterXSS` to the globals\nif (typeof window !== \"undefined\") {\n  window.filterXSS = module.exports;\n}\n\n// using `xss` on the WebWorker, output `filterXSS` to the globals\nfunction isWorkerEnv() {\n  return (\n    typeof self !== \"undefined\" &&\n    typeof DedicatedWorkerGlobalScope !== \"undefined\" &&\n    self instanceof DedicatedWorkerGlobalScope\n  );\n}\nif (isWorkerEnv()) {\n  self.filterXSS = module.exports;\n}\n","import { Theme } from '@models/Theme';\n\nexport const defaultTheme: Theme = {\n  cardBgColor: '#ffffff',\n  cardDetailsBackGround: '#ffffff',\n  cardDetailsColor: '#374151',\n  cardMediaBgColor: '#f8fafc',\n  cardSubtitleColor: '#6b7280',\n  cardTitleColor: '#007FFF',\n  detailsColor: '#374151',\n  iconBackgroundColor: '#007FFF',\n  nestedCardBgColor: '#f8fafc',\n  nestedCardDetailsBackGround: '#f8fafc',\n  nestedCardDetailsColor: '#374151',\n  nestedCardSubtitleColor: '#6b7280',\n  nestedCardTitleColor: '#1f2937',\n  primary: '#007FFF',\n  secondary: '#ffdf00',\n  titleColor: '#007FFF',\n  titleColorActive: '#007FFF',\n  toolbarBgColor: '#f1f5f9',\n  toolbarBtnBgColor: '#ffffff',\n  toolbarTextColor: '#1e293b',\n  timelineBgColor: '#ffffff',\n\n  // Light mode styling\n  iconColor: '#007FFF',\n  buttonHoverBgColor: '#e2e8f0',\n  buttonActiveBgColor: '#007FFF',\n  buttonActiveIconColor: '#ffffff',\n  buttonBorderColor: '#e2e8f0',\n  buttonHoverBorderColor: '#007FFF',\n  buttonActiveBorderColor: '#007FFF',\n  shadowColor: 'rgba(0, 0, 0, 0.1)',\n  glowColor: 'rgba(0, 127, 255, 0.2)',\n  searchHighlightColor: 'rgba(0, 127, 255, 0.2)',\n  darkToggleActiveBgColor: '#007FFF',\n  darkToggleActiveIconColor: '#ffffff',\n  darkToggleActiveBorderColor: '#007FFF',\n  darkToggleGlowColor: 'rgba(0, 127, 255, 0.2)',\n};\n\nexport const darkTheme: Theme = {\n  cardBgColor: '#1f2937',\n  cardDetailsBackGround: '#1f2937',\n  cardDetailsColor: '#f3f4f6',\n  cardMediaBgColor: '#111827',\n  cardSubtitleColor: '#d1d5db',\n  cardTitleColor: '#60a5fa',\n  detailsColor: '#f3f4f6',\n  iconBackgroundColor: '#3b82f6',\n  nestedCardBgColor: '#111827',\n  nestedCardDetailsBackGround: '#111827',\n  nestedCardDetailsColor: '#f3f4f6',\n  nestedCardSubtitleColor: '#d1d5db',\n  nestedCardTitleColor: '#f9fafb',\n  primary: '#3b82f6',\n  secondary: '#fbbf24',\n  titleColor: '#60a5fa',\n  titleColorActive: '#60a5fa',\n  toolbarBgColor: '#111827',\n  toolbarBtnBgColor: '#374151',\n  toolbarTextColor: '#f3f4f6',\n  timelineBgColor: '#111827',\n\n  // Dark mode styling - our enhanced colors as defaults\n  iconColor: '#93c5fd',\n  buttonHoverBgColor: '#4b5563',\n  buttonActiveBgColor: '#fbbf24',\n  buttonActiveIconColor: '#1f2937',\n  buttonBorderColor: 'rgba(255, 255, 255, 0.1)',\n  buttonHoverBorderColor: '#3b82f6',\n  buttonActiveBorderColor: '#3b82f6',\n  shadowColor: 'rgba(0, 0, 0, 0.4)',\n  glowColor: 'rgba(59, 130, 246, 0.4)',\n  searchHighlightColor: 'rgba(96, 165, 250, 0.4)',\n  darkToggleActiveBgColor: '#1e40af',\n  darkToggleActiveIconColor: '#e2e8f0',\n  darkToggleActiveBorderColor: '#3b82f6',\n  darkToggleGlowColor: 'rgba(59, 130, 246, 0.4)',\n};\n","import {\n  ButtonTexts,\n  SlideShowType,\n  TimelineMode,\n} from '@models/TimelineModel';\nimport xss from 'xss';\nimport { darkTheme, defaultTheme } from '../components/common/themes';\n\n// Constants to avoid creating new objects on every function call\nconst DEFAULT_CLASS_NAMES = Object.freeze({\n  card: 'rc-card',\n  cardMedia: 'rc-card-media',\n  cardSubTitle: 'rc-card-subtitle',\n  cardText: 'rc-card-text',\n  cardTitle: 'rc-card-title',\n  controls: 'rc-controls',\n  title: 'rc-title',\n} as const);\n\nconst DEFAULT_BUTTON_TEXTS: Readonly<ButtonTexts> = Object.freeze({\n  changeDensity: 'Change density',\n  changeDensityOptions: Object.freeze({\n    high: Object.freeze({\n      helpText: 'Show more items at once',\n      text: 'High',\n    }),\n    low: Object.freeze({\n      helpText: 'Show fewer items at once',\n      text: 'Low',\n    }),\n  }),\n  changeLayout: 'Change layout',\n  changeLayoutOptions: Object.freeze({\n    alternating: Object.freeze({\n      helpText: 'Show cards in a vertical layout with alternating fashion',\n      text: 'Alternating',\n    }),\n    horizontal: Object.freeze({\n      helpText: 'Show cards in a horizontal layout',\n      text: 'Horizontal',\n    }),\n    horizontal_all: Object.freeze({\n      helpText: 'Show all cards in a horizontal layout',\n      text: 'Show all cards',\n    }),\n    vertical: Object.freeze({\n      helpText: 'Show cards in a vertical layout',\n      text: 'Vertical',\n    }),\n  }),\n  dark: 'Switch to Dark Mode',\n  first: 'Go to First',\n  jumpTo: 'Jump to',\n  last: 'Go to Last',\n  light: 'Switch to Light Mode',\n  next: 'Next',\n  play: 'Play Slideshow',\n  previous: 'Previous',\n  stop: 'Stop Slideshow',\n  searchPlaceholder: 'Search Timeline',\n  searchAriaLabel: 'Search timeline content',\n  clearSearch: 'Clear Search',\n  previousMatch: 'Previous Match',\n  nextMatch: 'Next Match',\n  timelinePoint: 'Timeline point',\n});\n\n// Pre-compiled regex for hex validation (supports both 3 and 6 character formats)\nconst HEX_COLOR_REGEX = /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;\n\n// Character set for ID generation\nconst ID_CHARS =\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\nconst ID_LENGTH = 7;\n\n/**\n * Converts hex color to RGBA format\n * @param hex - Hex color code (e.g. #FFFFFF)\n * @param alpha - Opacity value between 0 and 1\n * @returns RGBA color string\n */\nexport const hexToRGBA = (hex: string, alpha: number): string => {\n  // Input validation\n  if (typeof hex !== 'string' || typeof alpha !== 'number') {\n    return `rgba(0, 0, 0, ${Math.max(0, Math.min(1, alpha || 0))})`;\n  }\n\n  // Validate hex format using regex (more efficient than manual checks)\n  if (!HEX_COLOR_REGEX.test(hex)) {\n    console.warn('Invalid hex color provided:', hex);\n    return `rgba(0, 0, 0, ${Math.max(0, Math.min(1, alpha))})`;\n  }\n\n  // Expand 3-character hex to 6-character\n  let fullHex = hex;\n  if (hex.length === 4) {\n    fullHex = '#' + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];\n  }\n\n  // Extract RGB values directly with bit shifting (more efficient)\n  const hexValue = parseInt(fullHex.slice(1), 16);\n  const r = (hexValue >> 16) & 255;\n  const g = (hexValue >> 8) & 255;\n  const b = hexValue & 255;\n\n  // Clamp alpha value between 0 and 1\n  const clampedAlpha = Math.max(0, Math.min(1, alpha));\n\n  return `rgba(${r}, ${g}, ${b}, ${clampedAlpha})`;\n};\n\n/**\n * Returns the appropriate theme based on dark mode preference\n * @param isDark - Whether dark mode is enabled\n * @returns Theme object\n */\nexport const getDefaultThemeOrDark = (isDark?: boolean) =>\n  isDark ? darkTheme : defaultTheme;\n\n/**\n * Returns default class names for timeline components\n * @returns Object of default CSS class names\n */\nexport const getDefaultClassNames = () => DEFAULT_CLASS_NAMES;\n\n/**\n * Returns default button text translations\n * @returns Object containing all button text strings\n */\nexport const getDefaultButtonTexts = (): ButtonTexts => DEFAULT_BUTTON_TEXTS;\n\n/**\n * Determines slideshow type based on timeline mode\n * @param mode - Timeline display mode\n * @returns Appropriate slideshow animation type\n */\nexport const getSlideShowType = (mode: TimelineMode): SlideShowType => {\n  switch (mode) {\n    case 'VERTICAL_ALTERNATING':\n      return 'slide_from_sides';\n    case 'HORIZONTAL':\n    case 'VERTICAL':\n    default:\n      return 'reveal';\n  }\n};\n\n/**\n * Type guard to check if text is an array of strings\n * @param text - Text string or array of strings\n * @returns Boolean indicating if input is string array\n */\nexport const isTextArray = (text: string | string[]): text is string[] =>\n  Array.isArray(text);\n\n/**\n * Sanitizes HTML text to prevent XSS attacks\n * @param text - Text string or array of strings to sanitize\n * @returns Sanitized text string or array\n */\nexport const sanitizeHtmlText = (\n  text: string | string[],\n): string | string[] => {\n  if (!text) return '';\n\n  try {\n    return isTextArray(text) ? text.map((t) => xss(t || '')) : xss(text);\n  } catch (error) {\n    console.error('Error sanitizing HTML text:', error);\n    return isTextArray(text) ? [] : '';\n  }\n};\n\n/**\n * Generates a cryptographically secure random ID\n * @returns Unique string ID\n */\nexport const getUniqueID = (): string => {\n  // Use crypto API if available (modern browsers)\n  if (typeof window !== 'undefined' && window.crypto?.getRandomValues) {\n    try {\n      const randomValues = new Uint8Array(ID_LENGTH);\n      window.crypto.getRandomValues(randomValues);\n\n      return Array.from(\n        randomValues,\n        (byte) => ID_CHARS[byte % ID_CHARS.length],\n      ).join('');\n    } catch (error) {\n      console.error('Error generating unique ID:', error);\n    }\n  }\n\n  // Fallback for environments without crypto API\n  // Using a combination of timestamp and a more robust random generation\n  const timestamp = Date.now().toString(36);\n\n  // Use performance.now() for additional entropy if available\n  const performanceTime =\n    typeof performance !== 'undefined' && performance.now\n      ? performance.now().toString().replace('.', '')\n      : Date.now().toString();\n\n  // Generate random part using timestamp-based seed for better distribution\n  const seed = parseInt(performanceTime.slice(-6), 10);\n  const randomPart = Array.from({ length: 8 }, (_, index) => {\n    // Simple LCG algorithm for better distribution than Math.random\n    const a = 1664525;\n    const c = 1013904223;\n    const m = Math.pow(2, 32);\n    const value = (a * (seed + index) + c) % m;\n    return ID_CHARS[value % ID_CHARS.length];\n  }).join('');\n\n  return `id-${timestamp}-${randomPart}`;\n};\n","/**\n * Simple runtime validation for Timeline props without external dependencies\n */\n\ninterface ValidationError {\n  path: string[];\n  message: string;\n}\n\nfunction isValidHexColor(color: string): boolean {\n  return /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(color);\n}\n\nfunction isValidUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validates timeline props and returns validation errors\n * @param props - Timeline props to validate\n * @returns Array of validation errors (empty if valid)\n */\nexport function validateTimelineProps(props: any): ValidationError[] {\n  const errors: ValidationError[] = [];\n\n  // Validate items array\n  if (!props.items || !Array.isArray(props.items)) {\n    errors.push({ path: ['items'], message: 'Items must be an array' });\n  } else if (props.items.length === 0) {\n    errors.push({\n      path: ['items'],\n      message: 'At least one timeline item is required',\n    });\n  } else {\n    // Validate each item\n    props.items.forEach((item: any, index: number) => {\n      if (item.url && typeof item.url === 'string' && !isValidUrl(item.url)) {\n        errors.push({\n          path: ['items', index.toString(), 'url'],\n          message: 'Invalid URL format',\n        });\n      }\n\n      if (item.media?.source?.url && !isValidUrl(item.media.source.url)) {\n        errors.push({\n          path: ['items', index.toString(), 'media', 'source', 'url'],\n          message: 'Invalid media URL format',\n        });\n      }\n    });\n  }\n\n  // Validate mode\n  const validModes = ['VERTICAL', 'HORIZONTAL', 'VERTICAL_ALTERNATING'];\n  if (props.mode && !validModes.includes(props.mode)) {\n    errors.push({\n      path: ['mode'],\n      message: `Mode must be one of: ${validModes.join(', ')}`,\n    });\n  }\n\n  // Validate numeric props\n  const numericProps = [\n    'cardHeight',\n    'cardWidth',\n    'itemWidth',\n    'lineWidth',\n    'slideItemDuration',\n    'activeItemIndex',\n  ];\n  numericProps.forEach((prop) => {\n    const value = props[prop];\n    if (value !== undefined && (typeof value !== 'number' || value < 0)) {\n      errors.push({\n        path: [prop],\n        message: `${prop} must be a positive number`,\n      });\n    }\n  });\n\n  // Validate theme colors if present\n  if (props.theme && typeof props.theme === 'object') {\n    const colorProps = [\n      'primary',\n      'secondary',\n      'cardBgColor',\n      'cardForeColor',\n      'titleColor',\n      'titleColorActive',\n    ];\n    colorProps.forEach((prop) => {\n      const color = props.theme[prop];\n      if (color && typeof color === 'string' && !isValidHexColor(color)) {\n        errors.push({\n          path: ['theme', prop],\n          message: `${prop} must be a valid hex color (e.g., #ff0000 or #f00)`,\n        });\n      }\n    });\n  }\n\n  // Validate boolean props\n  const booleanProps = [\n    'slideShow',\n    'flipLayout',\n    'cardLess',\n    'hideControls',\n    'disableNavOnKey',\n  ];\n  booleanProps.forEach((prop) => {\n    const value = props[prop];\n    if (value !== undefined && typeof value !== 'boolean') {\n      errors.push({ path: [prop], message: `${prop} must be a boolean` });\n    }\n  });\n\n  return errors;\n}\n\n/**\n * Safely validates props without throwing, returns success/error result\n * @param props - Raw timeline props\n * @returns Success result or error result with validation errors\n */\nexport function safeValidateTimelineProps(\n  props: unknown,\n):\n  | { success: true; data: any }\n  | { success: false; errors: ValidationError[] } {\n  const errors = validateTimelineProps(props);\n\n  if (errors.length === 0) {\n    return { success: true, data: props };\n  } else {\n    return { success: false, errors };\n  }\n}\n","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",c=\"month\",f=\"quarter\",h=\"year\",d=\"date\",l=\"Invalid Date\",$=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),ordinal:function(t){var e=[\"th\",\"st\",\"nd\",\"rd\"],n=t%100;return\"[\"+t+(e[(n-20)%10]||e[n]||e[0])+\"]\"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),s=n-i<0,u=e.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:f}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},g=\"en\",D={};D[g]=M;var p=\"$isDayjsObject\",S=function(t){return t instanceof _||!(!t||!t[p])},w=function t(e,n,r){var i;if(!e)return g;if(\"string\"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split(\"-\");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},O=function(t,e){if(S(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},b=v;b.l=w,b.i=S,b.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p]=!0}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return b},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=O(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return O(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<O(t)},m.$g=function(t,e,n){return b.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!b.u(e)||e,f=b.p(t),l=function(t,e){var i=b.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return b.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v=\"set\"+(this.$u?\"UTC\":\"\");switch(f){case h:return r?l(1,0):l(31,11);case c:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+\"Hours\",0);case u:return $(v+\"Minutes\",1);case s:return $(v+\"Seconds\",2);case i:return $(v+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=b.p(t),f=\"set\"+(this.$u?\"UTC\":\"\"),l=(n={},n[a]=f+\"Date\",n[d]=f+\"Date\",n[c]=f+\"Month\",n[h]=f+\"FullYear\",n[u]=f+\"Hours\",n[s]=f+\"Minutes\",n[i]=f+\"Seconds\",n[r]=f+\"Milliseconds\",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===c||o===h){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[b.p(t)]()},m.add=function(r,f){var d,l=this;r=Number(r);var $=b.p(f),y=function(t){var e=O(l);return b.w(e.date(e.date()+Math.round(t*r)),l)};if($===c)return this.set(c,this.$M+r);if($===h)return this.set(h,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return b.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=b.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,c=n.months,f=n.meridiem,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},d=function(t){return b.s(s%12||12,t,\"0\")},$=f||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r};return r.replace(y,(function(t,r){return r||function(t){switch(t){case\"YY\":return String(e.$y).slice(-2);case\"YYYY\":return b.s(e.$y,4,\"0\");case\"M\":return a+1;case\"MM\":return b.s(a+1,2,\"0\");case\"MMM\":return h(n.monthsShort,a,c,3);case\"MMMM\":return h(c,a);case\"D\":return e.$D;case\"DD\":return b.s(e.$D,2,\"0\");case\"d\":return String(e.$W);case\"dd\":return h(n.weekdaysMin,e.$W,o,2);case\"ddd\":return h(n.weekdaysShort,e.$W,o,3);case\"dddd\":return o[e.$W];case\"H\":return String(s);case\"HH\":return b.s(s,2,\"0\");case\"h\":return d(1);case\"hh\":return d(2);case\"a\":return $(s,u,!0);case\"A\":return $(s,u,!1);case\"m\":return String(u);case\"mm\":return b.s(u,2,\"0\");case\"s\":return String(e.$s);case\"ss\":return b.s(e.$s,2,\"0\");case\"SSS\":return b.s(e.$ms,3,\"0\");case\"Z\":return i}return null}(t)||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=this,M=b.p(d),m=O(r),v=(m.utcOffset()-this.utcOffset())*e,g=this-m,D=function(){return b.m(y,m)};switch(M){case h:$=D()/12;break;case c:$=D();break;case f:$=D()/3;break;case o:$=(g-v)/6048e5;break;case a:$=(g-v)/864e5;break;case u:$=g/n;break;case s:$=g/e;break;case i:$=g/t;break;default:$=g}return l?$:b.a($)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return b.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),k=_.prototype;return O.prototype=k,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",c],[\"$y\",h],[\"$D\",d]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,_,O),t.$i=!0),O},O.locale=w,O.isDayjs=S,O.unix=function(t){return O(1e3*t)},O.en=D[g],O.Ls=D,O.p={},O}));","import{useRef as r,useEffect as n,useMemo as t,useState as e,useCallback as u}from\"react\";function c(e,u,c,i){var a=this,o=r(null),f=r(0),l=r(0),v=r(null),m=r([]),d=r(),g=r(),p=r(e),w=r(!0);p.current=e;var s=\"undefined\"!=typeof window,x=!u&&0!==u&&s;if(\"function\"!=typeof e)throw new TypeError(\"Expected a function\");u=+u||0;var h=!!(c=c||{}).leading,y=!(\"trailing\"in c)||!!c.trailing,F=\"maxWait\"in c,A=\"debounceOnServer\"in c&&!!c.debounceOnServer,D=F?Math.max(+c.maxWait||0,u):null;n(function(){return w.current=!0,function(){w.current=!1}},[]);var T=t(function(){var r=function(r){var n=m.current,t=d.current;return m.current=d.current=null,f.current=r,l.current=l.current||r,g.current=p.current.apply(t,n)},n=function(r,n){x&&cancelAnimationFrame(v.current),v.current=x?requestAnimationFrame(r):setTimeout(r,n)},t=function(r){if(!w.current)return!1;var n=r-o.current;return!o.current||n>=u||n<0||F&&r-f.current>=D},e=function(n){return v.current=null,y&&m.current?r(n):(m.current=d.current=null,g.current)},c=function r(){var c=Date.now();if(h&&l.current===f.current&&T(),t(c))return e(c);if(w.current){var i=u-(c-o.current),a=F?Math.min(i,D-(c-f.current)):i;n(r,a)}},T=function(){i&&i({})},W=function(){if(s||A){var e=Date.now(),i=t(e);if(m.current=[].slice.call(arguments),d.current=a,o.current=e,i){if(!v.current&&w.current)return f.current=o.current,n(c,u),h?r(o.current):g.current;if(F)return n(c,u),r(o.current)}return v.current||n(c,u),g.current}};return W.cancel=function(){var r=v.current;r&&(x?cancelAnimationFrame(v.current):clearTimeout(v.current)),f.current=0,m.current=o.current=d.current=v.current=null,r&&i&&i({})},W.isPending=function(){return!!v.current},W.flush=function(){return v.current?e(Date.now()):g.current},W},[h,F,u,D,y,x,s,A,i]);return T}function i(r,n){return r===n}function a(n,t,a){var o=a&&a.equalityFn||i,f=r(n),l=e({})[1],v=c(u(function(r){f.current=r,l({})},[l]),t,a,l),m=r(n);return o(m.current,n)||(v(n),m.current=n),[f.current,v]}function o(r,n,t){var e=void 0===t?{}:t,u=e.leading,i=e.trailing;return c(r,n,{maxWait:n,leading:void 0===u||u,trailing:void 0===i||i})}export{a as useDebounce,c as useDebouncedCallback,o as useThrottledCallback};\n//# sourceMappingURL=index.module.js.map\n","/**\n * Media query utility functions for handling responsive behaviors\n */\n\n/**\n * Creates and returns a MediaQueryList object\n * @param query - CSS media query string (e.g. '(max-width: 768px)')\n * @returns MediaQueryList object or null if browser doesn't support matchMedia\n */\nexport function createMediaQuery(query: string): MediaQueryList | null {\n  if (typeof window === 'undefined') return null;\n\n  try {\n    return window.matchMedia(query);\n  } catch (error) {\n    console.error('Error creating media query:', error);\n    return null;\n  }\n}\n\n/**\n * Adds change and resize listeners for the provided media query\n * @param currentMedia - MediaQueryList object to attach listeners to\n * @param handleMediaChange - Callback function for media query changes\n * @param handleResize - Callback function for window resize events\n */\nexport function addMediaListeners(\n  currentMedia: MediaQueryList | null,\n  handleMediaChange: (event: MediaQueryListEvent | MediaQueryList) => void,\n  handleResize: () => void,\n): void {\n  if (!currentMedia || typeof window === 'undefined') return;\n\n  try {\n    currentMedia.addEventListener('change', handleMediaChange);\n    window.addEventListener('resize', handleResize);\n  } catch (error) {\n    console.error('Error adding media listeners:', error);\n  }\n}\n\n/**\n * Removes change and resize listeners to prevent memory leaks\n * @param currentMedia - MediaQueryList object to detach listeners from\n * @param handleMediaChange - Callback function to remove from media query changes\n * @param handleResize - Callback function to remove from window resize events\n */\nexport function removeMediaListeners(\n  currentMedia: MediaQueryList | null,\n  handleMediaChange: (event: MediaQueryListEvent | MediaQueryList) => void,\n  handleResize: () => void,\n): void {\n  if (typeof window === 'undefined') return;\n\n  try {\n    if (currentMedia) {\n      currentMedia.removeEventListener('change', handleMediaChange);\n    }\n    window.removeEventListener('resize', handleResize);\n  } catch (error) {\n    console.error('Error removing media listeners:', error);\n  }\n}\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { useDebouncedCallback } from 'use-debounce';\nimport {\n  createMediaQuery,\n  addMediaListeners,\n  removeMediaListeners,\n} from '../../utils/mediaQueryUtils';\n\n/**\n * Configuration options for the useMatchMedia hook\n */\ninterface MatchMediaOptions {\n  /** Callback function to execute when media query matches */\n  onMatch?: () => void;\n  /** Whether the hook is enabled */\n  enabled?: boolean;\n  /** Debounce delay in milliseconds */\n  debounceDelay?: number;\n}\n\n/**\n * Custom hook that tracks if a media query matches and executes a callback on matches\n *\n * @param query - The media query string to match against\n * @param options - Configuration options\n * @returns Boolean indicating if the media query currently matches\n *\n * @example\n * ```tsx\n * const isMobile = useMatchMedia('(max-width: 768px)', {\n *   onMatch: () => console.log('Mobile view detected'),\n *   debounceDelay: 200\n * });\n * ```\n */\nexport const useMatchMedia = (\n  query: string,\n  { onMatch, enabled = true, debounceDelay = 100 }: MatchMediaOptions = {},\n): boolean => {\n  const [matches, setMatches] = useState<boolean>(false);\n  const mediaQuery = useRef<MediaQueryList | null>(null);\n  const isCleanedUp = useRef<boolean>(false);\n\n  // Stable callback references to prevent unnecessary effect re-runs\n  const handleMediaChange = useCallback(\n    (event: MediaQueryListEvent | MediaQueryList) => {\n      if (isCleanedUp.current) return;\n      setMatches(event.matches);\n    },\n    [],\n  );\n\n  const handleResize = useDebouncedCallback(\n    () => {\n      if (!mediaQuery.current || isCleanedUp.current) return;\n\n      const currentMatches = mediaQuery.current.matches;\n      setMatches(currentMatches);\n    },\n    debounceDelay,\n    { maxWait: 1000 },\n  );\n\n  // Setup media query listener\n  useEffect(() => {\n    if (!enabled || typeof window === 'undefined') {\n      return;\n    }\n\n    isCleanedUp.current = false;\n\n    // Cleanup previous mediaQuery if it exists\n    if (mediaQuery.current) {\n      removeMediaListeners(mediaQuery.current, handleMediaChange, handleResize);\n    }\n\n    mediaQuery.current = createMediaQuery(query);\n    const currentMedia = mediaQuery.current;\n\n    if (!currentMedia) {\n      return;\n    }\n\n    // Initial check\n    handleMediaChange(currentMedia);\n\n    // Add event listeners\n    addMediaListeners(currentMedia, handleMediaChange, handleResize);\n\n    // Cleanup\n    return () => {\n      isCleanedUp.current = true;\n      if (currentMedia) {\n        removeMediaListeners(currentMedia, handleMediaChange, handleResize);\n      }\n      handleResize.cancel(); // Cancel any pending debounced calls\n      mediaQuery.current = null; // Clear the ref\n    };\n  }, [query, enabled, handleMediaChange, handleResize]); // Removed createMediaQuery dependency to avoid infinite loops\n\n  // Execute callback when matches changes - use ref to avoid stale closure\n  const onMatchRef = useRef(onMatch);\n  onMatchRef.current = onMatch;\n\n  useEffect(() => {\n    if (matches && onMatchRef.current) {\n      onMatchRef.current();\n    }\n  }, [matches]);\n\n  return matches;\n};\n","/**\n * Comprehensive internationalization configuration for React Chrono Timeline\n *\n * This interface provides complete localization support for all user-facing\n * text content within the timeline component, including navigation controls,\n * search functionality, accessibility labels, and interactive elements.\n */\n\n/**\n * Navigation control text labels\n */\nexport interface NavigationTexts {\n  /** Label for the first item button */\n  first?: string;\n  /** Label for the last item button */\n  last?: string;\n  /** Label for the next item button */\n  next?: string;\n  /** Label for the previous item button */\n  previous?: string;\n  /** Label for the play slideshow button */\n  play?: string;\n  /** Label for the stop/pause slideshow button */\n  stop?: string;\n  /** Label for the pause slideshow button */\n  pause?: string;\n  /** Label for the resume slideshow button */\n  resume?: string;\n}\n\n/**\n * Search functionality text labels\n */\nexport interface SearchTexts {\n  /** Placeholder text for search input field */\n  placeholder?: string;\n  /** ARIA label for search input field */\n  ariaLabel?: string;\n  /** Label for clear search button */\n  clearLabel?: string;\n  /** Label for next match button */\n  nextMatch?: string;\n  /** Label for previous match button */\n  previousMatch?: string;\n  /** Text template for search results count (uses {current} and {total} placeholders) */\n  resultsCount?: string;\n  /** Text when no search results found */\n  noResults?: string;\n  /** ARIA label for search navigation controls */\n  navigationLabel?: string;\n}\n\n/**\n * Theme and display mode text labels\n */\nexport interface ThemeTexts {\n  /** Label for dark mode button */\n  darkMode?: string;\n  /** Label for light mode button */\n  lightMode?: string;\n  /** Label for theme toggle button */\n  toggleTheme?: string;\n}\n\n/**\n * Layout and view mode text labels\n */\nexport interface LayoutTexts {\n  /** Label for vertical layout mode */\n  vertical?: string;\n  /** Label for horizontal layout mode */\n  horizontal?: string;\n  /** Label for alternating layout mode */\n  alternating?: string;\n  /** Label for horizontal-all layout mode */\n  horizontalAll?: string;\n  /** Label for layout switcher */\n  switchLayout?: string;\n  /** ARIA label for layout selection */\n  layoutSelection?: string;\n}\n\n/**\n * Fullscreen functionality text labels\n */\nexport interface FullscreenTexts {\n  /** Label for enter fullscreen button */\n  enterFullscreen?: string;\n  /** Label for exit fullscreen button */\n  exitFullscreen?: string;\n  /** Error message when fullscreen is not supported */\n  notSupported?: string;\n  /** Error message when fullscreen request fails */\n  errorMessage?: string;\n}\n\n/**\n * Quick navigation text labels\n */\nexport interface QuickJumpTexts {\n  /** Label for quick jump dropdown */\n  jumpTo?: string;\n  /** ARIA label for quick jump selection */\n  jumpToAriaLabel?: string;\n  /** Template for timeline item options in quick jump (uses {index} and {title} placeholders) */\n  itemTemplate?: string;\n}\n\n/**\n * Content interaction text labels\n */\nexport interface ContentTexts {\n  /** Label for read more button */\n  readMore?: string;\n  /** Label for show less button */\n  showLess?: string;\n  /** Label for expand content button */\n  expand?: string;\n  /** Label for collapse content button */\n  collapse?: string;\n  /** ARIA label for card interactions */\n  cardInteraction?: string;\n}\n\n/**\n * Loading and status text labels\n */\nexport interface StatusTexts {\n  /** Loading message */\n  loading?: string;\n  /** Error message for general errors */\n  error?: string;\n  /** Message when no items are available */\n  noItems?: string;\n  /** Message when timeline is empty */\n  empty?: string;\n}\n\n/**\n * Accessibility text labels for screen readers\n */\nexport interface AccessibilityTexts {\n  /** ARIA label for timeline navigation group */\n  timelineNavigation?: string;\n  /** ARIA label for timeline container */\n  timelineContainer?: string;\n  /** ARIA label for individual timeline items */\n  timelineItem?: string;\n  /** ARIA label for active timeline item */\n  activeItem?: string;\n  /** ARIA label for timeline point/marker */\n  timelinePoint?: string;\n  /** ARIA label for timeline card */\n  timelineCard?: string;\n  /** ARIA label for nested timeline items */\n  nestedItems?: string;\n  /** Template for item position announcement (uses {current} and {total} placeholders) */\n  itemPosition?: string;\n}\n\n/**\n * Density and view options text labels\n */\nexport interface ViewTexts {\n  /** Label for compact view */\n  compact?: string;\n  /** Label for detailed view */\n  detailed?: string;\n  /** Label for view density toggle */\n  toggleDensity?: string;\n  /** ARIA label for density selection */\n  densitySelection?: string;\n}\n\n/**\n * Keyboard navigation help text\n */\nexport interface KeyboardTexts {\n  /** Help text for arrow key navigation */\n  arrowKeys?: string;\n  /** Help text for home key */\n  homeKey?: string;\n  /** Help text for end key */\n  endKey?: string;\n  /** Help text for enter key */\n  enterKey?: string;\n  /** Help text for escape key */\n  escapeKey?: string;\n  /** Help text for tab navigation */\n  tabNavigation?: string;\n  /** General keyboard navigation help */\n  keyboardHelp?: string;\n}\n\n/**\n * Complete internationalization configuration interface\n */\nexport interface TimelineI18nConfig {\n  /** Navigation control labels */\n  navigation?: NavigationTexts;\n  /** Search functionality labels */\n  search?: SearchTexts;\n  /** Theme and display mode labels */\n  theme?: ThemeTexts;\n  /** Layout and view mode labels */\n  layout?: LayoutTexts;\n  /** Fullscreen functionality labels */\n  fullscreen?: FullscreenTexts;\n  /** Quick navigation labels */\n  quickJump?: QuickJumpTexts;\n  /** Content interaction labels */\n  content?: ContentTexts;\n  /** Loading and status labels */\n  status?: StatusTexts;\n  /** Accessibility labels for screen readers */\n  accessibility?: AccessibilityTexts;\n  /** Density and view options labels */\n  view?: ViewTexts;\n  /** Keyboard navigation help text */\n  keyboard?: KeyboardTexts;\n}\n\n/**\n * Default English text values for all internationalization strings\n */\nexport const defaultI18nTexts: Required<TimelineI18nConfig> = {\n  navigation: {\n    first: 'Go to first item',\n    last: 'Go to last item',\n    next: 'Next item',\n    previous: 'Previous item',\n    play: 'Start slideshow',\n    stop: 'Stop slideshow',\n    pause: 'Pause slideshow',\n    resume: 'Resume slideshow',\n  },\n  search: {\n    placeholder: 'Search Timeline',\n    ariaLabel: 'Search timeline content',\n    clearLabel: 'Clear Search',\n    nextMatch: 'Next Match (Enter)',\n    previousMatch: 'Previous Match (Shift+Enter)',\n    resultsCount: '{current} of {total}',\n    noResults: 'No results found',\n    navigationLabel: 'Search navigation',\n  },\n  theme: {\n    darkMode: 'Switch to dark mode',\n    lightMode: 'Switch to light mode',\n    toggleTheme: 'Toggle theme',\n  },\n  layout: {\n    vertical: 'Vertical layout',\n    horizontal: 'Horizontal layout',\n    alternating: 'Alternating layout',\n    horizontalAll: 'Horizontal all layout',\n    switchLayout: 'Switch layout',\n    layoutSelection: 'Layout selection',\n  },\n  fullscreen: {\n    enterFullscreen: 'Enter fullscreen',\n    exitFullscreen: 'Exit fullscreen',\n    notSupported: 'Fullscreen not supported',\n    errorMessage: 'Failed to enter fullscreen mode',\n  },\n  quickJump: {\n    jumpTo: 'Jump to item',\n    jumpToAriaLabel: 'Quick navigation to timeline items',\n    itemTemplate: '{index}: {title}',\n  },\n  content: {\n    readMore: 'Read More',\n    showLess: 'Show Less',\n    expand: 'Expand',\n    collapse: 'Collapse',\n    cardInteraction: 'Timeline card content',\n  },\n  status: {\n    loading: 'Loading timeline...',\n    error: 'Error loading timeline',\n    noItems: 'No timeline items available',\n    empty: 'Timeline is empty',\n  },\n  accessibility: {\n    timelineNavigation: 'Timeline Navigation',\n    timelineContainer: 'Timeline Container',\n    timelineItem: 'Timeline Item',\n    activeItem: 'Active Timeline Item',\n    timelinePoint: 'Timeline Point',\n    timelineCard: 'Timeline Card',\n    nestedItems: 'Nested Timeline Items',\n    itemPosition: 'Item {current} of {total}',\n  },\n  view: {\n    compact: 'Compact view',\n    detailed: 'Detailed view',\n    toggleDensity: 'Toggle view density',\n    densitySelection: 'View density selection',\n  },\n  keyboard: {\n    arrowKeys: 'Use arrow keys to navigate between items',\n    homeKey: 'Press Home to go to first item',\n    endKey: 'Press End to go to last item',\n    enterKey: 'Press Enter to select item',\n    escapeKey: 'Press Escape to exit fullscreen or pause slideshow',\n    tabNavigation: 'Use Tab to navigate controls',\n    keyboardHelp: 'Keyboard navigation available',\n  },\n};\n\n/**\n * Utility function to merge user-provided i18n config with defaults\n */\nexport function mergeI18nConfig(\n  userConfig?: TimelineI18nConfig,\n): Required<TimelineI18nConfig> {\n  if (!userConfig) return defaultI18nTexts;\n\n  return {\n    navigation: { ...defaultI18nTexts.navigation, ...userConfig.navigation },\n    search: { ...defaultI18nTexts.search, ...userConfig.search },\n    theme: { ...defaultI18nTexts.theme, ...userConfig.theme },\n    layout: { ...defaultI18nTexts.layout, ...userConfig.layout },\n    fullscreen: { ...defaultI18nTexts.fullscreen, ...userConfig.fullscreen },\n    quickJump: { ...defaultI18nTexts.quickJump, ...userConfig.quickJump },\n    content: { ...defaultI18nTexts.content, ...userConfig.content },\n    status: { ...defaultI18nTexts.status, ...userConfig.status },\n    accessibility: {\n      ...defaultI18nTexts.accessibility,\n      ...userConfig.accessibility,\n    },\n    view: { ...defaultI18nTexts.view, ...userConfig.view },\n    keyboard: { ...defaultI18nTexts.keyboard, ...userConfig.keyboard },\n  };\n}\n\n/**\n * Utility function to interpolate template strings with variables\n * Example: interpolateString('{current} of {total}', { current: 1, total: 5 }) => '1 of 5'\n */\nexport function interpolateString(\n  template: string,\n  variables: Record<string, string | number>,\n): string {\n  return template.replace(/\\{(\\w+)\\}/g, (match, key) => {\n    const value = variables[key];\n    return value !== undefined && value !== null ? value.toString() : match;\n  });\n}\n","import { useMemo } from 'react';\nimport {\n  TimelineI18nConfig,\n  mergeI18nConfig,\n  interpolateString,\n} from '../models/TimelineI18n';\n\n/**\n * Hook for managing internationalization in the timeline component\n */\nexport function useI18n(i18nConfig?: TimelineI18nConfig) {\n  // Merge user configuration with defaults\n  const texts = useMemo(() => mergeI18nConfig(i18nConfig), [i18nConfig]);\n\n  // Helper function to get text with interpolation support\n  const getText = useMemo(() => {\n    return <K extends keyof typeof texts>(\n      category: K,\n      key: keyof (typeof texts)[K],\n      variables?: Record<string, string | number>,\n    ): string => {\n      const text = texts[category][key] as string;\n      if (!text) return '';\n\n      if (variables) {\n        return interpolateString(text, variables);\n      }\n\n      return text;\n    };\n  }, [texts]);\n\n  // Shorthand functions for common text categories\n  const navigation = useMemo(\n    () => ({\n      first: () => getText('navigation', 'first'),\n      last: () => getText('navigation', 'last'),\n      next: () => getText('navigation', 'next'),\n      previous: () => getText('navigation', 'previous'),\n      play: () => getText('navigation', 'play'),\n      stop: () => getText('navigation', 'stop'),\n      pause: () => getText('navigation', 'pause'),\n      resume: () => getText('navigation', 'resume'),\n    }),\n    [getText],\n  );\n\n  const search = useMemo(\n    () => ({\n      placeholder: () => getText('search', 'placeholder'),\n      ariaLabel: () => getText('search', 'ariaLabel'),\n      clearLabel: () => getText('search', 'clearLabel'),\n      nextMatch: () => getText('search', 'nextMatch'),\n      previousMatch: () => getText('search', 'previousMatch'),\n      resultsCount: (current: number, total: number) =>\n        getText('search', 'resultsCount', { current, total }),\n      noResults: () => getText('search', 'noResults'),\n      navigationLabel: () => getText('search', 'navigationLabel'),\n    }),\n    [getText],\n  );\n\n  const theme = useMemo(\n    () => ({\n      darkMode: () => getText('theme', 'darkMode'),\n      lightMode: () => getText('theme', 'lightMode'),\n      toggleTheme: () => getText('theme', 'toggleTheme'),\n    }),\n    [getText],\n  );\n\n  const layout = useMemo(\n    () => ({\n      vertical: () => getText('layout', 'vertical'),\n      horizontal: () => getText('layout', 'horizontal'),\n      alternating: () => getText('layout', 'alternating'),\n      horizontalAll: () => getText('layout', 'horizontalAll'),\n      switchLayout: () => getText('layout', 'switchLayout'),\n      layoutSelection: () => getText('layout', 'layoutSelection'),\n    }),\n    [getText],\n  );\n\n  const fullscreen = useMemo(\n    () => ({\n      enterFullscreen: () => getText('fullscreen', 'enterFullscreen'),\n      exitFullscreen: () => getText('fullscreen', 'exitFullscreen'),\n      notSupported: () => getText('fullscreen', 'notSupported'),\n      errorMessage: () => getText('fullscreen', 'errorMessage'),\n    }),\n    [getText],\n  );\n\n  const quickJump = useMemo(\n    () => ({\n      jumpTo: () => getText('quickJump', 'jumpTo'),\n      jumpToAriaLabel: () => getText('quickJump', 'jumpToAriaLabel'),\n      itemTemplate: (index: number, title: string) =>\n        getText('quickJump', 'itemTemplate', { index, title }),\n    }),\n    [getText],\n  );\n\n  const content = useMemo(\n    () => ({\n      readMore: () => getText('content', 'readMore'),\n      showLess: () => getText('content', 'showLess'),\n      expand: () => getText('content', 'expand'),\n      collapse: () => getText('content', 'collapse'),\n      cardInteraction: () => getText('content', 'cardInteraction'),\n    }),\n    [getText],\n  );\n\n  const status = useMemo(\n    () => ({\n      loading: () => getText('status', 'loading'),\n      error: () => getText('status', 'error'),\n      noItems: () => getText('status', 'noItems'),\n      empty: () => getText('status', 'empty'),\n    }),\n    [getText],\n  );\n\n  const accessibility = useMemo(\n    () => ({\n      timelineNavigation: () => getText('accessibility', 'timelineNavigation'),\n      timelineContainer: () => getText('accessibility', 'timelineContainer'),\n      timelineItem: () => getText('accessibility', 'timelineItem'),\n      activeItem: () => getText('accessibility', 'activeItem'),\n      timelinePoint: () => getText('accessibility', 'timelinePoint'),\n      timelineCard: () => getText('accessibility', 'timelineCard'),\n      nestedItems: () => getText('accessibility', 'nestedItems'),\n      itemPosition: (current: number, total: number) =>\n        getText('accessibility', 'itemPosition', { current, total }),\n    }),\n    [getText],\n  );\n\n  const view = useMemo(\n    () => ({\n      compact: () => getText('view', 'compact'),\n      detailed: () => getText('view', 'detailed'),\n      toggleDensity: () => getText('view', 'toggleDensity'),\n      densitySelection: () => getText('view', 'densitySelection'),\n    }),\n    [getText],\n  );\n\n  const keyboard = useMemo(\n    () => ({\n      arrowKeys: () => getText('keyboard', 'arrowKeys'),\n      homeKey: () => getText('keyboard', 'homeKey'),\n      endKey: () => getText('keyboard', 'endKey'),\n      enterKey: () => getText('keyboard', 'enterKey'),\n      escapeKey: () => getText('keyboard', 'escapeKey'),\n      tabNavigation: () => getText('keyboard', 'tabNavigation'),\n      keyboardHelp: () => getText('keyboard', 'keyboardHelp'),\n    }),\n    [getText],\n  );\n\n  return {\n    // Raw text configuration\n    texts,\n    // Generic text getter with interpolation\n    getText,\n    // Category-specific helpers\n    navigation,\n    search,\n    theme,\n    layout,\n    fullscreen,\n    quickJump,\n    content,\n    status,\n    accessibility,\n    view,\n    keyboard,\n  };\n}\n\n/**\n * Legacy compatibility helper - maps new i18n structure to old buttonTexts format\n */\nexport function mapI18nToButtonTexts(i18nConfig?: TimelineI18nConfig) {\n  const { navigation, search, theme } = useI18n(i18nConfig);\n\n  return {\n    first: navigation.first(),\n    last: navigation.last(),\n    next: navigation.next(),\n    previous: navigation.previous(),\n    play: navigation.play(),\n    stop: navigation.stop(),\n    searchPlaceholder: search.placeholder(),\n    searchAriaLabel: search.ariaLabel(),\n    clearSearch: search.clearLabel(),\n    nextMatch: search.nextMatch(),\n    previousMatch: search.previousMatch(),\n    dark: theme.darkMode(),\n    light: theme.lightMode(),\n  };\n}\n","/**\n * Modular text resolver utility for timeline components\n *\n * This utility provides a clean, maintainable way to resolve text values\n * with support for i18n, legacy buttonTexts, and fallbacks.\n */\n\nimport { ButtonTexts } from '@models/TimelineModel';\nimport { useI18n } from '@hooks/useI18n';\n\n/**\n * Text resolver interface that provides type-safe text resolution\n */\nexport interface TextResolver {\n  // Navigation texts\n  firstItem(): string;\n  lastItem(): string;\n  nextItem(): string;\n  previousItem(): string;\n  playSlideshow(): string;\n  stopSlideshow(): string;\n  pauseSlideshow(): string;\n  resumeSlideshow(): string;\n\n  // Search texts\n  searchPlaceholder(): string;\n  searchAriaLabel(): string;\n  clearSearch(): string;\n  nextMatch(): string;\n  previousMatch(): string;\n  searchResults(current: number, total: number): string;\n  noSearchResults(): string;\n  searchNavigation(): string;\n\n  // Theme texts\n  darkMode(): string;\n  lightMode(): string;\n  toggleTheme(): string;\n\n  // Layout texts\n  verticalLayout(): string;\n  horizontalLayout(): string;\n  alternatingLayout(): string;\n  horizontalAllLayout(): string;\n  switchLayout(): string;\n\n  // Fullscreen texts\n  enterFullscreen(): string;\n  exitFullscreen(): string;\n  fullscreenNotSupported(): string;\n  fullscreenError(): string;\n\n  // Content texts\n  readMore(): string;\n  showLess(): string;\n  expandContent(): string;\n  collapseContent(): string;\n\n  // Accessibility texts\n  timelineNavigation(): string;\n  timelineContainer(): string;\n  timelineItem(): string;\n  activeItem(): string;\n  itemPosition(current: number, total: number): string;\n\n  // Status texts\n  loading(): string;\n  error(): string;\n  noItems(): string;\n  empty(): string;\n}\n\n/**\n * Creates a text resolver that handles i18n, legacy, and default fallbacks\n */\nexport function createTextResolver(\n  i18nHelper?: ReturnType<typeof useI18n>,\n  buttonTexts?: ButtonTexts,\n): TextResolver {\n  // Helper function to resolve text with priority: i18n > legacy > default\n  const resolve = (\n    i18nGetter: (() => string) | undefined,\n    legacyValue: string | undefined,\n    defaultValue: string,\n  ): string => {\n    if (i18nGetter) {\n      const i18nValue = i18nGetter();\n      if (i18nValue !== undefined) return i18nValue;\n    }\n    return legacyValue !== undefined ? legacyValue : defaultValue;\n  };\n\n  return {\n    // Navigation texts\n    firstItem: () =>\n      resolve(\n        i18nHelper?.navigation.first,\n        buttonTexts?.first,\n        'Go to first item',\n      ),\n\n    lastItem: () =>\n      resolve(\n        i18nHelper?.navigation.last,\n        buttonTexts?.last,\n        'Go to last item',\n      ),\n\n    nextItem: () =>\n      resolve(i18nHelper?.navigation.next, buttonTexts?.next, 'Next item'),\n\n    previousItem: () =>\n      resolve(\n        i18nHelper?.navigation.previous,\n        buttonTexts?.previous,\n        'Previous item',\n      ),\n\n    playSlideshow: () =>\n      resolve(\n        i18nHelper?.navigation.play,\n        buttonTexts?.play,\n        'Start slideshow',\n      ),\n\n    stopSlideshow: () =>\n      resolve(i18nHelper?.navigation.stop, buttonTexts?.stop, 'Stop slideshow'),\n\n    pauseSlideshow: () =>\n      resolve(i18nHelper?.navigation.pause, undefined, 'Pause slideshow'),\n\n    resumeSlideshow: () =>\n      resolve(i18nHelper?.navigation.resume, undefined, 'Resume slideshow'),\n\n    // Search texts\n    searchPlaceholder: () =>\n      resolve(\n        i18nHelper?.search.placeholder,\n        (buttonTexts as any)?.searchPlaceholder,\n        'Search Timeline',\n      ),\n\n    searchAriaLabel: () =>\n      resolve(\n        i18nHelper?.search.ariaLabel,\n        (buttonTexts as any)?.searchAriaLabel,\n        'Search timeline content',\n      ),\n\n    clearSearch: () =>\n      resolve(\n        i18nHelper?.search.clearLabel,\n        (buttonTexts as any)?.clearSearch,\n        'Clear Search',\n      ),\n\n    nextMatch: () =>\n      resolve(\n        i18nHelper?.search.nextMatch,\n        (buttonTexts as any)?.nextMatch,\n        'Next Match (Enter)',\n      ),\n\n    previousMatch: () =>\n      resolve(\n        i18nHelper?.search.previousMatch,\n        (buttonTexts as any)?.previousMatch,\n        'Previous Match (Shift+Enter)',\n      ),\n\n    searchResults: (current: number, total: number) => {\n      return (\n        i18nHelper?.search.resultsCount(current, total) ||\n        `${current} of ${total}`\n      );\n    },\n\n    noSearchResults: () =>\n      resolve(i18nHelper?.search.noResults, undefined, 'No results found'),\n\n    searchNavigation: () =>\n      resolve(\n        i18nHelper?.search.navigationLabel,\n        undefined,\n        'Search navigation',\n      ),\n\n    // Theme texts\n    darkMode: () =>\n      resolve(\n        i18nHelper?.theme.darkMode,\n        (buttonTexts as any)?.dark,\n        'Switch to dark mode',\n      ),\n\n    lightMode: () =>\n      resolve(\n        i18nHelper?.theme.lightMode,\n        (buttonTexts as any)?.light,\n        'Switch to light mode',\n      ),\n\n    toggleTheme: () =>\n      resolve(i18nHelper?.theme.toggleTheme, undefined, 'Toggle theme'),\n\n    // Layout texts\n    verticalLayout: () =>\n      resolve(i18nHelper?.layout.vertical, undefined, 'Vertical layout'),\n\n    horizontalLayout: () =>\n      resolve(i18nHelper?.layout.horizontal, undefined, 'Horizontal layout'),\n\n    alternatingLayout: () =>\n      resolve(i18nHelper?.layout.alternating, undefined, 'Alternating layout'),\n\n    horizontalAllLayout: () =>\n      resolve(\n        i18nHelper?.layout.horizontalAll,\n        undefined,\n        'Horizontal all layout',\n      ),\n\n    switchLayout: () =>\n      resolve(i18nHelper?.layout.switchLayout, undefined, 'Switch layout'),\n\n    // Fullscreen texts\n    enterFullscreen: () =>\n      resolve(\n        i18nHelper?.fullscreen.enterFullscreen,\n        undefined,\n        'Enter fullscreen',\n      ),\n\n    exitFullscreen: () =>\n      resolve(\n        i18nHelper?.fullscreen.exitFullscreen,\n        undefined,\n        'Exit fullscreen',\n      ),\n\n    fullscreenNotSupported: () =>\n      resolve(\n        i18nHelper?.fullscreen.notSupported,\n        undefined,\n        'Fullscreen not supported',\n      ),\n\n    fullscreenError: () =>\n      resolve(\n        i18nHelper?.fullscreen.errorMessage,\n        undefined,\n        'Failed to enter fullscreen mode',\n      ),\n\n    // Content texts\n    readMore: () =>\n      resolve(i18nHelper?.content.readMore, undefined, 'Read More'),\n\n    showLess: () =>\n      resolve(i18nHelper?.content.showLess, undefined, 'Show Less'),\n\n    expandContent: () =>\n      resolve(i18nHelper?.content.expand, undefined, 'Expand'),\n\n    collapseContent: () =>\n      resolve(i18nHelper?.content.collapse, undefined, 'Collapse'),\n\n    // Accessibility texts\n    timelineNavigation: () =>\n      resolve(\n        i18nHelper?.accessibility.timelineNavigation,\n        undefined,\n        'Timeline Navigation',\n      ),\n\n    timelineContainer: () =>\n      resolve(\n        i18nHelper?.accessibility.timelineContainer,\n        undefined,\n        'Timeline Container',\n      ),\n\n    timelineItem: () =>\n      resolve(\n        i18nHelper?.accessibility.timelineItem,\n        undefined,\n        'Timeline Item',\n      ),\n\n    activeItem: () =>\n      resolve(\n        i18nHelper?.accessibility.activeItem,\n        undefined,\n        'Active Timeline Item',\n      ),\n\n    itemPosition: (current: number, total: number) => {\n      return (\n        i18nHelper?.accessibility.itemPosition(current, total) ||\n        `Item ${current} of ${total}`\n      );\n    },\n\n    // Status texts\n    loading: () =>\n      resolve(i18nHelper?.status.loading, undefined, 'Loading timeline...'),\n\n    error: () =>\n      resolve(i18nHelper?.status.error, undefined, 'Error loading timeline'),\n\n    noItems: () =>\n      resolve(\n        i18nHelper?.status.noItems,\n        undefined,\n        'No timeline items available',\n      ),\n\n    empty: () =>\n      resolve(i18nHelper?.status.empty, undefined, 'Timeline is empty'),\n  };\n}\n\n/**\n * Hook that provides a configured text resolver from the timeline context\n * Note: This should only be used within components that are wrapped by TimelineContextProvider\n */\nexport function useTextResolver(): TextResolver {\n  // This will be implemented when needed, for now components can directly access textResolver from context\n  // Components should use: const { textResolver } = useTimelineContext();\n  throw new Error(\n    'useTextResolver should be implemented when needed. Use useTimelineContext().textResolver instead.',\n  );\n}\n","/**\n * Unified Timeline Context Provider\n *\n * This provider replaces the multiple context layers with a single,\n * clean context system that properly handles all timeline props.\n */\nimport React, {\n  FunctionComponent,\n  useCallback,\n  useMemo,\n  useState,\n  useEffect,\n  createContext,\n  useContext,\n} from 'react';\nimport {\n  TimelineProps as TimelinePropsModel,\n  TextDensity,\n  ButtonTexts,\n  SlideShowType,\n} from '@models/TimelineModel';\nimport { Theme } from '@models/Theme';\nimport {\n  getDefaultButtonTexts,\n  getDefaultClassNames,\n  getDefaultThemeOrDark,\n  getSlideShowType,\n} from '@utils/index';\nimport { useMatchMedia } from '../effects/useMatchMedia';\nimport { TimelineI18nConfig } from '@models/TimelineI18n';\nimport { useI18n } from '@hooks/useI18n';\nimport { createTextResolver, TextResolver } from '@utils/textResolver';\n\n// ==========================================\n// CONTEXT INTERFACES\n// ==========================================\n\n/**\n * Static configuration that rarely changes\n */\nexport interface TimelineStaticConfig {\n  // Core layout\n  mode: NonNullable<TimelinePropsModel['mode']>;\n  cardHeight: number | 'auto';\n  cardWidth: number;\n  cardLess: boolean;\n  flipLayout: boolean;\n  itemWidth: number;\n  lineWidth: number;\n\n  // Media configuration\n  mediaHeight: number;\n  mediaSettings: {\n    align: 'left' | 'right' | 'center';\n    fit: 'cover' | 'contain' | 'fill' | 'none';\n  };\n\n  // Timeline point configuration\n  timelinePointDimension: number;\n  timelinePointShape: 'circle' | 'square' | 'diamond';\n\n  // Interaction settings\n  disableNavOnKey: boolean;\n  disableAutoScrollOnClick: boolean;\n  disableInteraction: boolean;\n  disableClickOnCircle: boolean;\n  disableTimelinePoint: boolean;\n\n  // UI features\n  enableBreakPoint: boolean;\n  enableDarkToggle: boolean;\n  enableLayoutSwitch: boolean;\n  enableQuickJump: boolean;\n  focusActiveItemOnLoad: boolean;\n  highlightCardsOnHover: boolean;\n\n  // Cards and content\n  borderLessCards: boolean;\n  cardPositionHorizontal: 'TOP' | 'BOTTOM';\n  parseDetailsAsHTML: boolean;\n  useReadMore: boolean;\n  textOverlay: boolean;\n  contentAlignment: {\n    horizontal: 'left' | 'center' | 'right' | 'stretch';\n    vertical: 'top' | 'center' | 'bottom' | 'stretch';\n  };\n\n  // Scrolling\n  scrollable: boolean | { scrollbar: boolean };\n\n  // Toolbar\n  toolbarPosition: 'top' | 'bottom';\n  disableToolbar: boolean;\n  toolbarSearchConfig:\n    | {\n        width?: string;\n        maxWidth?: string;\n        minWidth?: string;\n        inputWidth?: string;\n        inputMaxWidth?: string;\n      }\n    | undefined;\n\n  // Slideshow\n  slideItemDuration: number;\n  showProgressOnSlideshow: boolean;\n  showOverallSlideshowProgress: boolean;\n\n  // Misc\n  titleDateFormat: string;\n  uniqueId: string;\n  nestedCardHeight: number;\n  contentDetailsHeight: number;\n  responsiveBreakPoint: number;\n  noUniqueId: boolean;\n  isChild: boolean;\n}\n\n/**\n * Dynamic state that changes frequently\n */\nexport interface TimelineDynamicState {\n  isDarkMode: boolean;\n  isMobile: boolean;\n  showAllCardsHorizontal: boolean;\n  textContentDensity: TextDensity;\n\n  // Actions\n  toggleDarkMode: () => void;\n  updateShowAllCardsHorizontal: (state: boolean) => void;\n  updateTextContentDensity: (density: TextDensity) => void;\n}\n\n/**\n * Memoized objects that change less frequently\n */\nexport interface TimelineMemoizedObjects {\n  theme: Theme;\n  buttonTexts: ButtonTexts;\n  classNames: Record<string, string>;\n  fontSizes: Record<string, string>;\n  isDarkMode: boolean;\n  semanticTags: Record<string, string>;\n  slideShowType: SlideShowType;\n  googleFonts: any;\n  i18nConfig: TimelineI18nConfig | undefined;\n  i18nHelper: ReturnType<typeof useI18n>;\n  textResolver: TextResolver;\n}\n\n/**\n * Combined context interface\n */\nexport interface TimelineContextValue\n  extends TimelineStaticConfig, TimelineDynamicState, TimelineMemoizedObjects {\n  // Computed values\n  computedCardHeight: number | 'auto';\n  computedActiveItemIndex: number;\n  computedMediaAlign: string;\n\n  // Timeline-specific data\n  items?: TimelinePropsModel['items'];\n  activeItemIndex?: number;\n\n  // Callbacks\n  onScrollEnd: () => void;\n  onThemeChange: () => void;\n}\n\n// ==========================================\n// CONTEXT CREATION\n// ==========================================\n\nconst TimelineContext = createContext<TimelineContextValue | null>(null);\n\n// ==========================================\n// PROVIDER PROPS AND COMPONENT\n// ==========================================\n\nexport interface TimelineContextProviderProps extends Omit<\n  Partial<TimelinePropsModel>,\n  'children'\n> {\n  children: React.ReactNode;\n  toolbarSearchConfig?: {\n    width?: string;\n    maxWidth?: string;\n    minWidth?: string;\n    inputWidth?: string;\n    inputMaxWidth?: string;\n  };\n  googleFonts?: {\n    fontFamily: string;\n    elements?: {\n      title?: { weight?: any; style?: any; size?: string };\n      cardTitle?: { weight?: any; style?: any; size?: string };\n      cardSubtitle?: { weight?: any; style?: any; size?: string };\n      cardText?: { weight?: any; style?: any; size?: string };\n      controls?: { weight?: any; style?: any; size?: string };\n    };\n    weights?: any[];\n    display?: string;\n    preconnect?: boolean;\n  };\n  i18nConfig?: TimelineI18nConfig;\n}\n\nexport const TimelineContextProvider: FunctionComponent<\n  TimelineContextProviderProps\n> = (props) => {\n  const {\n    children,\n    // Core props with defaults\n    mode = 'VERTICAL_ALTERNATING',\n    cardHeight = 200,\n    cardWidth,\n    cardLess = false,\n    flipLayout,\n    itemWidth = 200,\n    lineWidth = 3,\n\n    // Media props\n    mediaHeight = 200,\n    mediaSettings,\n\n    // Timeline point props\n    timelinePointDimension = 16,\n    timelinePointShape = 'circle',\n\n    // Interaction props\n    disableNavOnKey = false,\n    disableAutoScrollOnClick = false,\n    disableInteraction = false,\n    disableClickOnCircle = false,\n    disableTimelinePoint = false,\n\n    // UI feature props\n    enableBreakPoint = true,\n    enableDarkToggle = false,\n    enableLayoutSwitch = true,\n    enableQuickJump = true,\n    focusActiveItemOnLoad = false,\n    highlightCardsOnHover = false,\n\n    // Cards and content props\n    borderLessCards = false,\n    cardPositionHorizontal,\n    parseDetailsAsHTML = false,\n    useReadMore = true,\n    textOverlay,\n    contentAlignment = { horizontal: 'left', vertical: 'top' },\n\n    // Scrolling props (default aligns with legacy behavior: no scrollbar)\n    scrollable = { scrollbar: false },\n\n    // Toolbar props\n    toolbarPosition = 'top',\n    disableToolbar = false,\n    toolbarSearchConfig,\n\n    // Slideshow props\n    slideItemDuration = 2000,\n    showProgressOnSlideshow = true,\n    showOverallSlideshowProgress,\n    slideShow,\n    slideShowType,\n\n    // Other props\n    titleDateFormat = 'MMM DD, YYYY',\n    uniqueId = 'react-chrono',\n    nestedCardHeight = 150,\n    contentDetailsHeight = 10,\n    responsiveBreakPoint = 1024,\n    noUniqueId = false,\n    isChild = false,\n\n    // Dynamic props\n    darkMode = false,\n    showAllCardsHorizontal = false,\n    textDensity = 'HIGH' as TextDensity,\n\n    // Customization props\n    theme,\n    buttonTexts,\n    classNames,\n    fontSizes,\n    semanticTags,\n\n    // i18n props\n    i18nConfig,\n\n    // Data props\n    items,\n    activeItemIndex = 0,\n\n    // Callbacks\n    onScrollEnd,\n    onThemeChange,\n  } = props;\n\n  // ==========================================\n  // DYNAMIC STATE\n  // ==========================================\n  const [isDarkMode, setIsDarkMode] = useState(darkMode);\n  const [showAllCards, setShowAllCards] = useState(\n    mode === 'HORIZONTAL_ALL' ? true : showAllCardsHorizontal,\n  );\n  const [isMobileDetected, setIsMobileDetected] = useState(false);\n  const [textContentDensity, setTextContentDensity] =\n    useState<TextDensity>(textDensity);\n\n  // ==========================================\n  // CALLBACKS\n  // ==========================================\n  const toggleDarkMode = useCallback(() => {\n    setIsDarkMode(!isDarkMode);\n    onThemeChange?.();\n  }, [isDarkMode, onThemeChange]);\n\n  const updateShowAllCardsHorizontal = useCallback((state: boolean) => {\n    setShowAllCards(state);\n  }, []);\n\n  const updateTextContentDensity = useCallback((density: TextDensity) => {\n    setTextContentDensity(density);\n  }, []);\n\n  // ==========================================\n  // MODE SYNCHRONIZATION\n  // ==========================================\n  // Sync internal darkMode state with prop changes\n  useEffect(() => {\n    setIsDarkMode(darkMode);\n  }, [darkMode]);\n\n  // Update showAllCardsHorizontal when mode or prop changes\n  useEffect(() => {\n    if (mode === 'HORIZONTAL_ALL') {\n      setShowAllCards(true);\n    } else if (mode === 'HORIZONTAL') {\n      // Respect the incoming prop to allow HORIZONTAL + showAllCardsHorizontal\n      setShowAllCards(showAllCardsHorizontal);\n    }\n  }, [mode, showAllCardsHorizontal]);\n\n  // ==========================================\n  // RESPONSIVE DETECTION\n  // ==========================================\n  useMatchMedia(`(max-width: ${responsiveBreakPoint - 1}px)`, {\n    onMatch: () => setIsMobileDetected(true),\n    enabled: enableBreakPoint,\n  });\n\n  useMatchMedia(`(min-width: ${responsiveBreakPoint}px)`, {\n    onMatch: () => setIsMobileDetected(false),\n    enabled: enableBreakPoint,\n  });\n\n  // ==========================================\n  // COMPUTED VALUES\n  // ==========================================\n  const computedCardHeight = useMemo(() => {\n    // FIX for Issue #498: Handle 'auto' cardHeight\n    if (cardHeight === 'auto') {\n      return 'auto';\n    }\n    return cardLess ? Math.min(cardHeight, 80) : cardHeight;\n  }, [cardLess, cardHeight]);\n\n  const computedActiveItemIndex = useMemo(\n    () => (flipLayout && items ? items.length - 1 : 0),\n    [flipLayout, items?.length],\n  );\n\n  const computedMediaAlign = useMemo(\n    () => (mode === 'VERTICAL' && !textOverlay ? 'left' : 'center'),\n    [mode, textOverlay],\n  );\n\n  // ==========================================\n  // MEMOIZED OBJECTS\n  // ==========================================\n  const memoizedTheme = useMemo(\n    () => ({\n      ...getDefaultThemeOrDark(isDarkMode),\n      ...theme,\n    }),\n    [isDarkMode, theme],\n  );\n\n  // Setup i18n helper first\n  const i18nHelper = useI18n(i18nConfig);\n\n  // Create text resolver with i18n and legacy support\n  const textResolver = useMemo(\n    () => createTextResolver(i18nHelper, buttonTexts),\n    [i18nHelper, buttonTexts],\n  );\n\n  const memoizedButtonTexts = useMemo(\n    () => ({\n      ...getDefaultButtonTexts(),\n      ...buttonTexts,\n    }),\n    [buttonTexts],\n  );\n\n  const memoizedClassNames = useMemo(\n    () => ({\n      ...getDefaultClassNames(),\n      ...classNames,\n    }),\n    [classNames],\n  );\n\n  const memoizedFontSizes = useMemo(\n    () => ({\n      cardSubtitle: '0.85rem',\n      cardText: '1rem',\n      cardTitle: '1rem',\n      title: '1rem',\n      ...fontSizes,\n    }),\n    [fontSizes],\n  );\n\n  // Google Fonts integration\n  const googleFontsConfig = useMemo(() => {\n    // If no Google Fonts specified, use a default one\n    if (!props.googleFonts) {\n      return {\n        fontFamily: 'Inter',\n        elements: {\n          title: { weight: 600, style: 'normal' },\n          cardTitle: { weight: 500, style: 'normal' },\n          cardSubtitle: { weight: 400, style: 'normal' },\n          cardText: { weight: 400, style: 'normal' },\n          controls: { weight: 500, style: 'normal' },\n        },\n        weights: [400, 500, 600],\n        display: 'swap',\n        preconnect: true,\n      };\n    }\n\n    // If we have both fontSizes and googleFonts, merge them\n    if (props.googleFonts) {\n      return {\n        ...props.googleFonts,\n        elements: {\n          ...props.googleFonts.elements,\n          // Override sizes from fontSizes if provided\n          ...(memoizedFontSizes.title && {\n            title: {\n              ...props.googleFonts.elements?.title,\n              size: memoizedFontSizes.title,\n            },\n          }),\n          ...(memoizedFontSizes.cardTitle && {\n            cardTitle: {\n              ...props.googleFonts.elements?.cardTitle,\n              size: memoizedFontSizes.cardTitle,\n            },\n          }),\n          ...(memoizedFontSizes.cardSubtitle && {\n            cardSubtitle: {\n              ...props.googleFonts.elements?.cardSubtitle,\n              size: memoizedFontSizes.cardSubtitle,\n            },\n          }),\n          ...(memoizedFontSizes.cardText && {\n            cardText: {\n              ...props.googleFonts.elements?.cardText,\n              size: memoizedFontSizes.cardText,\n            },\n          }),\n        },\n      };\n    }\n\n    return null;\n  }, [props.googleFonts, memoizedFontSizes]);\n\n  const memoizedMediaSettings = useMemo(\n    () => ({\n      align: computedMediaAlign as 'left' | 'right' | 'center',\n      fit: 'cover' as const,\n      ...mediaSettings,\n    }),\n    [computedMediaAlign, mediaSettings],\n  );\n\n  const memoizedContentAlignment = useMemo(\n    () => ({\n      horizontal: contentAlignment.horizontal || ('left' as const),\n      vertical: contentAlignment.vertical || ('top' as const),\n    }),\n    [contentAlignment],\n  );\n\n  const memoizedSemanticTags = useMemo(\n    () => ({\n      cardTitle: 'span' as const,\n      cardSubtitle: 'span' as const,\n      ...semanticTags,\n    }),\n    [semanticTags],\n  );\n\n  const memoizedSlideShowType = useMemo(\n    () => slideShowType ?? getSlideShowType(mode),\n    [slideShowType, mode],\n  );\n\n  // ==========================================\n  // CONTEXT VALUE\n  // ==========================================\n  const contextValue = useMemo(\n    (): TimelineContextValue => ({\n      // Static configuration\n      mode,\n      cardHeight,\n      cardWidth: cardWidth || 400,\n      cardLess,\n      flipLayout: flipLayout || false,\n      itemWidth,\n      lineWidth,\n      mediaHeight,\n      mediaSettings: memoizedMediaSettings,\n      timelinePointDimension,\n      timelinePointShape,\n      disableNavOnKey,\n      disableAutoScrollOnClick: disableAutoScrollOnClick || disableInteraction,\n      disableInteraction,\n      disableClickOnCircle: disableClickOnCircle || disableInteraction,\n      disableTimelinePoint: disableTimelinePoint || disableInteraction,\n      enableBreakPoint,\n      enableDarkToggle,\n      enableLayoutSwitch,\n      enableQuickJump,\n      focusActiveItemOnLoad,\n      highlightCardsOnHover,\n      borderLessCards,\n      cardPositionHorizontal: cardPositionHorizontal ?? 'BOTTOM',\n      parseDetailsAsHTML,\n      useReadMore,\n      textOverlay: textOverlay || false,\n      contentAlignment: memoizedContentAlignment,\n      scrollable,\n      toolbarPosition,\n      disableToolbar,\n      toolbarSearchConfig,\n      slideItemDuration,\n      showProgressOnSlideshow: showProgressOnSlideshow && !!slideShow,\n      showOverallSlideshowProgress: showOverallSlideshowProgress ?? !!slideShow,\n      titleDateFormat,\n      uniqueId,\n      nestedCardHeight,\n      contentDetailsHeight: Math.max(contentDetailsHeight, mediaHeight * 0.75),\n      responsiveBreakPoint,\n      noUniqueId,\n      isChild,\n\n      // Dynamic state\n      isDarkMode,\n      isMobile: isMobileDetected,\n      showAllCardsHorizontal: showAllCards,\n      textContentDensity,\n      toggleDarkMode,\n      updateShowAllCardsHorizontal,\n      updateTextContentDensity,\n\n      // Memoized objects\n      theme: memoizedTheme,\n      buttonTexts: memoizedButtonTexts,\n      classNames: memoizedClassNames,\n      fontSizes: memoizedFontSizes,\n      semanticTags: memoizedSemanticTags,\n      slideShowType: memoizedSlideShowType,\n      googleFonts: googleFontsConfig,\n      i18nConfig,\n      i18nHelper,\n      textResolver,\n\n      // Computed values\n      computedCardHeight,\n      computedActiveItemIndex,\n      computedMediaAlign,\n\n      // Timeline-specific data\n      items,\n      activeItemIndex,\n\n      // Callbacks\n      onScrollEnd: onScrollEnd || (() => {}),\n      onThemeChange: onThemeChange || (() => {}),\n    }),\n    [\n      // Static config dependencies\n      mode,\n      cardHeight,\n      cardWidth,\n      cardLess,\n      flipLayout,\n      itemWidth,\n      lineWidth,\n      mediaHeight,\n      memoizedMediaSettings,\n      memoizedContentAlignment,\n      timelinePointDimension,\n      timelinePointShape,\n      disableNavOnKey,\n      disableAutoScrollOnClick,\n      disableInteraction,\n      disableClickOnCircle,\n      disableTimelinePoint,\n      enableBreakPoint,\n      enableDarkToggle,\n      enableLayoutSwitch,\n      enableQuickJump,\n      focusActiveItemOnLoad,\n      highlightCardsOnHover,\n      borderLessCards,\n      cardPositionHorizontal,\n      parseDetailsAsHTML,\n      useReadMore,\n      textOverlay,\n      contentAlignment,\n      scrollable,\n      toolbarPosition,\n      disableToolbar,\n      toolbarSearchConfig,\n      slideItemDuration,\n      showProgressOnSlideshow,\n      showOverallSlideshowProgress,\n      slideShow,\n      titleDateFormat,\n      uniqueId,\n      nestedCardHeight,\n      contentDetailsHeight,\n      responsiveBreakPoint,\n      noUniqueId,\n      isChild,\n\n      // Dynamic state dependencies\n      isDarkMode,\n      isMobileDetected,\n      showAllCards,\n      textContentDensity,\n      toggleDarkMode,\n      updateShowAllCardsHorizontal,\n      updateTextContentDensity,\n\n      // Memoized objects dependencies\n      memoizedTheme,\n      memoizedButtonTexts,\n      memoizedClassNames,\n      memoizedFontSizes,\n      memoizedSemanticTags,\n      memoizedSlideShowType,\n      googleFontsConfig,\n      i18nConfig,\n      textResolver,\n\n      // Computed values dependencies\n      computedCardHeight,\n      computedActiveItemIndex,\n      computedMediaAlign,\n\n      // Data dependencies\n      items,\n      activeItemIndex,\n\n      // Callback dependencies\n      onScrollEnd,\n      onThemeChange,\n    ],\n  );\n\n  return (\n    <TimelineContext.Provider value={contextValue}>\n      {children}\n    </TimelineContext.Provider>\n  );\n};\n\n// ==========================================\n// CONTEXT HOOK\n// ==========================================\n\n/**\n * Hook to access the timeline context\n */\nexport const useTimelineContext = (): TimelineContextValue => {\n  const context = useContext(TimelineContext);\n\n  if (!context) {\n    throw new Error(\n      'useTimelineContext must be used within a TimelineContextProvider',\n    );\n  }\n\n  return context;\n};\n\n/**\n * Hook to access only static configuration (performance optimized)\n */\nexport const useTimelineStaticConfig = (): TimelineStaticConfig => {\n  const context = useTimelineContext();\n\n  return useMemo(\n    () => ({\n      mode: context.mode,\n      cardHeight: context.cardHeight,\n      cardWidth: context.cardWidth || 400,\n      cardLess: context.cardLess,\n      flipLayout: context.flipLayout || false,\n      itemWidth: context.itemWidth,\n      lineWidth: context.lineWidth,\n      mediaHeight: context.mediaHeight,\n      mediaSettings: context.mediaSettings,\n      timelinePointDimension: context.timelinePointDimension,\n      timelinePointShape: context.timelinePointShape,\n      disableNavOnKey: context.disableNavOnKey,\n      disableAutoScrollOnClick: context.disableAutoScrollOnClick,\n      disableInteraction: context.disableInteraction,\n      disableClickOnCircle: context.disableClickOnCircle,\n      disableTimelinePoint: context.disableTimelinePoint,\n      enableBreakPoint: context.enableBreakPoint,\n      enableDarkToggle: context.enableDarkToggle,\n      enableLayoutSwitch: context.enableLayoutSwitch,\n      enableQuickJump: context.enableQuickJump,\n      focusActiveItemOnLoad: context.focusActiveItemOnLoad,\n      highlightCardsOnHover: context.highlightCardsOnHover,\n      borderLessCards: context.borderLessCards,\n      cardPositionHorizontal: context.cardPositionHorizontal,\n      parseDetailsAsHTML: context.parseDetailsAsHTML,\n      useReadMore: context.useReadMore,\n      textOverlay: context.textOverlay,\n      contentAlignment: context.contentAlignment,\n      scrollable: context.scrollable,\n      toolbarPosition: context.toolbarPosition,\n      disableToolbar: context.disableToolbar,\n      toolbarSearchConfig: context.toolbarSearchConfig,\n      slideItemDuration: context.slideItemDuration,\n      showProgressOnSlideshow: context.showProgressOnSlideshow,\n      showOverallSlideshowProgress: context.showOverallSlideshowProgress,\n      titleDateFormat: context.titleDateFormat,\n      uniqueId: context.uniqueId,\n      nestedCardHeight: context.nestedCardHeight,\n      contentDetailsHeight: context.contentDetailsHeight,\n      responsiveBreakPoint: context.responsiveBreakPoint,\n      noUniqueId: context.noUniqueId,\n      isChild: context.isChild,\n    }),\n    [context],\n  );\n};\n\n/**\n * Hook to access only dynamic state (performance optimized)\n */\nexport const useTimelineDynamicState = (): TimelineDynamicState => {\n  const context = useTimelineContext();\n\n  return useMemo(\n    () => ({\n      isDarkMode: context.isDarkMode,\n      isMobile: context.isMobile,\n      showAllCardsHorizontal: context.showAllCardsHorizontal,\n      textContentDensity: context.textContentDensity,\n      toggleDarkMode: context.toggleDarkMode,\n      updateShowAllCardsHorizontal: context.updateShowAllCardsHorizontal,\n      updateTextContentDensity: context.updateTextContentDensity,\n    }),\n    [context],\n  );\n};\n\n/**\n * Hook to access only memoized objects (performance optimized)\n */\nexport const useTimelineMemoizedObjects = (): TimelineMemoizedObjects => {\n  const context = useTimelineContext();\n\n  return useMemo(\n    () => ({\n      theme: context.theme,\n      buttonTexts: context.buttonTexts,\n      classNames: context.classNames,\n      fontSizes: context.fontSizes,\n      isDarkMode: context.isDarkMode,\n      semanticTags: context.semanticTags,\n      slideShowType: context.slideShowType,\n      googleFonts: context.googleFonts,\n      i18nConfig: context.i18nConfig,\n      i18nHelper: context.i18nHelper,\n      textResolver: context.textResolver,\n    }),\n    [context],\n  );\n};\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import { Scroll } from '@models/TimelineHorizontalModel';\nimport { TimelineMode } from '@models/TimelineModel';\nimport { useMemo, useState } from 'react';\n\n/**\n * Hook to calculate the new scroll position based on the given mode and item width.\n *\n * @param {TimelineMode} mode - The mode of the timeline (HORIZONTAL, VERTICAL, or VERTICAL_ALTERNATING).\n * @param {number} [itemWidth] - Optional item width for horizontal mode.\n * @returns {[number, (e: HTMLElement, s: Partial<Scroll>) => void]} - The new offset and a function to compute the new offset.\n */\nconst useNewScrollPosition = (\n  mode: TimelineMode,\n  itemWidth?: number,\n): [number, (e: HTMLElement, s: Partial<Scroll>) => void] => {\n  // State to hold the new offset value\n  const [newOffset, setNewOffset] = useState(0);\n\n  const computeHorizontalOffset = (\n    scrollLeft: number,\n    clientWidth: number,\n    pointOffset: number,\n    pointWidth: number,\n    itemWidth: number,\n    setNewOffset: (offset: number) => void,\n  ) => {\n    const contrRight = scrollLeft + clientWidth;\n    const circRight = pointOffset + pointWidth;\n\n    const isVisible = pointOffset >= scrollLeft && circRight <= contrRight;\n    const isPartiallyVisible =\n      (pointOffset < scrollLeft && circRight > scrollLeft) ||\n      (circRight > contrRight && pointOffset < contrRight);\n\n    const leftGap = pointOffset - scrollLeft;\n    const rightGap = contrRight - pointOffset;\n\n    if (\n      !(isVisible || isPartiallyVisible) ||\n      (leftGap <= itemWidth && leftGap >= 0) ||\n      (rightGap <= itemWidth && rightGap >= 0)\n    ) {\n      setNewOffset(pointOffset - itemWidth);\n    }\n  };\n\n  const computeVerticalOffset = (\n    scrollTop: number,\n    clientHeight: number,\n    contentOffset: number,\n    contentHeight: number,\n    setNewOffset: (offset: number) => void,\n  ) => {\n    const contrBottom = scrollTop + clientHeight;\n    const circBottom = contentOffset + contentHeight;\n\n    const isVisible = contentOffset >= scrollTop && circBottom <= contrBottom;\n    const isPartiallyVisible =\n      (contentOffset < scrollTop && circBottom > scrollTop) ||\n      (circBottom > contrBottom && contentOffset < contrBottom);\n\n    const nOffset = contentOffset - contentHeight;\n    const notVisible = !isVisible || isPartiallyVisible;\n\n    if (notVisible && nOffset + contentHeight < contrBottom) {\n      setNewOffset(nOffset + Math.round(contentHeight / 2));\n    } else if (notVisible) {\n      setNewOffset(nOffset);\n    }\n  };\n\n  // Memoized function to compute the new offset value\n  const computeNewOffset = useMemo(\n    () => (parent: HTMLElement, scroll: Partial<Scroll>) => {\n      const { clientWidth, scrollLeft, scrollTop, clientHeight } = parent;\n      const {\n        pointOffset = 0,\n        pointWidth = 0,\n        contentHeight = 0,\n        contentOffset = 0,\n      } = scroll;\n\n      if ((mode === 'HORIZONTAL' || mode === 'HORIZONTAL_ALL') && itemWidth) {\n        computeHorizontalOffset(\n          scrollLeft,\n          clientWidth,\n          pointOffset,\n          pointWidth,\n          itemWidth,\n          setNewOffset,\n        );\n      } else if (mode === 'VERTICAL' || mode === 'VERTICAL_ALTERNATING') {\n        computeVerticalOffset(\n          scrollTop,\n          clientHeight,\n          contentOffset,\n          contentHeight,\n          setNewOffset,\n        );\n      }\n    },\n    [mode, itemWidth], // Dependencies for useMemo\n  );\n\n  // Returning the new offset and the function to compute it\n  return [newOffset, computeNewOffset];\n};\n\nexport default useNewScrollPosition;\n","import { useCallback, useEffect, useState, useRef } from 'react';\n\ninterface UseSlideshowProgressProps {\n  /** Whether the slideshow is currently running */\n  slideShowRunning: boolean;\n  /** Current active timeline item index */\n  activeTimelineItem: number;\n}\n\ninterface SlideshowProgressState {\n  /** Whether the slideshow progress is paused */\n  isPaused: boolean;\n  /** Pause the slideshow progress */\n  pauseProgress: () => void;\n  /** Resume the slideshow progress */\n  resumeProgress: () => void;\n}\n\n/**\n * Custom hook to manage overall slideshow progress state\n * Optimized for performance with better timeout management\n */\nexport const useSlideshowProgress = ({\n  slideShowRunning,\n  activeTimelineItem,\n}: UseSlideshowProgressProps): SlideshowProgressState => {\n  const [isPaused, setIsPaused] = useState(false);\n  const lastActiveItem = useRef(activeTimelineItem);\n\n  // Clean up when slideshow stops\n  useEffect(() => {\n    if (!slideShowRunning) {\n      setIsPaused(false);\n    }\n  }, [slideShowRunning]);\n\n  // Reset pause state when active item changes (optimized)\n  useEffect(() => {\n    if (slideShowRunning && lastActiveItem.current !== activeTimelineItem) {\n      lastActiveItem.current = activeTimelineItem;\n      if (isPaused) setIsPaused(false);\n    }\n  }, [activeTimelineItem, slideShowRunning, isPaused]);\n\n  // Pause the progress\n  const pauseProgress = useCallback(() => {\n    if (slideShowRunning && !isPaused) {\n      setIsPaused(true);\n    }\n  }, [slideShowRunning, isPaused]);\n\n  // Resume the progress\n  const resumeProgress = useCallback(() => {\n    if (slideShowRunning && isPaused) {\n      setIsPaused(false);\n    }\n  }, [slideShowRunning, isPaused]);\n\n  return {\n    isPaused,\n    pauseProgress,\n    resumeProgress,\n  };\n};\n","function toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\n\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : String(i);\n}\n\nfunction _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\n\nfunction mapValues(input, fn) {\n  var result = {};\n  for (var _key in input) {\n    result[_key] = fn(input[_key], _key);\n  }\n  return result;\n}\n\nvar shouldApplyCompound = (compoundCheck, selections, defaultVariants) => {\n  for (var key of Object.keys(compoundCheck)) {\n    var _selections$key;\n    if (compoundCheck[key] !== ((_selections$key = selections[key]) !== null && _selections$key !== void 0 ? _selections$key : defaultVariants[key])) {\n      return false;\n    }\n  }\n  return true;\n};\nvar createRuntimeFn = config => {\n  var runtimeFn = options => {\n    var className = config.defaultClassName;\n    var selections = _objectSpread2(_objectSpread2({}, config.defaultVariants), options);\n    for (var variantName in selections) {\n      var _selections$variantNa;\n      var variantSelection = (_selections$variantNa = selections[variantName]) !== null && _selections$variantNa !== void 0 ? _selections$variantNa : config.defaultVariants[variantName];\n      if (variantSelection != null) {\n        var selection = variantSelection;\n        if (typeof selection === 'boolean') {\n          // @ts-expect-error\n          selection = selection === true ? 'true' : 'false';\n        }\n        var selectionClassName =\n        // @ts-expect-error\n        config.variantClassNames[variantName][selection];\n        if (selectionClassName) {\n          className += ' ' + selectionClassName;\n        }\n      }\n    }\n    for (var [compoundCheck, compoundClassName] of config.compoundVariants) {\n      if (shouldApplyCompound(compoundCheck, selections, config.defaultVariants)) {\n        className += ' ' + compoundClassName;\n      }\n    }\n    return className;\n  };\n  runtimeFn.variants = () => Object.keys(config.variantClassNames);\n  runtimeFn.classNames = {\n    get base() {\n      return config.defaultClassName.split(' ')[0];\n    },\n    get variants() {\n      return mapValues(config.variantClassNames, classNames => mapValues(classNames, className => className.split(' ')[0]));\n    }\n  };\n  return runtimeFn;\n};\n\nexport { createRuntimeFn as c, mapValues as m };\n","function getVarName(variable) {\n  var matches = variable.match(/^var\\((.*)\\)$/);\n  if (matches) {\n    return matches[1];\n  }\n  return variable;\n}\n\nfunction get(obj, path) {\n  var result = obj;\n  for (var key of path) {\n    if (!(key in result)) {\n      throw new Error(\"Path \".concat(path.join(' -> '), \" does not exist in object\"));\n    }\n    result = result[key];\n  }\n  return result;\n}\n\nfunction walkObject(obj, fn) {\n  var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var clone = {};\n  for (var key in obj) {\n    var _value = obj[key];\n    var currentPath = [...path, key];\n    if (typeof _value === 'string' || typeof _value === 'number' || _value == null) {\n      clone[key] = fn(_value, currentPath);\n    } else if (typeof _value === 'object' && !Array.isArray(_value)) {\n      clone[key] = walkObject(_value, fn, currentPath);\n    } else {\n      console.warn(\"Skipping invalid key \\\"\".concat(currentPath.join('.'), \"\\\". Should be a string, number, null or object. Received: \\\"\").concat(Array.isArray(_value) ? 'Array' : typeof _value, \"\\\"\"));\n    }\n  }\n  return clone;\n}\n\nexport { get, getVarName, walkObject };\n","import { walkObject, get, getVarName } from '@vanilla-extract/private';\n\nfunction assignInlineVars(varsOrContract, tokens) {\n  var styles = {};\n  if (typeof tokens === 'object') {\n    var _contract = varsOrContract;\n    walkObject(tokens, (value, path) => {\n      if (value == null) {\n        return;\n      }\n      var varName = get(_contract, path);\n      styles[getVarName(varName)] = String(value);\n    });\n  } else {\n    var _vars = varsOrContract;\n    for (var varName in _vars) {\n      var value = _vars[varName];\n      if (value == null) {\n        continue;\n      }\n      styles[getVarName(varName)] = value;\n    }\n  }\n  Object.defineProperty(styles, 'toString', {\n    value: function value() {\n      return Object.keys(this).map(key => \"\".concat(key, \":\").concat(this[key])).join(';');\n    },\n    writable: false\n  });\n  return styles;\n}\n\nfunction setVar(element, variable, value) {\n  element.style.setProperty(getVarName(variable), value);\n}\nfunction setElementVars(element, varsOrContract, tokens) {\n  if (typeof tokens === 'object') {\n    var _contract = varsOrContract;\n    walkObject(tokens, (value, path) => {\n      if (value == null) {\n        return;\n      }\n      setVar(element, get(_contract, path), String(value));\n    });\n  } else {\n    var _vars = varsOrContract;\n    for (var varName in _vars) {\n      var value = _vars[varName];\n      if (value == null) {\n        continue;\n      }\n      setVar(element, varName, _vars[varName]);\n    }\n  }\n}\n\nexport { assignInlineVars, setElementVars };\n","import type { CSSProperties } from 'react';\nimport type { Theme } from '../models/Theme';\nimport { vars } from './tokens.css';\nimport { tokens } from './tokens/index.css';\nimport { assignInlineVars } from '@vanilla-extract/dynamic';\n\n/**\n * Checks if a custom theme object has any user-defined properties\n */\nexport function hasCustomTheme(theme?: Theme): boolean {\n  return theme !== undefined && Object.keys(theme).length > 0;\n}\n\n/**\n * Computes CSS variables from a theme object.\n * Returns empty object for default themes to avoid CSS var duplication.\n * Only returns vars when custom theme properties are provided.\n */\nexport function computeCssVarsFromTheme(\n  theme: Theme | undefined,\n  isDarkMode?: boolean,\n): CSSProperties {\n  // If no custom theme provided, return empty - let vanilla-extract theme classes handle it\n  if (!hasCustomTheme(theme)) {\n    return {};\n  }\n\n  const t = theme ?? {};\n\n  // Determine if we're in dark mode based on explicit flag or theme properties\n  const darkMode =\n    isDarkMode ??\n    (t.timelineBgColor === '#000000' ||\n      t.cardBgColor === '#1f2937' ||\n      t.textColor === '#ffffff' ||\n      t.textColor === '#f9fafb');\n\n  // Default colors based on theme mode\n  const defaultBackground = darkMode ? '#1f2937' : '#ffffff';\n  const defaultText = darkMode ? '#f9fafb' : '#111827';\n  const defaultCardBg = darkMode ? '#374151' : '#ffffff';\n  const defaultMuted = darkMode ? '#9ca3af' : '#6b7280';\n  const defaultToolbarBg = darkMode ? '#1f2937' : '#f1f5f9';\n  const defaultToolbarBtnBg = darkMode ? '#374151' : '#ffffff';\n  const defaultToolbarText = darkMode ? '#f9fafb' : '#1e293b';\n  const defaultButtonBorder = darkMode ? '#4b5563' : '#e2e8f0';\n  const defaultButtonHoverBg = darkMode ? '#4b5563' : '#e2e8f0';\n  const defaultShadow = darkMode ? 'rgba(0,0,0,0.3)' : 'rgba(0,0,0,0.1)';\n\n  return {\n    // New comprehensive token system mapping\n    ...assignInlineVars({\n      // Semantic color tokens\n      [tokens.semantic.color.text.primary]: t.textColor ?? defaultText,\n      [tokens.semantic.color.text.secondary]:\n        t.cardSubtitleColor ?? (darkMode ? '#d1d5db' : '#374151'),\n      [tokens.semantic.color.text.muted]:\n        t.detailsColor ?? (darkMode ? '#9ca3af' : '#6b7280'),\n      [tokens.semantic.color.text.inverse]: darkMode\n        ? defaultBackground\n        : defaultText,\n\n      // Background colors\n      [tokens.semantic.color.background.primary]:\n        t.timelineBgColor ?? t.cardBgColor ?? defaultBackground,\n      [tokens.semantic.color.background.secondary]:\n        t.cardDetailsBackGround ?? (darkMode ? '#1f2937' : '#f8fafc'),\n      [tokens.semantic.color.background.elevated]:\n        t.cardBgColor ?? defaultCardBg,\n      [tokens.semantic.color.background.overlay]: darkMode\n        ? '#00000080'\n        : '#ffffff80',\n\n      // Interactive colors\n      [tokens.semantic.color.interactive.primary]: t.primary ?? '#3b82f6',\n      [tokens.semantic.color.interactive.primaryHover]:\n        t.buttonHoverBorderColor ?? t.primary ?? '#2563eb',\n      [tokens.semantic.color.interactive.primaryActive]:\n        t.titleColorActive ?? (darkMode ? '#60a5fa' : '#1d4ed8'),\n      [tokens.semantic.color.interactive.secondary]:\n        t.secondary ?? (darkMode ? '#94a3b8' : '#64748b'),\n      [tokens.semantic.color.interactive.secondaryHover]:\n        t.buttonHoverBgColor ?? defaultButtonHoverBg,\n      [tokens.semantic.color.interactive.muted]: defaultMuted,\n      [tokens.semantic.color.interactive.mutedHover]: defaultButtonHoverBg,\n\n      // Border colors\n      [tokens.semantic.color.border.default]:\n        t.buttonBorderColor ?? defaultButtonBorder,\n      [tokens.semantic.color.border.muted]: darkMode ? '#4b5563' : '#e5e7eb',\n      [tokens.semantic.color.border.emphasis]:\n        t.buttonActiveBorderColor ?? t.primary ?? '#3b82f6',\n      [tokens.semantic.color.border.interactive]:\n        t.buttonHoverBorderColor ?? t.primary ?? '#3b82f6',\n\n      // Status colors\n      [tokens.semantic.color.status.success]: '#22c55e',\n      [tokens.semantic.color.status.warning]: '#eab308',\n      [tokens.semantic.color.status.error]: '#ef4444',\n      [tokens.semantic.color.status.info]: t.primary ?? '#3b82f6',\n\n      // Icon colors\n      [tokens.semantic.color.icon.default]:\n        t.iconColor ?? t.primary ?? '#3b82f6',\n      [tokens.semantic.color.icon.muted]: darkMode ? '#9ca3af' : '#6b7280',\n      [tokens.semantic.color.icon.emphasis]: t.primary ?? '#3b82f6',\n\n      // Component-specific tokens\n      [tokens.component.timeline.line.color]: t.primary ?? '#3b82f6',\n      [tokens.component.timeline.line.width]: '2px',\n      [tokens.component.timeline.point.color.active]: t.primary ?? '#3b82f6',\n      [tokens.component.timeline.point.color.inactive]: defaultMuted,\n      [tokens.component.timeline.point.color.hover]:\n        t.buttonHoverBorderColor ?? t.primary ?? '#2563eb',\n      [tokens.component.timeline.point.size.sm]: '8px',\n      [tokens.component.timeline.point.size.md]: '12px',\n      [tokens.component.timeline.point.size.lg]: '16px',\n      [tokens.component.timeline.card.width.vertical]: '85%',\n      [tokens.component.timeline.card.width.horizontal]: '280px',\n      [tokens.component.timeline.card.width.min]: '280px',\n      [tokens.component.timeline.card.width.max]: '400px',\n      [tokens.component.timeline.card.spacing.vertical]: '1rem',\n      [tokens.component.timeline.card.spacing.horizontal]: '2rem',\n\n      // Spacing tokens\n      [tokens.semantic.spacing.xs]: '4px',\n      [tokens.semantic.spacing.sm]: '8px',\n      [tokens.semantic.spacing.md]: '16px',\n      [tokens.semantic.spacing.lg]: '24px',\n      [tokens.semantic.spacing.xl]: '32px',\n      [tokens.semantic.spacing['2xl']]: '48px',\n      [tokens.semantic.spacing['3xl']]: '64px',\n\n      // Typography tokens\n      [tokens.semantic.typography.fontSize.caption]: '12px',\n      [tokens.semantic.typography.fontSize.body]: '16px',\n      [tokens.semantic.typography.fontSize.heading3]: '18px',\n      [tokens.semantic.typography.fontSize.heading2]: '20px',\n      [tokens.semantic.typography.fontSize.heading1]: '24px',\n      [tokens.semantic.typography.lineHeight.tight]: '1.2',\n      [tokens.semantic.typography.lineHeight.normal]: '1.5',\n      [tokens.semantic.typography.lineHeight.relaxed]: '1.8',\n      [tokens.semantic.typography.fontWeight.normal]: '400',\n      [tokens.semantic.typography.fontWeight.medium]: '500',\n      [tokens.semantic.typography.fontWeight.semibold]: '600',\n      [tokens.semantic.typography.fontWeight.bold]: '700',\n\n      // Border radius tokens\n      [tokens.semantic.borderRadius.sm]: '4px',\n      [tokens.semantic.borderRadius.md]: '8px',\n      [tokens.semantic.borderRadius.lg]: '12px',\n      [tokens.semantic.borderRadius.xl]: '16px',\n      [tokens.semantic.borderRadius.full]: '9999px',\n\n      // Shadow tokens\n      [tokens.semantic.shadow.card]: darkMode\n        ? '0 2px 4px rgba(0, 0, 0, 0.3)'\n        : '0 2px 4px rgba(0, 0, 0, 0.1)',\n      [tokens.semantic.shadow.cardHover]: darkMode\n        ? '0 4px 8px rgba(0, 0, 0, 0.4)'\n        : '0 4px 8px rgba(0, 0, 0, 0.15)',\n      [tokens.semantic.shadow.cardActive]: darkMode\n        ? '0 1px 2px rgba(0, 0, 0, 0.5)'\n        : '0 1px 2px rgba(0, 0, 0, 0.2)',\n      [tokens.semantic.shadow.toolbar]: t.shadowColor ?? defaultShadow,\n      [tokens.semantic.shadow.modal]: darkMode\n        ? '0 8px 16px rgba(0, 0, 0, 0.6)'\n        : '0 8px 16px rgba(0, 0, 0, 0.12)',\n\n      // Motion tokens\n      [tokens.semantic.motion.duration.fast]: '150ms',\n      [tokens.semantic.motion.duration.normal]: '300ms',\n      [tokens.semantic.motion.duration.slow]: '500ms',\n      [tokens.semantic.motion.easing.standard]: 'cubic-bezier(0.4, 0, 0.2, 1)',\n      [tokens.semantic.motion.easing.emphasized]: 'cubic-bezier(0.2, 0, 0, 1)',\n\n      // Z-index tokens\n      [tokens.semantic.zIndex.timelineCard]: '10',\n      [tokens.semantic.zIndex.controls]: '1000',\n      [tokens.semantic.zIndex.popover]: '1100',\n      [tokens.semantic.zIndex.outline]: '50',\n\n      // Toolbar tokens\n      [tokens.component.toolbar.height]: '56px',\n      [tokens.component.toolbar.padding]: '16px',\n      [tokens.component.toolbar.background]:\n        t.toolbarBgColor ?? defaultToolbarBg,\n      [tokens.component.toolbar.button.size]: '32px',\n      [tokens.component.toolbar.button.spacing]: '4px',\n\n      // Maintain backward compatibility with old vars system\n      [vars.color.background]:\n        t.timelineBgColor ?? t.cardBgColor ?? defaultBackground,\n      [vars.color.text]: t.textColor ?? defaultText,\n      [vars.color.primary]: t.primary ?? '#3b82f6',\n      [vars.color.secondary]: t.secondary ?? (darkMode ? '#94a3b8' : '#64748b'),\n      [vars.color.muted]: defaultMuted,\n      [vars.color.cardBg]: t.cardBgColor ?? defaultCardBg,\n      [vars.color.cardTitle]: t.cardTitleColor ?? t.titleColor ?? defaultText,\n      [vars.color.cardSubtitle]:\n        t.cardSubtitleColor ?? (darkMode ? '#d1d5db' : '#374151'),\n      [vars.color.cardDetails]:\n        t.cardDetailsColor ?? (darkMode ? '#9ca3af' : '#4b5563'),\n      [vars.color.toolbarBg]: t.toolbarBgColor ?? defaultToolbarBg,\n      [vars.color.toolbarBtnBg]: t.toolbarBtnBgColor ?? defaultToolbarBtnBg,\n      [vars.color.toolbarText]: t.toolbarTextColor ?? defaultToolbarText,\n      [vars.color.icon]: t.iconColor ?? t.primary ?? '#3b82f6',\n      [vars.color.buttonBorder]: t.buttonBorderColor ?? defaultButtonBorder,\n      [vars.color.buttonHoverBorder]:\n        t.buttonHoverBorderColor ?? t.primary ?? '#3b82f6',\n      [vars.color.buttonHoverBg]: t.buttonHoverBgColor ?? defaultButtonHoverBg,\n      [vars.color.buttonActiveBg]:\n        t.buttonActiveBgColor ?? t.primary ?? '#3b82f6',\n      [vars.color.shadow]: t.shadowColor ?? defaultShadow,\n    }),\n    // Additional CSS custom properties for compatibility\n    ...({\n      '--timeline-bg-color':\n        t.timelineBgColor ?? t.cardBgColor ?? defaultBackground,\n      '--timeline-text-color': t.textColor ?? defaultText,\n      '--timeline-primary-color': t.primary ?? '#3b82f6',\n      '--timeline-secondary-color':\n        t.secondary ?? (darkMode ? '#94a3b8' : '#64748b'),\n      '--timeline-card-bg-color': t.cardBgColor ?? defaultCardBg,\n      '--timeline-muted-color': defaultMuted,\n      '--timeline-toolbar-bg-color': t.toolbarBgColor ?? defaultToolbarBg,\n      '--timeline-shadow-color': t.shadowColor ?? defaultShadow,\n\n      // Nested card custom properties\n      '--nested-card-bg-color':\n        t.nestedCardBgColor ?? (darkMode ? '#1f2937' : '#f8fafc'),\n      '--nested-card-title-color':\n        t.nestedCardTitleColor ?? (darkMode ? '#93c5fd' : '#1e40af'),\n      '--nested-card-subtitle-color':\n        t.nestedCardSubtitleColor ?? (darkMode ? '#cbd5e1' : '#475569'),\n      '--nested-card-details-color':\n        t.nestedCardDetailsColor ?? (darkMode ? '#9ca3af' : '#64748b'),\n\n      // Icon custom properties\n      '--icon-bg-color':\n        t.iconBackgroundColor ?? (darkMode ? '#374151' : '#e2e8f0'),\n      '--icon-color': t.iconColor ?? t.primary ?? '#3b82f6',\n\n      // Active state custom properties\n      '--title-active-color':\n        t.titleColorActive ?? (darkMode ? '#60a5fa' : '#1d4ed8'),\n      '--details-color': t.detailsColor ?? (darkMode ? '#cbd5e1' : '#475569'),\n\n      // Dark mode specific custom properties\n      '--search-highlight-color':\n        t.searchHighlightColor ?? (darkMode ? '#451a03' : '#fef3c7'),\n      '--glow-color': t.glowColor ?? 'rgba(37, 99, 235, 0.2)',\n    } as any),\n  };\n}\n","import { useCallback, useRef, useEffect, MutableRefObject } from 'react';\n\n/**\n * Hook that provides a stable callback reference that always calls the latest version\n * @param callback - The callback function\n * @returns A stable callback reference\n */\nexport const useStableCallback = <T extends (...args: any[]) => any>(\n  callback: T,\n): T => {\n  const ref = useRef(callback);\n\n  useEffect(() => {\n    ref.current = callback;\n  }, [callback]);\n\n  return useCallback((...args: Parameters<T>) => ref.current(...args), []) as T;\n};\n\n/**\n * Hook that provides a stable ref that updates without causing re-renders\n * @param value - The value to store in the ref\n * @returns A ref containing the latest value\n */\nexport const useLatestRef = <T>(value: T): MutableRefObject<T> => {\n  const ref = useRef(value);\n\n  useEffect(() => {\n    ref.current = value;\n  });\n\n  return ref;\n};\n\n/**\n * Hook that runs a cleanup function on unmount\n * @param cleanup - The cleanup function to run\n */\nexport const useUnmount = (cleanup: () => void): void => {\n  const cleanupRef = useRef(cleanup);\n\n  useEffect(() => {\n    cleanupRef.current = cleanup;\n  }, [cleanup]);\n\n  useEffect(() => {\n    return () => {\n      cleanupRef.current();\n    };\n  }, []);\n};\n\n/**\n * Hook that provides RAF-based throttling\n * @param callback - The callback to throttle\n * @returns Throttled callback\n */\nexport const useRAFThrottle = <T extends (...args: any[]) => void>(\n  callback: T,\n): T => {\n  const frameRef = useRef<number | undefined>(undefined);\n  const argsRef = useRef<any[] | undefined>(undefined);\n  const callbackRef = useRef(callback);\n\n  useEffect(() => {\n    callbackRef.current = callback;\n  }, [callback]);\n\n  const throttled = useCallback((...args: Parameters<T>) => {\n    argsRef.current = args;\n\n    if (frameRef.current) return;\n\n    frameRef.current = requestAnimationFrame(() => {\n      if (argsRef.current) {\n        callbackRef.current(...argsRef.current);\n      }\n      frameRef.current = undefined;\n    });\n  }, []) as T;\n\n  useEffect(() => {\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current);\n      }\n    };\n  }, []);\n\n  return throttled;\n};\n\n/**\n * Color format detection utilities\n */\nexport const HEX_COLOR_REGEX = /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;\nexport const RGB_COLOR_REGEX = /^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/;\nexport const RGBA_COLOR_REGEX =\n  /^rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*([\\d.]+)\\s*\\)$/;\nexport const HSL_COLOR_REGEX = /^hsl\\(\\s*(\\d+)\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*\\)$/;\nexport const HSLA_COLOR_REGEX =\n  /^hsla\\(\\s*(\\d+)\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*([\\d.]+)\\s*\\)$/;\n\nexport type ColorFormat = 'hex' | 'rgb' | 'rgba' | 'hsl' | 'hsla' | 'unknown';\n\nexport const detectColorFormat = (color: string): ColorFormat => {\n  if (HEX_COLOR_REGEX.test(color)) return 'hex';\n  if (RGB_COLOR_REGEX.test(color)) return 'rgb';\n  if (RGBA_COLOR_REGEX.test(color)) return 'rgba';\n  if (HSL_COLOR_REGEX.test(color)) return 'hsl';\n  if (HSLA_COLOR_REGEX.test(color)) return 'hsla';\n  return 'unknown';\n};\n\n/**\n * Adjusts RGB color opacity\n */\nexport const adjustRGBOpacity = (color: string, opacity: number): string => {\n  const match = RGB_COLOR_REGEX.exec(color) || RGBA_COLOR_REGEX.exec(color);\n  if (!match) return '';\n\n  const [, r, g, b] = match;\n  return `rgba(${r}, ${g}, ${b}, ${opacity})`;\n};\n\n/**\n * Adjusts HSL color opacity\n */\nexport const adjustHSLOpacity = (color: string, opacity: number): string => {\n  const match = HSL_COLOR_REGEX.exec(color) || HSLA_COLOR_REGEX.exec(color);\n  if (!match) return '';\n\n  const [, h, s, l] = match;\n  return `hsla(${h}, ${s}%, ${l}%, ${opacity})`;\n};\n","import { useMemo } from 'react';\nimport { hexToRGBA } from '../utils';\nimport {\n  detectColorFormat,\n  adjustRGBOpacity,\n  adjustHSLOpacity,\n  HEX_COLOR_REGEX,\n  ColorFormat,\n} from './utils';\n\nconst isValidHexColor = (color: string): boolean => HEX_COLOR_REGEX.test(color);\n\ninterface UseBackgroundOptions {\n  format?: ColorFormat | 'auto';\n}\n\n/**\n * Hook that converts a color to RGBA format with opacity\n * @param color - The color string (hex, rgb, rgba, hsl, hsla)\n * @param opacity - The opacity value (0-1)\n * @param options - Additional options\n * @returns The color in RGBA format with the specified opacity\n */\nexport const useBackground = (\n  color?: string,\n  opacity = 0.8,\n  options: UseBackgroundOptions = {},\n): string => {\n  const { format = 'auto' } = options;\n\n  return useMemo(() => {\n    if (!color) return '';\n\n    // Auto-detect format if needed\n    const colorFormat = format === 'auto' ? detectColorFormat(color) : format;\n\n    switch (colorFormat) {\n      case 'hex':\n        if (!isValidHexColor(color)) {\n          if (process.env.NODE_ENV === 'development') {\n            console.warn(`Invalid hex color: ${color}`);\n          }\n          return '';\n        }\n        return hexToRGBA(color, opacity);\n\n      case 'rgb':\n      case 'rgba':\n        return adjustRGBOpacity(color, opacity);\n\n      case 'hsl':\n      case 'hsla':\n        return adjustHSLOpacity(color, opacity);\n\n      default:\n        if (process.env.NODE_ENV === 'development') {\n          console.warn(`Unsupported color format: ${color}`);\n        }\n        return '';\n    }\n  }, [color, opacity, format]);\n};\n","import { useCallback } from 'react';\n\ntype MeasurableProperty =\n  | 'clientHeight'\n  | 'clientWidth'\n  | 'scrollHeight'\n  | 'scrollWidth'\n  | 'offsetHeight'\n  | 'offsetWidth';\n\ntype MeasurementResult = {\n  value: number;\n  element: HTMLElement;\n};\n\ninterface UseMeasureOptions {\n  property?: MeasurableProperty;\n  delay?: number;\n  onError?: (error: Error) => void;\n}\n\n/**\n * Hook to measure dimensions of a DOM element\n * @param onMeasure - Callback function that receives the measurement\n * @param options - Measurement options\n * @returns Callback ref to attach to the element to measure\n */\nexport const useMeasure = <T extends HTMLElement = HTMLDivElement>(\n  onMeasure?: (result: MeasurementResult) => void,\n  options: UseMeasureOptions = {},\n) => {\n  const { property = 'clientHeight', delay = 0, onError } = options;\n\n  return useCallback(\n    (node: T | null) => {\n      if (!node || !onMeasure) return;\n\n      const measure = () => {\n        try {\n          const value = node[property];\n          onMeasure({ value, element: node });\n        } catch (error) {\n          if (onError) {\n            onError(error instanceof Error ? error : new Error(String(error)));\n          } else if (process.env.NODE_ENV === 'development') {\n            console.error(`Failed to measure ${property}:`, error);\n          }\n        }\n      };\n\n      if (delay > 0) {\n        setTimeout(() => {\n          requestAnimationFrame(measure);\n        }, delay);\n      } else {\n        requestAnimationFrame(measure);\n      }\n    },\n    [onMeasure, property, delay, onError],\n  );\n};\n\n/**\n * Legacy hook for backward compatibility\n * @deprecated Use useMeasure instead\n */\nexport const useMeasureHeight = (onRender?: (height: number) => void) => {\n  return useMeasure<HTMLDivElement>(\n    onRender ? (result) => onRender(result.value) : undefined,\n    { property: 'clientHeight' },\n  );\n};\n","import { useEffect, useCallback, useRef } from 'react';\nimport { useStableCallback } from './utils';\n\ninterface UseKeyHandlerOptions {\n  enabled?: boolean;\n  keys?: string | string[];\n  keyCodes?: number | number[];\n  eventType?: 'keyup' | 'keydown' | 'keypress';\n  preventDefault?: boolean;\n  stopPropagation?: boolean;\n  metaKey?: boolean;\n  ctrlKey?: boolean;\n  altKey?: boolean;\n  shiftKey?: boolean;\n}\n\n/**\n * Hook that triggers callback on specific key press(es)\n * Supports multiple keys and key combinations\n * @param callback - Function to call when key(s) are pressed\n * @param options - Configuration options\n */\nexport function useKeyHandler(\n  callback: (event: KeyboardEvent) => void,\n  options: UseKeyHandlerOptions = {},\n) {\n  const {\n    enabled = true,\n    keys = 'Escape',\n    keyCodes = 27,\n    eventType = 'keyup',\n    preventDefault = true,\n    stopPropagation = false,\n    metaKey = false,\n    ctrlKey = false,\n    altKey = false,\n    shiftKey = false,\n  } = options;\n\n  const stableCallback = useStableCallback(callback);\n  const lastEnabled = useRef(enabled);\n\n  // Normalize keys and keyCodes to arrays\n  const keyArray = Array.isArray(keys) ? keys : [keys];\n  const keyCodeArray = Array.isArray(keyCodes) ? keyCodes : [keyCodes];\n\n  const handleKey = useCallback(\n    (e: KeyboardEvent) => {\n      // Early return for better performance\n      if (!lastEnabled.current) return;\n\n      // Check modifier keys\n      if (metaKey && !e.metaKey) return;\n      if (ctrlKey && !e.ctrlKey) return;\n      if (altKey && !e.altKey) return;\n      if (shiftKey && !e.shiftKey) return;\n\n      // Check if the pressed key matches any of the target keys\n      const keyMatch = keyArray.includes(e.key);\n      const keyCodeMatch =\n        e.key === undefined && keyCodeArray.includes(e.keyCode);\n\n      if (keyMatch || keyCodeMatch) {\n        if (preventDefault) e.preventDefault();\n        if (stopPropagation) e.stopPropagation();\n        stableCallback(e);\n      }\n    },\n    [\n      keyArray,\n      keyCodeArray,\n      preventDefault,\n      stopPropagation,\n      metaKey,\n      ctrlKey,\n      altKey,\n      shiftKey,\n      stableCallback,\n    ],\n  );\n\n  useEffect(() => {\n    lastEnabled.current = enabled;\n\n    if (!enabled) return;\n\n    // Use passive listeners where possible for better scroll performance\n    const listenerOptions =\n      preventDefault || stopPropagation\n        ? { passive: false }\n        : { passive: true };\n\n    document.addEventListener(eventType, handleKey, listenerOptions);\n\n    return () => {\n      document.removeEventListener(eventType, handleKey);\n    };\n  }, [eventType, handleKey, enabled, preventDefault, stopPropagation]);\n}\n\n/**\n * Legacy hook for backward compatibility\n * @deprecated Use useKeyHandler instead\n */\nexport default function useEscapeKey(\n  callback: () => void,\n  options: UseKeyHandlerOptions = {},\n) {\n  useKeyHandler(() => callback(), options);\n}\n","import { RefObject, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { useStableCallback } from './utils';\n\ninterface UseOutsideClickOptions {\n  eventType?: 'click' | 'mousedown' | 'touchstart';\n  enabled?: boolean;\n  preventDefault?: boolean;\n  stopPropagation?: boolean;\n  excludeRefs?: RefObject<HTMLElement | null>[];\n}\n\n/**\n * Hook that triggers callback when clicking outside referenced element(s)\n * @param el - The element ref(s) to check clicks outside of\n * @param callback - Function to call when clicking outside\n * @param options - Configuration options\n */\nexport default function useOutsideClick(\n  el: RefObject<HTMLElement | null> | RefObject<HTMLElement | null>[],\n  callback: () => void,\n  options: UseOutsideClickOptions = {},\n) {\n  const {\n    eventType = 'click',\n    enabled = true,\n    preventDefault = false,\n    stopPropagation = false,\n    excludeRefs = [],\n  } = options;\n\n  const stableCallback = useStableCallback(callback);\n  const lastEnabled = useRef(enabled);\n\n  // Normalize refs to array\n  const refs = Array.isArray(el) ? el : [el];\n  const allRefs = useMemo(() => [...refs, ...excludeRefs], [refs, excludeRefs]);\n\n  const handleClick = useCallback(\n    (e: MouseEvent | TouchEvent) => {\n      // Early return for better performance\n      if (!lastEnabled.current) return;\n\n      const target = e.target as Node;\n\n      // Check if click is inside any of the refs\n      const isInsideAnyRef = allRefs.some((ref) => {\n        const element = ref.current;\n        return element && element.contains(target);\n      });\n\n      if (!isInsideAnyRef) {\n        if (preventDefault) e.preventDefault();\n        if (stopPropagation) e.stopPropagation();\n        stableCallback();\n      }\n    },\n    [allRefs, preventDefault, stopPropagation, stableCallback],\n  );\n\n  useEffect(() => {\n    lastEnabled.current = enabled;\n\n    if (!enabled) return;\n\n    // Use passive listeners where possible for better scroll performance\n    const listenerOptions =\n      preventDefault || stopPropagation || eventType === 'touchstart'\n        ? { passive: false }\n        : { passive: true };\n\n    document.addEventListener(eventType, handleClick, listenerOptions);\n\n    return () => {\n      document.removeEventListener(eventType, handleClick);\n    };\n  }, [eventType, handleClick, enabled, preventDefault, stopPropagation]);\n}\n","import { useCallback } from 'react';\n\ninterface UseTimelineKeyboardNavigationProps {\n  mode: string;\n  hasFocus: boolean;\n  flipLayout?: boolean;\n  onNext: () => void;\n  onPrevious: () => void;\n  onFirst: () => void;\n  onLast: () => void;\n}\n\n/**\n * Hook for handling timeline keyboard navigation\n */\nexport const useTimelineKeyboardNavigation = ({\n  mode,\n  hasFocus,\n  flipLayout = false,\n  onNext,\n  onPrevious,\n  onFirst,\n  onLast,\n}: UseTimelineKeyboardNavigationProps) => {\n  const handleKeySelection = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      if (!hasFocus) return;\n\n      const { key } = event;\n\n      // Don't handle timeline navigation if event is from popover menu\n      // Popover menus (ARIA menu pattern) handle their own arrow keys\n      const target = event.target as HTMLElement;\n      if (\n        target.closest('[role=\"menu\"]') ||\n        target.closest('[aria-haspopup=\"dialog\"]')\n      ) {\n        return; // Let menu handle its own navigation\n      }\n\n      // Common handlers\n      switch (key) {\n        case 'Home':\n          event.preventDefault();\n          onFirst();\n          return;\n        case 'End':\n          event.preventDefault();\n          onLast();\n          return;\n      }\n\n      // Mode-specific handlers\n      if (mode === 'HORIZONTAL' || mode === 'HORIZONTAL_ALL') {\n        if (key === 'ArrowRight') {\n          event.preventDefault();\n          flipLayout ? onPrevious() : onNext();\n        } else if (key === 'ArrowLeft') {\n          event.preventDefault();\n          flipLayout ? onNext() : onPrevious();\n        }\n      } else if (mode === 'VERTICAL' || mode === 'VERTICAL_ALTERNATING') {\n        if (key === 'ArrowDown') {\n          event.preventDefault();\n          event.stopPropagation();\n          onNext();\n        } else if (key === 'ArrowUp') {\n          event.preventDefault();\n          event.stopPropagation();\n          onPrevious();\n        }\n      }\n    },\n    [mode, flipLayout, hasFocus, onNext, onPrevious, onFirst, onLast],\n  );\n\n  return { handleKeySelection };\n};\n","import React from 'react';\n\n/**\n * Timeline utility functions for managing timeline functionality\n */\n\n/**\n * Safely extracts searchable text from potentially complex React node content\n * Recursively processes React nodes into plain text for search operations\n * @param content - React node (string, array, or component) to extract text from\n * @returns Plain text string suitable for searching\n */\nexport const getSearchableText = (content: React.ReactNode): string => {\n  if (content === null || content === undefined) {\n    return '';\n  }\n  if (typeof content === 'string') {\n    return content;\n  }\n  if (Array.isArray(content)) {\n    return content\n      .map((item) => getSearchableText(item))\n      .filter(Boolean)\n      .join(' ');\n  }\n  // Handle React elements with children or other complex node types\n  if (React.isValidElement(content)) {\n    const elementProps = content.props as { children?: React.ReactNode };\n    if (elementProps.children) {\n      return getSearchableText(elementProps.children);\n    }\n  }\n  return '';\n};\n\n/**\n * Safely validates if a URL belongs to a trusted video platform\n * @param url - URL to validate\n * @returns Object with validation result and platform info\n */\nconst validateVideoUrl = (\n  url: string,\n): { isValid: boolean; platform?: string; origin?: string } => {\n  try {\n    const parsedUrl = new URL(url);\n    const hostname = parsedUrl.hostname.toLowerCase();\n\n    // YouTube domains\n    if (\n      hostname === 'www.youtube.com' ||\n      hostname === 'youtube.com' ||\n      hostname === 'youtu.be'\n    ) {\n      return {\n        isValid: true,\n        platform: 'youtube',\n        origin: 'https://www.youtube.com',\n      };\n    }\n\n    // Vimeo domains\n    if (hostname === 'vimeo.com' || hostname === 'player.vimeo.com') {\n      return { isValid: true, platform: 'vimeo', origin: 'https://vimeo.com' };\n    }\n\n    // For other HTTPS origins, return the actual origin\n    if (parsedUrl.protocol === 'https:') {\n      return { isValid: true, platform: 'other', origin: parsedUrl.origin };\n    }\n\n    return { isValid: false };\n  } catch {\n    return { isValid: false };\n  }\n};\n\n/**\n * Pauses video embeds (primarily YouTube) within an element\n * @param element - HTML element containing video iframes to pause\n */\nexport const pauseVideoEmbeds = (element: HTMLElement | null): void => {\n  if (!element) return;\n\n  try {\n    const iframes = element.querySelectorAll('iframe');\n    iframes.forEach((iframe) => {\n      const src = iframe.getAttribute('src') || '';\n      if (!src || !iframe.contentWindow) return;\n\n      const validation = validateVideoUrl(src);\n      if (!validation.isValid) return;\n\n      const targetOrigin = validation.origin || '*';\n\n      try {\n        // Send appropriate pause command based on platform\n        let message = '';\n        if (validation.platform === 'youtube') {\n          message = '{\"event\":\"command\",\"func\":\"stopVideo\",\"args\":\"\"}';\n        } else if (validation.platform === 'vimeo') {\n          message = '{\"method\":\"pause\"}';\n        } else {\n          // Generic pause attempt for other platforms\n          message = '{\"event\":\"command\",\"func\":\"pause\",\"args\":\"\"}';\n        }\n\n        iframe.contentWindow.postMessage(message, targetOrigin);\n      } catch (error) {\n        console.error('Error sending message to iframe:', error);\n      }\n    });\n  } catch (error) {\n    console.error('Error pausing video embeds:', error);\n  }\n};\n\n/**\n * Toggles visibility of media elements (images and videos) within an element\n * @param element - HTML element containing media elements\n * @param isVisible - Whether media elements should be visible\n */\nexport const toggleMediaVisibility = (\n  element: HTMLElement | null,\n  isVisible: boolean,\n): void => {\n  if (!element) return;\n\n  try {\n    const mediaElements = element.querySelectorAll('img,video');\n    mediaElements.forEach((ele) => {\n      if (ele instanceof HTMLElement) {\n        ele.style.visibility = isVisible ? 'visible' : 'hidden';\n      }\n    });\n  } catch (error) {\n    console.error('Error toggling media visibility:', error);\n  }\n};\n\n/**\n * Finds a timeline item element by its ID in either the main timeline or portal\n * @param itemId - ID of the timeline item to find\n * @param timelineMode - Current timeline mode (HORIZONTAL, VERTICAL, etc.)\n * @param portalId - ID of the portal container for horizontal timeline modes\n * @returns HTML element of the timeline item or null if not found\n */\nexport const findTimelineElement = (\n  itemId: string,\n  timelineMode: string,\n  portalId: string,\n): HTMLElement | null => {\n  if (!itemId || !timelineMode) return null;\n\n  try {\n    const elementId = `timeline-${timelineMode.toLowerCase()}-item-${itemId}`;\n    let targetElement = document.getElementById(elementId);\n\n    // Check in portal for horizontal modes\n    if (\n      !targetElement &&\n      portalId &&\n      (timelineMode === 'HORIZONTAL' || timelineMode === 'HORIZONTAL_ALL')\n    ) {\n      const portalContainer = document.getElementById(portalId);\n      if (portalContainer) {\n        targetElement = portalContainer.querySelector(\n          `#timeline-card-${itemId}`,\n        );\n      }\n    }\n\n    return targetElement;\n  } catch (error) {\n    console.error('Error finding timeline element:', error);\n    return null;\n  }\n};\n","import { useCallback, useRef, useState, useEffect } from 'react';\n\n/**\n * Configuration for roving tabindex pattern\n */\nexport interface UseRovingTabIndexOptions {\n  /** Array of items with IDs and optional disabled state */\n  items: { id: string; disabled?: boolean }[];\n  /** Direction of navigation: horizontal (arrow left/right), vertical (arrow up/down), or both */\n  orientation?: 'horizontal' | 'vertical' | 'both';\n  /** Whether to wrap focus from last item to first (and vice versa) */\n  loop?: boolean;\n  /** Initial active item ID */\n  initialActiveId?: string;\n  /** Callback when active item changes */\n  onActiveChange?: (id: string) => void;\n  /** Whether to focus active item on initial load (default: true) */\n  focusOnLoad?: boolean;\n}\n\n/**\n * Return value from useRovingTabIndex\n */\nexport interface UseRovingTabIndexReturn {\n  /** Current active item ID */\n  activeId: string;\n  /** Get props for an item (tabIndex, onKeyDown, onFocus, ref) */\n  getItemProps: (id: string) => {\n    ref: React.RefObject<HTMLElement | null>;\n    tabIndex: 0 | -1;\n    onKeyDown: (e: React.KeyboardEvent<HTMLElement>) => void;\n    onFocus: () => void;\n  };\n  /** Manually set active item */\n  setActiveId: (id: string) => void;\n}\n\n/**\n * useRovingTabIndex - Implements ARIA roving tabindex pattern\n *\n * This hook manages keyboard navigation for composite widgets like toolbars,\n * menu bars, and list boxes. Only one item has tabIndex={0}, and arrow keys\n * move focus between items. Other items have tabIndex={-1}.\n *\n * WCAG References:\n * - 2.1.1 Keyboard (Level A)\n * - 2.4.3 Focus Order (Level A)\n * - ARIA APG Roving Tabindex Pattern\n *\n * @example\n * ```typescript\n * const { getItemProps, activeId } = useRovingTabIndex({\n *   items: [\n *     { id: 'first', disabled: false },\n *     { id: 'prev', disabled: disableLeft },\n *     { id: 'next', disabled: disableRight },\n *     { id: 'last', disabled: false },\n *   ],\n *   orientation: 'horizontal',\n *   loop: false,\n * });\n *\n * return (\n *   <div role=\"toolbar\">\n *     <button {...getItemProps('first')}>First</button>\n *     <button {...getItemProps('prev')}>Previous</button>\n *     <button {...getItemProps('next')}>Next</button>\n *     <button {...getItemProps('last')}>Last</button>\n *   </div>\n * );\n * ```\n */\nexport const useRovingTabIndex = (\n  options: UseRovingTabIndexOptions,\n): UseRovingTabIndexReturn => {\n  const {\n    items,\n    orientation = 'horizontal',\n    loop = false,\n    initialActiveId,\n    onActiveChange,\n    focusOnLoad = true,\n  } = options;\n\n  // Initialize active ID from first non-disabled item or provided initial ID\n  const getInitialActiveId = useCallback(() => {\n    if (initialActiveId && items.some((item) => item.id === initialActiveId)) {\n      return initialActiveId;\n    }\n    const firstNonDisabled = items.find((item) => !item.disabled);\n    return firstNonDisabled?.id ?? items[0]?.id ?? '';\n  }, [initialActiveId, items]);\n\n  const [activeId, setActiveIdState] = useState<string>(getInitialActiveId());\n  const itemRefsMap = useRef<Map<string, React.RefObject<HTMLElement | null>>>(\n    new Map(),\n  );\n  // Track if this is the initial render to prevent auto-focus unless focusOnLoad is true\n  const isInitialRenderRef = useRef(true);\n\n  // Initialize refs for all items\n  useEffect(() => {\n    items.forEach((item) => {\n      if (!itemRefsMap.current.has(item.id)) {\n        itemRefsMap.current.set(item.id, { current: null });\n      }\n    });\n    // Clean up refs for removed items\n    itemRefsMap.current.forEach((_, id) => {\n      if (!items.some((item) => item.id === id)) {\n        itemRefsMap.current.delete(id);\n      }\n    });\n  }, [items]);\n\n  // Ensure activeId is valid\n  useEffect(() => {\n    if (!items.some((item) => item.id === activeId)) {\n      const newActiveId = getInitialActiveId();\n      if (newActiveId) {\n        setActiveIdState(newActiveId);\n      }\n    }\n  }, [items, activeId, getInitialActiveId]);\n\n  /**\n   * Set active item and call callback\n   */\n  const setActiveId = useCallback(\n    (id: string) => {\n      const item = items.find((item) => item.id === id);\n      if (item && !item.disabled) {\n        setActiveIdState(id);\n        onActiveChange?.(id);\n      }\n    },\n    [items, onActiveChange],\n  );\n\n  /**\n   * Find next focusable item based on direction\n   */\n  const findNextItem = useCallback(\n    (\n      currentId: string,\n      direction: 'next' | 'prev' | 'first' | 'last',\n    ): string => {\n      const currentIndex = items.findIndex((item) => item.id === currentId);\n      if (currentIndex === -1) return currentId;\n\n      let nextIndex = currentIndex;\n\n      switch (direction) {\n        case 'next': {\n          nextIndex = currentIndex + 1;\n          if (nextIndex >= items.length) {\n            nextIndex = loop ? 0 : items.length - 1;\n          }\n          break;\n        }\n        case 'prev': {\n          nextIndex = currentIndex - 1;\n          if (nextIndex < 0) {\n            nextIndex = loop ? items.length - 1 : 0;\n          }\n          break;\n        }\n        case 'first': {\n          nextIndex = 0;\n          break;\n        }\n        case 'last': {\n          nextIndex = items.length - 1;\n          break;\n        }\n      }\n\n      // Skip disabled items\n      let attempts = 0;\n      const maxAttempts = items.length;\n      while (\n        attempts < maxAttempts &&\n        items[nextIndex]?.disabled &&\n        nextIndex !== currentIndex\n      ) {\n        if (direction === 'next' || direction === 'first') {\n          nextIndex = (nextIndex + 1) % items.length;\n        } else {\n          nextIndex = (nextIndex - 1 + items.length) % items.length;\n        }\n        attempts++;\n      }\n\n      return items[nextIndex]?.id ?? currentId;\n    },\n    [items, loop],\n  );\n\n  /**\n   * Handle keyboard navigation\n   */\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent<HTMLElement>) => {\n      const isHorizontal =\n        orientation === 'horizontal' || orientation === 'both';\n      const isVertical = orientation === 'vertical' || orientation === 'both';\n\n      let direction: 'next' | 'prev' | 'first' | 'last' | null = null;\n\n      if (isHorizontal) {\n        if (e.key === 'ArrowRight') {\n          direction = 'next';\n          e.preventDefault();\n        } else if (e.key === 'ArrowLeft') {\n          direction = 'prev';\n          e.preventDefault();\n        }\n      }\n\n      if (isVertical) {\n        if (e.key === 'ArrowDown') {\n          direction = 'next';\n          e.preventDefault();\n        } else if (e.key === 'ArrowUp') {\n          direction = 'prev';\n          e.preventDefault();\n        }\n      }\n\n      if (e.key === 'Home') {\n        direction = 'first';\n        e.preventDefault();\n      } else if (e.key === 'End') {\n        direction = 'last';\n        e.preventDefault();\n      }\n\n      if (direction) {\n        const nextId = findNextItem(activeId, direction);\n        setActiveId(nextId);\n\n        // Focus the next item\n        setTimeout(() => {\n          const nextRef = itemRefsMap.current.get(nextId);\n          nextRef?.current?.focus();\n        }, 0);\n      }\n    },\n    [orientation, activeId, findNextItem, setActiveId],\n  );\n\n  /**\n   * Handle focus change via mouse/click\n   */\n  const handleFocus = useCallback(\n    (id: string) => {\n      setActiveId(id);\n    },\n    [setActiveId],\n  );\n\n  /**\n   * Get props for an item\n   */\n  const getItemProps = useCallback(\n    (id: string) => {\n      // Ensure ref exists\n      if (!itemRefsMap.current.has(id)) {\n        itemRefsMap.current.set(id, { current: null });\n      }\n\n      const ref = itemRefsMap.current.get(id)!;\n      const isActive = activeId === id;\n      const item = items.find((item) => item.id === id);\n      const isDisabled = item?.disabled ?? false;\n\n      // Determine tabIndex based on focusOnLoad and initial render state\n      // On initial render with focusOnLoad=false, all items get tabIndex={-1}\n      // After initial render or with focusOnLoad=true, active item gets tabIndex={0}\n      let tabIndex: 0 | -1 = -1;\n      if (isActive && !isDisabled) {\n        if (focusOnLoad || !isInitialRenderRef.current) {\n          tabIndex = 0;\n        }\n      }\n\n      return {\n        ref,\n        tabIndex,\n        onKeyDown: handleKeyDown,\n        onFocus: () => {\n          // Mark that initial render is complete on first interaction\n          if (isInitialRenderRef.current) {\n            isInitialRenderRef.current = false;\n          }\n          handleFocus(id);\n        },\n      };\n    },\n    [activeId, items, handleKeyDown, handleFocus, focusOnLoad],\n  );\n\n  return {\n    activeId,\n    getItemProps,\n    setActiveId,\n  };\n};\n","import { useCallback, useState, useRef, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * Configuration options for ARIA live region\n */\nexport interface UseAriaLiveRegionOptions {\n  /** Politeness level for screen reader announcements */\n  politeness?: 'polite' | 'assertive' | 'off';\n  /** Whether to announce all content as one atomic unit */\n  atomic?: boolean;\n  /** What type of changes to announce */\n  relevant?: 'additions' | 'removals' | 'text' | 'all';\n  /** Custom container element ID (defaults to auto-generated) */\n  containerId?: string;\n}\n\n/**\n * Return value from useAriaLiveRegion\n */\nexport interface UseAriaLiveRegionReturn {\n  /** Function to announce a message to screen readers */\n  announce: (message: string) => void;\n  /** Component to render the live region portal */\n  LiveRegion: React.FC;\n  /** Container element ID for aria-describedby if needed */\n  regionId: string;\n}\n\n/**\n * useAriaLiveRegion - Creates accessible screen reader announcements\n *\n * This hook provides a centralized way to make announcements to screen reader users.\n * It uses a portal-based live region to avoid multiple aria-live elements on the page.\n *\n * WCAG References:\n * - 4.1.3 Status Messages (Level A - at least AA)\n * - WAI-ARIA 1.2 Live Regions\n *\n * @example\n * ```typescript\n * const { announce, LiveRegion, regionId } = useAriaLiveRegion({\n *   politeness: 'polite'\n * });\n *\n * // Announce search results\n * useEffect(() => {\n *   if (totalMatches > 0) {\n *     announce(`Found ${totalMatches} matches`);\n *   }\n * }, [totalMatches, announce]);\n *\n * return (\n *   <>\n *     <SearchInput aria-describedby={regionId} />\n *     <LiveRegion />\n *   </>\n * );\n * ```\n */\nexport const useAriaLiveRegion = (\n  options: UseAriaLiveRegionOptions = {},\n): UseAriaLiveRegionReturn => {\n  const {\n    politeness = 'polite',\n    atomic = true,\n    relevant = 'all',\n    containerId,\n  } = options;\n\n  const [messages, setMessages] = useState<string[]>([]);\n  const regionId =\n    containerId ||\n    `aria-live-region-${Math.random().toString(36).substr(2, 9)}`;\n  const messageTimeoutsRef = useRef<Map<string, NodeJS.Timeout>>(new Map());\n\n  /**\n   * Announce a message to screen readers\n   * Messages are automatically cleared after a delay\n   */\n  const announce = useCallback((message: string) => {\n    if (!message.trim()) return;\n\n    // Generate unique key for this message\n    const messageKey = `${Date.now()}-${Math.random()}`;\n\n    // Add message\n    setMessages((prev) => [...prev, message]);\n\n    // Clear existing timeout if any\n    const existingTimeout = messageTimeoutsRef.current.get(messageKey);\n    if (existingTimeout) {\n      clearTimeout(existingTimeout);\n    }\n\n    // Clear message after 3 seconds (or longer for longer messages)\n    const delay = Math.max(3000, message.length * 50);\n    const timeout = setTimeout(() => {\n      setMessages((prev) => prev.filter((_, i) => i > 0));\n      messageTimeoutsRef.current.delete(messageKey);\n    }, delay);\n\n    messageTimeoutsRef.current.set(messageKey, timeout);\n  }, []);\n\n  // Cleanup timeouts on unmount\n  useEffect(() => {\n    return () => {\n      messageTimeoutsRef.current.forEach((timeout) => {\n        clearTimeout(timeout);\n      });\n    };\n  }, []);\n\n  /**\n   * Component that renders the live region portal\n   */\n  const LiveRegion = useCallback(() => {\n    return ReactDOM.createPortal(\n      <div\n        id={regionId}\n        role=\"status\"\n        aria-live={politeness}\n        aria-atomic={atomic}\n        aria-relevant={relevant}\n        style={{\n          position: 'fixed',\n          left: '-10000px',\n          width: '1px',\n          height: '1px',\n          overflow: 'hidden',\n          clip: 'rect(0, 0, 0, 0)',\n          whiteSpace: 'nowrap',\n        }}\n        data-testid=\"aria-live-region\"\n      >\n        {messages.map((msg, index) => (\n          <div key={`${index}-${msg}`}>{msg}</div>\n        ))}\n      </div>,\n      document.body,\n    );\n  }, [regionId, politeness, atomic, relevant, messages]);\n\n  return {\n    announce,\n    LiveRegion,\n    regionId,\n  };\n};\n","import { useState, useEffect } from 'react';\n\n/**\n * usePrefersReducedMotion - Detects user's motion preference\n *\n * This hook checks the user's `prefers-reduced-motion` media query preference\n * and returns a boolean indicating whether reduced motion is preferred.\n *\n * WCAG References:\n * - 2.3.3 Animation from Interactions (Level AAA)\n * - WCAG22 Understanding: Respect user preferences for reduced motion\n *\n * @returns {boolean} true if user prefers reduced motion, false otherwise\n *\n * @example\n * ```typescript\n * const prefersReducedMotion = usePrefersReducedMotion();\n *\n * return (\n *   <motion.div\n *     animate={{ opacity: 1 }}\n *     transition={{\n *       duration: prefersReducedMotion ? 0 : 0.3,\n *       type: prefersReducedMotion ? 'tween' : 'spring',\n *     }}\n *   >\n *     Content\n *   </motion.div>\n * );\n * ```\n *\n * @example\n * ```typescript\n * // Conditional animations\n * const prefersReducedMotion = usePrefersReducedMotion();\n *\n * return (\n *   <div\n *     style={{\n *       transition: prefersReducedMotion\n *         ? 'none'\n *         : 'transform 0.3s ease-out',\n *     }}\n *   >\n *     Content\n *   </div>\n * );\n * ```\n */\nexport const usePrefersReducedMotion = (): boolean => {\n  // Initialize with current preference\n  const getInitialState = (): boolean => {\n    if (typeof window === 'undefined') return false;\n\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    return mediaQuery.matches;\n  };\n\n  const [prefersReducedMotion, setPrefersReducedMotion] =\n    useState<boolean>(getInitialState);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return undefined;\n\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n\n    // Update state when preference changes\n    const handleChange = (event: MediaQueryListEvent | MediaQueryList) => {\n      setPrefersReducedMotion(event.matches);\n    };\n\n    // Set initial value\n    handleChange(mediaQuery);\n\n    // Listen for changes (modern browsers)\n    if (mediaQuery.addEventListener) {\n      mediaQuery.addEventListener('change', handleChange);\n      return () => {\n        mediaQuery.removeEventListener('change', handleChange);\n      };\n    }\n    // Fallback for older browsers\n    if (mediaQuery.addListener) {\n      mediaQuery.addListener(handleChange);\n      return () => {\n        mediaQuery.removeListener(handleChange);\n      };\n    }\n\n    return undefined;\n  }, []);\n\n  return prefersReducedMotion;\n};\n","import { useCallback, useEffect, useRef } from 'react';\nimport { usePrefersReducedMotion } from './accessibility';\n\ntype ScrollOptions = {\n  behavior: ScrollBehavior;\n  block: ScrollLogicalPosition;\n  inline: ScrollLogicalPosition;\n};\n\n// Default scroll duration that balances smoothness with responsiveness\nconst DEFAULT_SCROLL_DURATION = 300; // Further reduced for more responsive keyboard navigation\n\n/**\n * Smooth scroll with improved easing function for more fluid motion\n */\nconst easeInOutCubic = (t: number): number => {\n  return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;\n};\n\n/**\n * Even smoother easing function for gradual movement\n */\nconst easeInOutQuart = (t: number): number => {\n  return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * Math.pow(-t + 1, 4);\n};\n\n/**\n * Custom smooth scroll implementation for better control and smoother animation\n * Respects user's motion preferences for accessibility (WCAG 2.3.3)\n */\nconst smoothScrollTo = (\n  container: Element,\n  targetPosition: number,\n  duration: number = DEFAULT_SCROLL_DURATION,\n  isHorizontal: boolean = false,\n  prefersReducedMotion: boolean = false,\n  onComplete?: () => void,\n) => {\n  // Instant scroll when user prefers reduced motion\n  if (prefersReducedMotion || duration === 0) {\n    if (isHorizontal) {\n      container.scrollLeft = targetPosition;\n    } else {\n      container.scrollTop = targetPosition;\n    }\n    if (onComplete) {\n      onComplete();\n    }\n    return;\n  }\n\n  const startPosition = isHorizontal\n    ? container.scrollLeft\n    : container.scrollTop;\n  const distance = targetPosition - startPosition;\n  const startTime = performance.now();\n\n  const animateScroll = (currentTime: number) => {\n    const elapsed = currentTime - startTime;\n    const progress = Math.min(elapsed / duration, 1);\n    const easedProgress = easeInOutQuart(progress);\n    const newPosition = startPosition + distance * easedProgress;\n\n    if (isHorizontal) {\n      container.scrollLeft = newPosition;\n    } else {\n      container.scrollTop = newPosition;\n    }\n\n    if (progress < 1) {\n      requestAnimationFrame(animateScroll);\n    } else if (onComplete) {\n      // Call completion callback when animation is done\n      onComplete();\n    }\n  };\n\n  requestAnimationFrame(animateScroll);\n};\n\n/**\n * Hook for handling timeline scrolling with smooth animation\n * Respects user's motion preferences for accessibility (WCAG 2.3.3)\n */\nexport const useTimelineScrolling = () => {\n  const prefersReducedMotion = usePrefersReducedMotion();\n  const scrollTimeoutRef = useRef<number | null>(null);\n  const lastScrollTarget = useRef<HTMLElement | null>(null);\n  // Timeout to clear last target after animation ends\n  const clearLastTargetTimeoutRef = useRef<ReturnType<\n    typeof setTimeout\n  > | null>(null);\n\n  // Cleanup any pending clear-timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (clearLastTargetTimeoutRef.current) {\n        clearTimeout(clearLastTargetTimeoutRef.current);\n        clearLastTargetTimeoutRef.current = null;\n      }\n      if (scrollTimeoutRef.current) {\n        cancelAnimationFrame(scrollTimeoutRef.current);\n        scrollTimeoutRef.current = null;\n      }\n    };\n  }, []);\n\n  const scrollToElement = useCallback(\n    (element: HTMLElement, mode: string, forceScroll?: boolean) => {\n      if (!element) return;\n\n      // Prevent scrolling to the same element repeatedly (unless forced for keyboard navigation)\n      if (lastScrollTarget.current === element && !forceScroll) {\n        return;\n      }\n\n      // Clear any pending scroll or animation\n      if (scrollTimeoutRef.current) {\n        cancelAnimationFrame(scrollTimeoutRef.current);\n      }\n\n      // Schedule the scroll for the next animation frame\n      scrollTimeoutRef.current = requestAnimationFrame(() => {\n        // Start scrolling immediately since we're now doing predictive centering\n        const isVerticalMode =\n          mode === 'VERTICAL' || mode === 'VERTICAL_ALTERNATING';\n\n        // Find the scrollable container - handle test environment gracefully\n        let container: Element | null = null;\n\n        if (typeof element.closest === 'function') {\n          container = element.closest('[data-testid=\"timeline-main-wrapper\"]');\n        }\n\n        if (!container) {\n          container = element.parentElement?.parentElement || null;\n        }\n\n        if (!container) {\n          // Fallback to native scrollIntoView if available\n          if (typeof element.scrollIntoView === 'function') {\n            element.scrollIntoView({\n              behavior: prefersReducedMotion ? 'auto' : 'smooth',\n              block: isVerticalMode ? 'center' : 'nearest',\n              inline: isVerticalMode ? 'center' : 'center',\n            });\n          }\n          return;\n        }\n\n        // Calculate target position to center the element\n        const containerRect = container.getBoundingClientRect();\n        const elementRect = element.getBoundingClientRect();\n\n        if (isVerticalMode) {\n          // Center vertically with improved positioning\n          const targetScrollTop =\n            container.scrollTop +\n            (elementRect.top - containerRect.top) -\n            containerRect.height / 2 +\n            elementRect.height / 2;\n\n          // Use appropriate duration for smooth but responsive scrolling\n          smoothScrollTo(\n            container,\n            targetScrollTop,\n            DEFAULT_SCROLL_DURATION,\n            false,\n            prefersReducedMotion,\n          );\n        } else {\n          // Center horizontally with improved positioning\n          const targetScrollLeft =\n            container.scrollLeft +\n            (elementRect.left - containerRect.left) -\n            containerRect.width / 2 +\n            elementRect.width / 2;\n\n          // Use appropriate duration for smooth but responsive scrolling\n          smoothScrollTo(\n            container,\n            targetScrollLeft,\n            DEFAULT_SCROLL_DURATION,\n            true,\n            prefersReducedMotion,\n          );\n        }\n\n        lastScrollTarget.current = element;\n\n        // Clear the target after scrolling completes\n        if (clearLastTargetTimeoutRef.current) {\n          clearTimeout(clearLastTargetTimeoutRef.current);\n        }\n        clearLastTargetTimeoutRef.current = setTimeout(() => {\n          lastScrollTarget.current = null;\n          clearLastTargetTimeoutRef.current = null;\n        }, DEFAULT_SCROLL_DURATION + 100); // Add small buffer after scroll completes\n\n        scrollTimeoutRef.current = null;\n      });\n    },\n    [prefersReducedMotion],\n  );\n\n  return { scrollToElement };\n};\n","import { useCallback, useRef, useMemo } from 'react';\nimport { findTimelineElement } from '../utils/timelineUtils';\nimport { useTimelineScrolling } from './useTimelineScrolling';\nimport { useStableCallback } from './utils';\n\ninterface UseTimelineItemNavigationProps {\n  items: any[];\n  mode: string;\n  timelineId: string;\n  slideShowRunning?: boolean;\n  isToolbarNavigationRef?: React.MutableRefObject<boolean>;\n  onTimelineUpdated?: (index: number) => void;\n}\n\n/**\n * Hook for handling timeline item navigation\n */\nexport const useTimelineItemNavigation = ({\n  items,\n  mode,\n  timelineId,\n  slideShowRunning = false,\n  isToolbarNavigationRef,\n  onTimelineUpdated,\n}: UseTimelineItemNavigationProps) => {\n  const activeItemIndex = useRef<number>(-1); // -1 indicates no selection initially\n  const { scrollToElement } = useTimelineScrolling();\n  const stableOnTimelineUpdated = useStableCallback(\n    onTimelineUpdated || (() => {}),\n  );\n\n  // Memoize items lookup map for O(1) access\n  const itemsMap = useMemo(() => {\n    const map = new Map<string, number>();\n    items.forEach((item, index) => {\n      if (item?.id) {\n        map.set(item.id, index);\n      }\n    });\n    return map;\n  }, [items]);\n\n  // Find target element in the DOM with focus capability\n  const findTargetElement = useCallback(\n    (itemId: string) => {\n      if (mode === 'VERTICAL' || mode === 'VERTICAL_ALTERNATING') {\n        // For vertical modes, directly search for the vertical-item-row\n        const verticalItemRow = document.querySelector(\n          `[data-testid=\"vertical-item-row\"][data-item-id=\"${itemId}\"]`,\n        ) as HTMLElement;\n        if (verticalItemRow) {\n          // Ensure the element can receive focus\n          if (!verticalItemRow.hasAttribute('tabindex')) {\n            verticalItemRow.setAttribute('tabindex', '-1');\n          }\n          return verticalItemRow;\n        }\n\n        // Fallback: try to find the card content element and then get its parent row\n        const cardContent = document.querySelector(\n          `.timeline-card-content[data-item-id=\"${itemId}\"]`,\n        );\n        if (cardContent) {\n          const row = cardContent.closest(\n            '[data-testid=\"vertical-item-row\"]',\n          ) as HTMLElement;\n          if (row) {\n            if (!row.hasAttribute('tabindex')) {\n              row.setAttribute('tabindex', '-1');\n            }\n            return row;\n          }\n        }\n\n        // Additional fallback: try to find any element with the item ID\n        const anyElement = document.querySelector(`[data-item-id=\"${itemId}\"]`);\n        if (anyElement) {\n          const row = anyElement.closest(\n            '[data-testid=\"vertical-item-row\"]',\n          ) as HTMLElement;\n          if (row) {\n            if (!row.hasAttribute('tabindex')) {\n              row.setAttribute('tabindex', '-1');\n            }\n            return row;\n          }\n        }\n      } else {\n        // For horizontal modes, prefer focusing the card container first\n        const cardElement = document.getElementById(\n          `timeline-card-${itemId}`,\n        ) as any;\n        if (cardElement) {\n          try {\n            if (cardElement.hasAttribute && cardElement.setAttribute) {\n              if (!cardElement.hasAttribute('tabindex')) {\n                cardElement.setAttribute('tabindex', '-1');\n              }\n            }\n          } catch {}\n          return cardElement as unknown as HTMLElement;\n        }\n\n        // Fallback to the timeline point wrapper element\n        const timelinePointElement = document.getElementById(\n          `timeline-${mode.toLowerCase()}-item-${itemId}`,\n        ) as any;\n        if (timelinePointElement) {\n          try {\n            if (\n              !timelinePointElement.hasAttribute ||\n              !timelinePointElement.setAttribute\n            ) {\n              // Not a full HTMLElement (test mock). Return as-is.\n              return timelinePointElement as unknown as HTMLElement;\n            }\n            if (!timelinePointElement.hasAttribute('tabindex')) {\n              timelinePointElement.setAttribute('tabindex', '-1');\n            }\n          } catch {\n            // Ignore attribute errors in test environment\n          }\n          return timelinePointElement as unknown as HTMLElement;\n        }\n\n        // Try to find any element with the item ID\n        const anyElement = document.querySelector(\n          `[data-item-id=\"${itemId}\"]`,\n        ) as any;\n        if (anyElement) {\n          try {\n            if (anyElement.hasAttribute && anyElement.setAttribute) {\n              if (!anyElement.hasAttribute('tabindex')) {\n                anyElement.setAttribute('tabindex', '-1');\n              }\n            }\n          } catch {}\n          return anyElement as unknown as HTMLElement;\n        }\n      }\n\n      // Default behavior: use the utility function\n      const element = findTimelineElement(itemId, mode, timelineId) as any;\n      if (element) {\n        try {\n          if (element.hasAttribute && element.setAttribute) {\n            if (!element.hasAttribute('tabindex')) {\n              element.setAttribute('tabindex', '-1');\n            }\n          }\n        } catch {}\n      }\n      return element as unknown as HTMLElement;\n    },\n    [mode, timelineId],\n  );\n\n  // Update timeline position\n  const updateTimelinePosition = useCallback(\n    (targetIndex: number, isSlideShow?: boolean) => {\n      activeItemIndex.current = targetIndex;\n\n      // Fixed: Don't add +1 here since handleTimelineItemElapsed already calculated the correct next index\n      const updateIndex = targetIndex;\n\n      stableOnTimelineUpdated(updateIndex);\n    },\n    [items.length, stableOnTimelineUpdated],\n  );\n\n  // Sync activeItemIndex with external updates\n  const syncActiveItemIndex = useCallback((newIndex: number) => {\n    activeItemIndex.current = newIndex;\n  }, []);\n\n  // Handle timeline item click\n  const handleTimelineItemClick = useCallback(\n    (itemId?: string, isSlideShow?: boolean) => {\n      if (!itemId) return;\n\n      // Use memoized map for O(1) lookup\n      const targetIndex = itemsMap.get(itemId);\n      if (targetIndex === undefined) return;\n\n      // Update timeline position\n      updateTimelinePosition(targetIndex, isSlideShow);\n\n      // Find target element using improved element finding and start scrolling immediately\n      // Note: Scrolling should happen regardless of slideshow state to ensure proper centering\n      const targetElement = findTargetElement(itemId);\n      if (targetElement) {\n        // Capture whether search is active NOW before RAF callback runs\n        // This prevents timing issues where focus changes before RAF executes\n        const wasSearchActive =\n          document.activeElement?.tagName === 'INPUT' &&\n          (document.activeElement as HTMLInputElement).type === 'search';\n\n        // Start scrolling immediately for predictive centering\n        scrollToElement(targetElement, mode);\n\n        // After initiating scroll, move focus to the target element\n        // Use requestAnimationFrame to avoid fighting with scrollIntoView\n        requestAnimationFrame(() => {\n          try {\n            // CRITICAL: Protect focus from being stolen (WCAG 2.4.3: Focus Order)\n            // Don't focus timeline items when:\n            // 1. Search input is active (wasSearchActive)\n            // 2. Toolbar button is active (isToolbarNavigationRef - includes play, navigation, dark mode, popovers)\n            // 3. Slideshow is running (slideShowRunning)\n            const isToolbarActive = isToolbarNavigationRef?.current ?? false;\n            const shouldPreventFocus =\n              wasSearchActive || isToolbarActive || slideShowRunning;\n\n            if (\n              !shouldPreventFocus &&\n              typeof (targetElement as HTMLElement).focus === 'function'\n            ) {\n              (targetElement as HTMLElement).focus({ preventScroll: true });\n              // Ensure the wrapper maintains keyboard focus capability\n              const wrapper = targetElement.closest(\n                '.timeline-wrapper',\n              ) as HTMLElement;\n              if (wrapper && !wrapper.contains(document.activeElement)) {\n                wrapper.focus();\n              }\n            }\n          } catch {\n            /* no-op */\n          }\n        });\n      }\n    },\n    [\n      itemsMap,\n      updateTimelinePosition,\n      findTargetElement,\n      mode,\n      scrollToElement,\n      slideShowRunning,\n      isToolbarNavigationRef,\n    ],\n  );\n\n  // Handler for item elapsed (used in slideshow) - advances to NEXT item\n  const handleTimelineItemElapsed = useCallback(\n    (itemId?: string) => {\n      if (!itemId) return;\n\n      const currentIndex = itemsMap.get(itemId);\n      if (currentIndex === undefined) return;\n\n      const nextIndex = currentIndex + 1;\n\n      // If there's a next item, advance to it\n      if (nextIndex < items.length) {\n        const nextItemId = Array.from(itemsMap.entries()).find(\n          ([_, index]) => index === nextIndex,\n        )?.[0];\n        if (nextItemId) {\n          handleTimelineItemClick(nextItemId, true);\n        }\n      } else {\n        // If we're at the last item, restart from beginning\n        const firstItemId = Array.from(itemsMap.entries()).find(\n          ([_, index]) => index === 0,\n        )?.[0];\n        if (firstItemId) {\n          handleTimelineItemClick(firstItemId, true);\n        }\n      }\n    },\n    [handleTimelineItemClick, itemsMap, items.length],\n  );\n\n  return {\n    activeItemIndex,\n    handleTimelineItemClick,\n    handleTimelineItemElapsed,\n    findTargetElement,\n    itemsMap,\n    syncActiveItemIndex,\n  };\n};\n","/**\n * Utility functions for handling optional props and conditional spreading\n */\n\n/**\n * Creates an object with only the defined (non-undefined) properties\n * @param props - Object with potentially undefined values\n * @returns Object with only defined values\n */\nexport function filterDefinedProps<T extends Record<string, unknown>>(\n  props: T,\n): Partial<T> {\n  const result: Partial<T> = {};\n\n  for (const [key, value] of Object.entries(props)) {\n    if (value !== undefined) {\n      (result as Record<string, unknown>)[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Creates an object with only the truthy properties\n * @param props - Object with potentially falsy values\n * @returns Object with only truthy values\n */\nexport function filterTruthyProps<T extends Record<string, unknown>>(\n  props: T,\n): Partial<T> {\n  const result: Partial<T> = {};\n\n  for (const [key, value] of Object.entries(props)) {\n    if (value) {\n      (result as Record<string, unknown>)[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Conditionally includes props based on conditions\n * @param conditions - Object mapping prop names to their conditions and values\n * @returns Object with conditionally included props\n */\nexport function conditionalProps<T extends Record<string, unknown>>(\n  conditions: Record<string, { condition: boolean; value: unknown }>,\n): Partial<T> {\n  const result: Partial<T> = {};\n\n  for (const [key, { condition, value }] of Object.entries(conditions)) {\n    if (condition) {\n      (result as Record<string, unknown>)[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * More specific utility for the most common pattern in this codebase:\n * Include prop only if value is defined and not null\n */\nexport function includeIfDefined<T>(\n  key: string,\n  value: T,\n): Record<string, T> | {} {\n  return value !== undefined && value !== null ? { [key]: value } : {};\n}\n\n/**\n * Include prop only if value is truthy\n */\nexport function includeIfTruthy<T>(\n  key: string,\n  value: T,\n): Record<string, T> | {} {\n  return value ? { [key]: value } : {};\n}\n\n/**\n * Batch version for multiple props - most efficient for the timeline use case\n */\nexport interface PropCondition<T = any> {\n  key: string;\n  value: T;\n  condition?: 'defined' | 'truthy' | boolean;\n}\n\nexport function buildProps(conditions: PropCondition[]): Record<string, any> {\n  const result: Record<string, any> = {};\n\n  for (const { key, value, condition = 'defined' } of conditions) {\n    let shouldInclude = false;\n\n    if (typeof condition === 'boolean') {\n      shouldInclude = condition;\n    } else if (condition === 'defined') {\n      shouldInclude = value !== undefined && value !== null;\n    } else if (condition === 'truthy') {\n      shouldInclude = Boolean(value);\n    }\n\n    if (shouldInclude) {\n      result[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Simple object-based approach - most readable and maintainable\n */\nexport function pickDefined<T extends Record<string, any>>(obj: T): Partial<T> {\n  return Object.fromEntries(\n    Object.entries(obj).filter(([_, value]) => value !== undefined),\n  ) as Partial<T>;\n}\n\nexport function pickTruthy<T extends Record<string, any>>(obj: T): Partial<T> {\n  return Object.fromEntries(\n    Object.entries(obj).filter(([_, value]) => Boolean(value)),\n  ) as Partial<T>;\n}\n","import { useCallback } from 'react';\nimport { useTimelineKeyboardNavigation } from './useTimelineKeyboardNavigation';\nimport { useTimelineItemNavigation } from './useTimelineItemNavigation';\nimport { useTimelineScrolling } from './useTimelineScrolling';\nimport { useStableCallback } from './utils';\nimport { pickDefined } from '../utils/propUtils';\n\ninterface UseTimelineNavigationProps {\n  items: any[]; // Use any to avoid type conflicts\n  mode: string;\n  timelineId: string;\n  hasFocus: boolean;\n  flipLayout?: boolean;\n  slideShowRunning?: boolean;\n  isKeyboardNavigation?: boolean;\n  isToolbarNavigationRef?: React.MutableRefObject<boolean>;\n  onTimelineUpdated?: (index: number) => void;\n  onNext?: () => void;\n  onPrevious?: () => void;\n  onFirst?: () => void;\n  onLast?: () => void;\n}\n\nexport const useTimelineNavigation = ({\n  items,\n  mode,\n  timelineId,\n  hasFocus,\n  flipLayout = false,\n  slideShowRunning = false,\n  isKeyboardNavigation = false,\n  isToolbarNavigationRef,\n  onTimelineUpdated,\n  onNext,\n  onPrevious,\n  onFirst,\n  onLast,\n}: UseTimelineNavigationProps) => {\n  // Stable callbacks\n  const stableOnNext = useStableCallback(onNext || (() => {}));\n  const stableOnPrevious = useStableCallback(onPrevious || (() => {}));\n  const stableOnFirst = useStableCallback(onFirst || (() => {}));\n  const stableOnLast = useStableCallback(onLast || (() => {}));\n\n  // Use smaller hooks\n  const {\n    activeItemIndex,\n    handleTimelineItemClick,\n    handleTimelineItemElapsed,\n    findTargetElement,\n    syncActiveItemIndex,\n  } = useTimelineItemNavigation({\n    items,\n    mode,\n    timelineId,\n    slideShowRunning,\n    ...pickDefined({ onTimelineUpdated, isToolbarNavigationRef }),\n  });\n\n  const { scrollToElement } = useTimelineScrolling();\n\n  // Navigation handlers with predictive centering to avoid jumps\n  const handleNext = useCallback(() => {\n    // Remove hasFocus check as it can block navigation\n    const currentIndex = activeItemIndex.current;\n\n    // Handle case where no item is currently selected (-1)\n    const nextIndex =\n      currentIndex === -1 ? 0 : Math.min(currentIndex + 1, items.length - 1);\n\n    // Always attempt navigation if there are items\n    if (items.length > 0) {\n      // If no selection (-1), start from first item (0)\n      // If at last item, stay there (no navigation)\n      if (currentIndex === -1 || currentIndex < items.length - 1) {\n        const targetItem = items[nextIndex];\n\n        if (targetItem?.id) {\n          // Use the same pathway as slideshow: call handleTimelineItemClick\n          // This ensures consistent state updates through the main component\n          handleTimelineItemClick(targetItem.id, false);\n        }\n\n        // Also call the toolbar callback for any additional toolbar-specific logic\n        stableOnNext();\n      }\n    }\n  }, [items, handleTimelineItemClick, stableOnNext]);\n\n  const handlePrevious = useCallback(() => {\n    // Remove hasFocus check as it can block navigation\n    const currentIndex = activeItemIndex.current;\n\n    // Handle case where no item is currently selected (-1)\n    const prevIndex =\n      currentIndex === -1 ? items.length - 1 : Math.max(currentIndex - 1, 0);\n\n    // Always attempt navigation if there are items\n    if (items.length > 0) {\n      // If no selection (-1), start from last item\n      // If at first item, stay there (no navigation)\n      if (currentIndex === -1 || currentIndex > 0) {\n        const targetItem = items[prevIndex];\n\n        if (targetItem?.id) {\n          // Use the same pathway as slideshow: call handleTimelineItemClick\n          // This ensures consistent state updates through the main component\n          handleTimelineItemClick(targetItem.id, false);\n        }\n\n        // Also call the toolbar callback for any additional toolbar-specific logic\n        stableOnPrevious();\n      }\n    }\n  }, [items, handleTimelineItemClick, stableOnPrevious]);\n\n  const handleFirst = useCallback(() => {\n    // Always allow navigation to first item if we're not already there (including -1 no selection)\n    if (items.length > 0 && activeItemIndex.current !== 0) {\n      const targetItem = items[0];\n\n      if (targetItem?.id) {\n        // Use the same pathway as slideshow: call handleTimelineItemClick\n        // This ensures consistent state updates through the main component\n        handleTimelineItemClick(targetItem.id, false);\n      }\n\n      // Also call the toolbar callback for any additional toolbar-specific logic\n      stableOnFirst();\n    }\n  }, [items, handleTimelineItemClick, stableOnFirst]);\n\n  const handleLast = useCallback(() => {\n    // Always allow navigation to last item if we're not already there (including -1 no selection)\n    const lastIndex = items.length - 1;\n    if (items.length > 0 && activeItemIndex.current !== lastIndex) {\n      const targetItem = items[lastIndex];\n\n      if (targetItem?.id) {\n        // Use the same pathway as slideshow: call handleTimelineItemClick\n        // This ensures consistent state updates through the main component\n        handleTimelineItemClick(targetItem.id, false);\n      }\n\n      // Also call the toolbar callback for any additional toolbar-specific logic\n      stableOnLast();\n    }\n  }, [items, handleTimelineItemClick, stableOnLast]);\n\n  // Use keyboard navigation hook\n  const { handleKeySelection } = useTimelineKeyboardNavigation({\n    mode,\n    hasFocus,\n    flipLayout,\n    onNext: handleNext,\n    onPrevious: handlePrevious,\n    onFirst: handleFirst,\n    onLast: handleLast,\n  });\n\n  return {\n    activeItemIndex,\n    handleTimelineItemClick,\n    handleTimelineItemElapsed,\n    handleNext,\n    handlePrevious,\n    handleFirst,\n    handleLast,\n    handleKeySelection,\n    syncActiveItemIndex,\n  };\n};\n","import { useState, useCallback } from 'react';\nimport { TimelineMode } from '@models/TimelineModel';\nimport { useStableCallback } from './utils';\n\nenum ExtendedTimelineModeEnum {\n  VERTICAL = 'VERTICAL',\n  HORIZONTAL = 'HORIZONTAL',\n  VERTICAL_ALTERNATING = 'VERTICAL_ALTERNATING',\n  HORIZONTAL_ALL = 'HORIZONTAL_ALL',\n}\n\ntype ExtendedTimelineMode = keyof typeof ExtendedTimelineModeEnum;\n\ninterface UseTimelineModeProps {\n  initialMode: TimelineMode;\n  showAllCardsHorizontal?: boolean;\n  updateHorizontalAllCards?: (showAll: boolean) => void;\n}\n\ninterface UseTimelineModeReturn {\n  timelineMode: ExtendedTimelineMode;\n  handleTimelineUpdate: (newMode: string) => void;\n}\n\n// Optimized mode mapping with type safety\nconst MODE_MAPPINGS = new Map<string, ExtendedTimelineMode>([\n  ['VERTICAL', ExtendedTimelineModeEnum.VERTICAL],\n  ['HORIZONTAL', ExtendedTimelineModeEnum.HORIZONTAL],\n  ['VERTICAL_ALTERNATING', ExtendedTimelineModeEnum.VERTICAL_ALTERNATING],\n  ['HORIZONTAL_ALL', ExtendedTimelineModeEnum.HORIZONTAL_ALL],\n]);\n\nexport const useTimelineMode = ({\n  initialMode,\n  showAllCardsHorizontal = false,\n  updateHorizontalAllCards,\n}: UseTimelineModeProps): UseTimelineModeReturn => {\n  const [timelineMode, setTimelineMode] = useState<ExtendedTimelineMode>(\n    initialMode === 'HORIZONTAL' && showAllCardsHorizontal\n      ? 'HORIZONTAL_ALL'\n      : (initialMode as ExtendedTimelineMode),\n  );\n\n  const stableUpdateHorizontalAllCards = useStableCallback(\n    updateHorizontalAllCards || (() => {}),\n  );\n\n  const handleTimelineUpdate = useCallback(\n    (newMode: string) => {\n      const mappedMode = MODE_MAPPINGS.get(newMode);\n      if (!mappedMode || mappedMode === timelineMode) return;\n\n      setTimelineMode(mappedMode);\n\n      // Handle horizontal cards update with stable reference\n      const shouldShowAll =\n        mappedMode === ExtendedTimelineModeEnum.HORIZONTAL_ALL;\n      stableUpdateHorizontalAllCards(shouldShowAll);\n    },\n    [timelineMode, stableUpdateHorizontalAllCards],\n  );\n\n  return {\n    timelineMode,\n    handleTimelineUpdate,\n  };\n};\n","import { useRef, useEffect, useCallback } from 'react';\nimport {\n  toggleMediaVisibility,\n  pauseVideoEmbeds,\n} from '../utils/timelineUtils';\n\ninterface UseTimelineMediaProps {\n  mode: string;\n  timelineMainRef: React.RefObject<HTMLDivElement>;\n  itemSelector?: string;\n  observerOptions?: IntersectionObserverInit;\n  onIntersect?: (element: HTMLElement, isIntersecting: boolean) => void;\n}\n\nexport const useTimelineMedia = ({\n  mode,\n  timelineMainRef,\n  itemSelector = '.vertical-item-row',\n  observerOptions,\n  onIntersect,\n}: UseTimelineMediaProps) => {\n  const observer = useRef<IntersectionObserver | null>(null);\n  const observedElements = useRef<Set<Element>>(new Set());\n\n  // Optimized intersection callback with batched operations\n  const handleIntersection = useCallback(\n    (entries: IntersectionObserverEntry[]) => {\n      // Use requestAnimationFrame to batch DOM operations\n      requestAnimationFrame(() => {\n        entries.forEach((entry) => {\n          const element = entry.target as HTMLDivElement;\n\n          if (onIntersect) {\n            // Custom intersection handler\n            onIntersect(element, entry.isIntersecting);\n          } else {\n            // Default behavior\n            if (entry.isIntersecting) {\n              toggleMediaVisibility(element, true);\n            } else {\n              toggleMediaVisibility(element, false);\n              pauseVideoEmbeds(element);\n            }\n          }\n        });\n      });\n    },\n    [onIntersect],\n  );\n\n  // Memoized observer creation\n  const createObserver = useCallback(() => {\n    if (observer.current) {\n      observer.current.disconnect();\n      observedElements.current.clear();\n    }\n\n    const defaultOptions: IntersectionObserverInit = {\n      root: timelineMainRef.current,\n      threshold: 0.1, // Slightly higher threshold for better performance\n      rootMargin: '50px', // Preload content slightly before it becomes visible\n    };\n\n    observer.current = new IntersectionObserver(\n      handleIntersection,\n      observerOptions || defaultOptions,\n    );\n\n    return observer.current;\n  }, [handleIntersection, timelineMainRef]);\n\n  // Setup IntersectionObserver for efficient media handling\n  useEffect(() => {\n    // Skip horizontal mode as before\n    if (mode === 'HORIZONTAL') return;\n\n    const observerInstance = createObserver();\n\n    // Use requestIdleCallback for better performance if available\n    const scheduleObservation = (callback: () => void) => {\n      if ('requestIdleCallback' in window) {\n        (window as any).requestIdleCallback(callback, { timeout: 100 });\n      } else {\n        requestAnimationFrame(callback);\n      }\n    };\n\n    scheduleObservation(() => {\n      const element = timelineMainRef.current;\n      if (!element || !observerInstance) return;\n\n      const childElements = element.querySelectorAll(itemSelector);\n      childElements.forEach((elem) => {\n        if (!observedElements.current.has(elem)) {\n          observerInstance.observe(elem);\n          observedElements.current.add(elem);\n        }\n      });\n    });\n\n    return () => {\n      observerInstance?.disconnect();\n      observedElements.current.clear();\n    };\n  }, [mode, createObserver, timelineMainRef]);\n\n  // Cleanup function for external use\n  const cleanup = useCallback(() => {\n    observer.current?.disconnect();\n    observedElements.current.clear();\n  }, []);\n\n  return {\n    observer,\n    cleanup,\n  };\n};\n","/**\n * Creates a throttled version of a function that limits invocations\n * @param fn - The function to throttle\n * @param limit - The time limit in milliseconds\n * @returns Throttled version of the function\n */\nexport function throttle<T extends (...args: any[]) => any>(\n  fn: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n  let lastArgs: Parameters<T> | null = null;\n\n  return function (this: unknown, ...args: Parameters<T>) {\n    if (!inThrottle) {\n      fn.apply(this, args);\n      inThrottle = true;\n\n      setTimeout(() => {\n        inThrottle = false;\n        if (lastArgs) {\n          fn.apply(this, lastArgs);\n          lastArgs = null;\n          inThrottle = true;\n          setTimeout(() => {\n            inThrottle = false;\n          }, limit);\n        }\n      }, limit);\n    } else {\n      lastArgs = args;\n    }\n  };\n}\n\n/**\n * Creates a debounced version of a function that delays invocation\n * @param fn - The function to debounce\n * @param delay - The delay in milliseconds\n * @returns Debounced version of the function\n */\nexport function debounce<T extends (...args: unknown[]) => unknown>(\n  fn: T,\n  delay: number,\n): (...args: Parameters<T>) => void {\n  let timeoutId: ReturnType<typeof setTimeout> | null = null;\n\n  return function (this: unknown, ...args: Parameters<T>) {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n\n    timeoutId = setTimeout(() => {\n      fn.apply(this, args);\n      timeoutId = null;\n    }, delay);\n  };\n}\n\n/**\n * Creates an RAF-throttled version of a function for smooth animations\n * @param fn - The function to throttle\n * @returns RAF-throttled version of the function\n */\nexport function rafThrottle<T extends (...args: unknown[]) => unknown>(\n  fn: T,\n): (...args: Parameters<T>) => void {\n  let rafId: number | null = null;\n  let lastArgs: Parameters<T> | null = null;\n\n  return function (this: unknown, ...args: Parameters<T>) {\n    lastArgs = args;\n\n    if (rafId === null) {\n      rafId = requestAnimationFrame(() => {\n        if (lastArgs) {\n          fn.apply(this, lastArgs);\n        }\n        rafId = null;\n      });\n    }\n  };\n}\n","import { useCallback, useRef, useMemo } from 'react';\nimport { Scroll } from '@models/TimelineHorizontalModel';\nimport { throttle } from '@utils/throttle';\n\ninterface UseTimelineScrollProps {\n  mode: string;\n  onScrollEnd?: () => void;\n  setNewOffset: (element: HTMLDivElement, scroll: Partial<Scroll>) => void;\n  scrollEndThrottleMs?: number;\n  onNextItem?: () => void;\n  onPreviousItem?: () => void;\n  activeItemIndex?: React.MutableRefObject<number>;\n  totalItems?: number;\n  isKeyboardNavigation?: boolean;\n}\n\nexport const useTimelineScroll = ({\n  mode,\n  onScrollEnd,\n  setNewOffset,\n  scrollEndThrottleMs = 100,\n  onNextItem,\n  onPreviousItem,\n  activeItemIndex,\n  totalItems,\n  isKeyboardNavigation = false,\n}: UseTimelineScrollProps) => {\n  const timelineMainRef = useRef<HTMLDivElement>(null!);\n  const horizontalContentRef = useRef<HTMLDivElement | null>(null);\n  const scrollTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const setNewOffsetRef = useRef(setNewOffset);\n  const onScrollEndRef = useRef(onScrollEnd);\n\n  // Keep refs updated without triggering re-renders\n  setNewOffsetRef.current = setNewOffset;\n  onScrollEndRef.current = onScrollEnd;\n\n  const onNextItemRef = useRef(onNextItem);\n  const onPreviousItemRef = useRef(onPreviousItem);\n  onNextItemRef.current = onNextItem;\n  onPreviousItemRef.current = onPreviousItem;\n\n  // Handle scrolling (optimized with stable reference)\n  const handleScroll = useCallback((scroll: Partial<Scroll>) => {\n    const element = timelineMainRef.current;\n    if (element && setNewOffsetRef.current) {\n      setNewOffsetRef.current(element, scroll);\n    }\n  }, []);\n\n  // Create throttled scroll handler for better performance\n  const throttledScrollHandler = useMemo(\n    () =>\n      throttle((target: HTMLElement) => {\n        const isVertical =\n          mode === 'VERTICAL' || mode === 'VERTICAL_ALTERNATING';\n\n        if (isVertical) {\n          const scrolled = target.scrollTop + target.clientHeight;\n          const threshold = target.scrollHeight - 1;\n          const isAtBottom = scrolled >= threshold;\n          const isAtTop = target.scrollTop <= 1;\n\n          // Handle dynamic loading (existing functionality)\n          if (isAtBottom && onScrollEndRef.current) {\n            onScrollEndRef.current();\n          }\n\n          // Disabled auto-navigation feature to prevent unwanted timeline jumping\n          // Users should navigate explicitly via keyboard/buttons only\n          // Original auto-navigation caused issues with scrolling to bottom/top\n          /* \n          if (onNextItemRef.current && onPreviousItemRef.current && activeItemIndex && totalItems && !isKeyboardNavigation) {\n            // Auto-navigation logic removed to prevent unwanted jumps\n          }\n          */\n        } else {\n          // Horizontal mode - existing functionality\n          const scrolled = target.scrollLeft + target.offsetWidth;\n          if (target.scrollWidth <= scrolled && onScrollEndRef.current) {\n            onScrollEndRef.current();\n          }\n\n          // Disabled horizontal auto-navigation to prevent unwanted timeline jumping\n          // Users should navigate explicitly via keyboard/buttons only\n          /*\n          if (onNextItemRef.current && onPreviousItemRef.current && activeItemIndex && totalItems && !isKeyboardNavigation) {\n            // Horizontal auto-navigation logic removed to prevent unwanted jumps\n          }\n          */\n        }\n      }, 16), // Throttle to 60fps for smooth scrolling\n    [mode, totalItems, isKeyboardNavigation],\n  );\n\n  // Optimized scroll handler that uses throttling\n  const handleMainScroll = useCallback(\n    (ev: React.UIEvent<HTMLDivElement>) => {\n      const target = ev.target as HTMLElement;\n      throttledScrollHandler(target);\n    },\n    [throttledScrollHandler],\n  );\n\n  return {\n    timelineMainRef,\n    horizontalContentRef,\n    handleScroll,\n    handleMainScroll,\n  };\n};\n","import { useCallback, useState, useRef, useMemo } from 'react';\nimport { TimelineCardModel } from '@models/TimelineItemModel';\nimport { getSearchableText } from '../utils/timelineUtils';\n\ninterface UseTimelineSearchProps {\n  items: TimelineCardModel[];\n  onTimelineUpdated?: (index: number) => void;\n  handleTimelineItemClick: (itemId?: string) => void;\n}\n\nexport const useTimelineSearch = ({\n  items,\n  onTimelineUpdated,\n  handleTimelineItemClick,\n}: UseTimelineSearchProps) => {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState<number[]>([]);\n  const [currentMatchIndex, setCurrentMatchIndex] = useState(-1);\n  const searchInputRef = useRef<HTMLInputElement>(null);\n  const activeItemIndex = useRef<number>(0);\n  const isFirstSearchRef = useRef<boolean>(true);\n\n  // Cache callback refs to prevent unnecessary re-renders\n  const onTimelineUpdatedRef = useRef(onTimelineUpdated);\n  const handleTimelineItemClickRef = useRef(handleTimelineItemClick);\n\n  onTimelineUpdatedRef.current = onTimelineUpdated;\n  handleTimelineItemClickRef.current = handleTimelineItemClick;\n\n  // Memoize searchable content with better caching strategy\n  const searchableContent = useMemo(() => {\n    return items.map((item, index) => {\n      const textParts = [\n        getSearchableText(item.title),\n        getSearchableText(item.cardTitle),\n        getSearchableText(item.cardSubtitle),\n        Array.isArray(item.cardDetailedText)\n          ? item.cardDetailedText.map(getSearchableText).join(' ')\n          : getSearchableText(item.cardDetailedText),\n      ];\n\n      return {\n        index,\n        content: textParts.filter(Boolean).join(' ').toLowerCase(),\n        id: item.id,\n      };\n    });\n  }, [items]);\n\n  // Optimized focus helper - only focus when needed, not during typing\n  const focusSearchInput = useCallback((forceRefocus = false) => {\n    // Only refocus if the search input is not currently focused or if forced\n    if (!forceRefocus && document.activeElement === searchInputRef.current) {\n      return;\n    }\n\n    // Use requestAnimationFrame for better performance\n    requestAnimationFrame(() => {\n      if (\n        searchInputRef.current &&\n        (forceRefocus || document.activeElement !== searchInputRef.current)\n      ) {\n        searchInputRef.current.focus();\n        const length = searchInputRef.current.value.length;\n        searchInputRef.current.setSelectionRange(length, length);\n      }\n    });\n  }, []);\n\n  // Enhanced search with better performance\n  // Now synchronous - only triggered explicitly on Enter key\n  const findMatches = useCallback(\n    (query: string) => {\n      const trimmedQuery = query.trim();\n      if (!trimmedQuery) {\n        setSearchResults([]);\n        setCurrentMatchIndex(-1);\n        return;\n      }\n\n      const queryLower = trimmedQuery.toLowerCase();\n      const results: number[] = [];\n      const maxResults = 100; // Limit results for performance\n\n      // Use for-loop with early break for better performance\n      for (let i = 0; i < searchableContent.length; i++) {\n        // No optional chaining needed: i is always a valid index within bounds\n        if (searchableContent[i]?.content.includes(queryLower)) {\n          results.push(i);\n\n          // Early break if we have enough results\n          if (results.length >= maxResults) {\n            break;\n          }\n        }\n      }\n\n      setSearchResults(results);\n\n      if (results.length > 0) {\n        setCurrentMatchIndex(0);\n        const firstResult = results[0]!; // Non-null: we just checked results.length > 0\n        const firstMatchData = searchableContent[firstResult];\n        if (firstMatchData?.id) {\n          activeItemIndex.current = firstResult;\n          isFirstSearchRef.current = false;\n\n          // Update active timeline item visually without clicking it\n          // This scrolls to the item but doesn't steal focus from search input\n          onTimelineUpdatedRef.current?.(firstResult);\n          // Don't call handleTimelineItemClick - it steals focus\n          // Only navigate explicitly when user presses Enter or next/previous buttons\n        }\n      } else {\n        setCurrentMatchIndex(-1);\n      }\n    },\n    [searchableContent],\n  );\n\n  // Handle query input changes (typing) - does NOT trigger search\n  // Search is triggered explicitly via triggerSearch() when user presses Enter\n  const handleSearchChange = useCallback((query: string) => {\n    setSearchQuery(query);\n    // Clear results if query is empty\n    if (!query.trim()) {\n      setSearchResults([]);\n      setCurrentMatchIndex(-1);\n    }\n  }, []);\n\n  // Explicitly trigger search - called when user presses Enter\n  const triggerSearch = useCallback(() => {\n    findMatches(searchQuery);\n  }, [searchQuery, findMatches]);\n\n  const clearSearch = useCallback(\n    (preservePosition = false) => {\n      setSearchQuery('');\n      setSearchResults([]);\n      setCurrentMatchIndex(-1);\n\n      // Reset first search flag when clearing\n      isFirstSearchRef.current = true;\n\n      if (items.length > 0 && !preservePosition) {\n        activeItemIndex.current = 0;\n        onTimelineUpdatedRef.current?.(0);\n        // Note: Don't call handleTimelineItemClick here to avoid focus stealing\n        // Focus management is handled by the timeline component's useEffect\n      }\n\n      // Force refocus after clearing (only when user explicitly clears)\n      if (!preservePosition) {\n        focusSearchInput(true);\n      }\n    },\n    [items, focusSearchInput],\n  );\n\n  // Optimized navigation with bounds checking\n  const navigateMatches = useCallback(\n    (direction: 'next' | 'prev') => {\n      if (searchResults.length === 0) return;\n\n      const nextIndex =\n        direction === 'next'\n          ? (currentMatchIndex + 1) % searchResults.length\n          : (currentMatchIndex - 1 + searchResults.length) %\n            searchResults.length;\n\n      if (nextIndex === currentMatchIndex) return;\n\n      const newTimelineIndex = searchResults[nextIndex];\n      const matchData =\n        newTimelineIndex !== undefined\n          ? searchableContent[newTimelineIndex]\n          : undefined;\n\n      setCurrentMatchIndex(nextIndex);\n      if (newTimelineIndex !== undefined) {\n        activeItemIndex.current = newTimelineIndex;\n        onTimelineUpdatedRef.current?.(newTimelineIndex);\n      }\n\n      if (matchData?.id) {\n        handleTimelineItemClickRef.current?.(matchData.id);\n\n        // Announce search navigation to screen readers (WCAG 4.1.3: Status Messages)\n        requestAnimationFrame(() => {\n          // Create/update aria-live region announcement\n          const ariaLiveRegion = document.querySelector(\n            '[data-testid=\"search-live-region\"]',\n          );\n          if (ariaLiveRegion) {\n            ariaLiveRegion.textContent = `Match ${nextIndex + 1} of ${searchResults.length}`;\n          }\n\n          // Keep focus in search input for continued navigation\n          // Timeline component handles item focus/visibility internally\n          // Explicitly return focus to search input after navigation\n          if (searchInputRef.current) {\n            searchInputRef.current.focus();\n          }\n        });\n      }\n    },\n    [searchResults, currentMatchIndex, searchableContent],\n  );\n\n  const handleNextMatch = useCallback(\n    () => navigateMatches('next'),\n    [navigateMatches],\n  );\n\n  const handlePreviousMatch = useCallback(\n    () => navigateMatches('prev'),\n    [navigateMatches],\n  );\n\n  const handleSearchKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      switch (e.key) {\n        case 'Enter':\n          if (searchResults.length > 0) {\n            e.preventDefault();\n            handleNextMatch();\n          }\n          break;\n        case 'Escape':\n          e.preventDefault();\n          clearSearch();\n          break;\n      }\n    },\n    [searchResults.length, handleNextMatch, clearSearch],\n  );\n\n  return {\n    searchQuery,\n    searchResults,\n    currentMatchIndex,\n    searchInputRef,\n    activeItemIndex,\n    handleSearchChange,\n    triggerSearch,\n    clearSearch,\n    handleNextMatch,\n    handlePreviousMatch,\n    handleSearchKeyDown,\n  };\n};\n","import {\n  RefObject,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  useRef,\n} from 'react';\nimport { useTimelineContext } from '../components/contexts';\n\ninterface UseCardSizeProps {\n  containerRef: RefObject<HTMLElement | null>;\n  detailsRef: RefObject<HTMLElement | null>;\n  setStartWidth: (width: number) => void;\n}\n\ninterface UseCardSizeReturn {\n  cardActualHeight: number;\n  detailsHeight: number;\n  textContentLarge: boolean;\n  updateCardSize: (node: HTMLElement | null) => void;\n}\n\ninterface CardDimensions {\n  cardHeight: number;\n  detailsHeight: number;\n  containerWidth: number;\n}\n\n// Memoized calculation function to prevent unnecessary recalculations\nconst calculateTextContentSize = (\n  scrollHeight: number,\n  clientHeight: number,\n  contentDetailsHeight: number = 150,\n): boolean => {\n  // Content is considered \"large\" if it exceeds the configured height limit\n  // This provides a more predictable behavior than comparing with container\n  return scrollHeight > contentDetailsHeight;\n};\n\nexport const useCardSize = ({\n  containerRef,\n  detailsRef,\n  setStartWidth,\n}: UseCardSizeProps): UseCardSizeReturn => {\n  // Safely get contentDetailsHeight from context with fallback\n  let contentDetailsHeight = 150; // Default fallback\n  try {\n    const context = useTimelineContext();\n    contentDetailsHeight = context.contentDetailsHeight;\n  } catch {\n    // Context not available, use fallback\n  }\n  const [dimensions, setDimensions] = useState<CardDimensions>({\n    cardHeight: 0,\n    detailsHeight: 0,\n    containerWidth: 0,\n  });\n\n  // Cache DOM measurements to avoid repeated calculations\n  const measurementsCache = useRef<{\n    scrollHeight: number;\n    clientHeight: number;\n    offsetTop: number;\n    containerHeight: number;\n  }>({ scrollHeight: 0, clientHeight: 0, offsetTop: 0, containerHeight: 0 });\n\n  // Throttled resize observer for better performance\n  useEffect(() => {\n    let rafId: number | undefined;\n    let isUnmounted = false;\n\n    const observer = new ResizeObserver((entries) => {\n      // Use RAF to batch DOM updates\n      if (rafId) cancelAnimationFrame(rafId);\n\n      rafId = requestAnimationFrame(() => {\n        if (isUnmounted) return; // Prevent updates after unmount\n\n        for (const entry of entries) {\n          if (containerRef.current && detailsRef.current) {\n            const detailsEle = detailsRef.current;\n            const container = containerRef.current;\n\n            // Update measurements\n            measurementsCache.current = {\n              scrollHeight: detailsEle.scrollHeight,\n              clientHeight: detailsEle.offsetHeight,\n              offsetTop: detailsEle.offsetTop,\n              containerHeight: container.clientHeight,\n            };\n\n            // Update dimensions\n            setDimensions({\n              cardHeight: detailsEle.scrollHeight,\n              detailsHeight: detailsEle.offsetHeight,\n              containerWidth: container.clientWidth,\n            });\n          }\n        }\n        rafId = undefined;\n      });\n    });\n\n    if (containerRef.current) {\n      observer.observe(containerRef.current);\n    }\n\n    // Also observe the details element for size changes\n    if (detailsRef.current) {\n      observer.observe(detailsRef.current);\n    }\n\n    // Force initial measurement when detailsRef becomes available\n    // This handles the case when textDensity changes from LOW to HIGH\n    if (containerRef.current && detailsRef.current) {\n      const detailsEle = detailsRef.current;\n      const container = containerRef.current;\n\n      measurementsCache.current = {\n        scrollHeight: detailsEle.scrollHeight,\n        clientHeight: detailsEle.offsetHeight,\n        offsetTop: detailsEle.offsetTop,\n        containerHeight: container.clientHeight,\n      };\n\n      setDimensions({\n        cardHeight: detailsEle.scrollHeight,\n        detailsHeight: detailsEle.offsetHeight,\n        containerWidth: container.clientWidth,\n      });\n    }\n\n    return () => {\n      isUnmounted = true;\n      if (rafId) cancelAnimationFrame(rafId);\n      observer.disconnect();\n    };\n  }, [containerRef, detailsRef]);\n\n  const updateCardSize = useCallback(\n    (node: HTMLElement | null) => {\n      if (!node || !detailsRef.current) return;\n\n      const detailsEle = detailsRef.current;\n      const { scrollHeight, offsetHeight, offsetTop } = detailsEle;\n      const containerHeight = node.clientHeight;\n\n      // Cache measurements\n      measurementsCache.current = {\n        scrollHeight,\n        clientHeight: offsetHeight,\n        offsetTop,\n        containerHeight,\n      };\n\n      containerRef.current = node;\n      setStartWidth(node.clientWidth);\n      setDimensions({\n        cardHeight: scrollHeight,\n        detailsHeight: offsetHeight,\n        containerWidth: node.clientWidth,\n      });\n    },\n    [detailsRef, setStartWidth, containerRef],\n  );\n\n  // Optimized memoization with cached measurements\n  const { cardActualHeight, detailsHeight, textContentLarge } = useMemo(() => {\n    const cache = measurementsCache.current;\n    return {\n      cardActualHeight: dimensions.cardHeight,\n      detailsHeight: dimensions.detailsHeight,\n      textContentLarge: calculateTextContentSize(\n        cache.scrollHeight,\n        cache.clientHeight,\n        contentDetailsHeight, // Use context value instead of hardcoded 150\n      ),\n    };\n  }, [dimensions, contentDetailsHeight]);\n\n  return {\n    cardActualHeight,\n    detailsHeight,\n    textContentLarge,\n    updateCardSize,\n  };\n};\n","import { useCallback, useEffect, useState, RefObject } from 'react';\n\n/**\n * Browser detection utility for fullscreen API differences\n * Enhanced to detect specific browser versions and capabilities\n */\nconst getBrowserInfo = () => {\n  const userAgent = typeof navigator !== 'undefined' ? navigator.userAgent : '';\n  const vendor = typeof navigator !== 'undefined' ? navigator.vendor : '';\n\n  return {\n    isChrome: /Chrome/.test(userAgent) && !/Edge/.test(userAgent),\n    isFirefox: /Firefox/.test(userAgent),\n    isSafari:\n      /Safari/.test(userAgent) &&\n      !/Chrome/.test(userAgent) &&\n      /Apple/.test(vendor),\n    isEdge: /Edge/.test(userAgent) || /Edg\\//.test(userAgent),\n    isIE: /Trident/.test(userAgent),\n    isMobile: /Mobi|Android/i.test(userAgent),\n    // Safari version detection for method selection\n    safariVersion:\n      /Safari/.test(userAgent) && !/Chrome/.test(userAgent)\n        ? parseFloat(\n            (userAgent.match(/Version\\/(\\d+\\.\\d+)/) || ['', '0'])[1] || '0',\n          )\n        : 0,\n    // Chrome version for modern API support\n    chromeVersion: /Chrome/.test(userAgent)\n      ? parseInt((userAgent.match(/Chrome\\/(\\d+)/) || ['', '0'])[1] || '0', 10)\n      : 0,\n  };\n};\n\n/**\n * Fullscreen API interface for better TypeScript support\n * Covers all browser implementations including Safari's unique behavior\n */\ninterface FullscreenDocument extends Document {\n  fullscreenElement: Element | null;\n  mozFullScreenElement?: Element | null;\n  webkitFullscreenElement?: Element | null;\n  msFullscreenElement?: Element | null;\n  // Support properties\n  fullscreenEnabled: boolean;\n  mozFullScreenEnabled?: boolean;\n  webkitFullscreenEnabled?: boolean;\n  msFullscreenEnabled?: boolean;\n  // Exit methods\n  exitFullscreen: () => Promise<void>;\n  mozCancelFullScreen?: () => Promise<void>;\n  webkitExitFullscreen?: () => Promise<void>;\n  webkitCancelFullScreen?: () => Promise<void>; // Safari alternative\n  msExitFullscreen?: () => Promise<void>;\n}\n\ninterface FullscreenElement extends Element {\n  requestFullscreen: (options?: FullscreenOptions) => Promise<void>;\n  mozRequestFullScreen?: (options?: any) => Promise<void>;\n  webkitRequestFullscreen?: (options?: any) => Promise<void>;\n  webkitRequestFullScreen?: (options?: any) => Promise<void>; // Safari alternative\n  msRequestFullscreen?: (options?: any) => Promise<void>;\n}\n\n// Fullscreen options for modern browsers\ninterface FullscreenOptions {\n  navigationUI?: 'auto' | 'show' | 'hide';\n}\n\n/**\n * Hook return type\n */\ninterface UseFullscreenReturn {\n  isFullscreen: boolean;\n  isSupported: boolean;\n  toggleFullscreen: () => Promise<void>;\n  enterFullscreen: () => Promise<void>;\n  exitFullscreen: () => Promise<void>;\n  error: string | null;\n}\n\n/**\n * Hook options\n */\ninterface UseFullscreenOptions {\n  onEnter?: () => void;\n  onExit?: () => void;\n  onError?: (error: string) => void;\n}\n\n/**\n * Custom hook for managing fullscreen functionality\n * Provides cross-browser compatible fullscreen API with proper error handling\n *\n * @param elementRef - Ref to the element to make fullscreen\n * @param options - Optional callbacks for fullscreen events\n * @returns Object with fullscreen state and control functions\n *\n * @example\n * ```tsx\n * const containerRef = useRef<HTMLDivElement>(null);\n * const { isFullscreen, toggleFullscreen, isSupported } = useFullscreen(containerRef, {\n *   onEnter: () => console.log('Entered fullscreen'),\n *   onExit: () => console.log('Exited fullscreen'),\n * });\n * ```\n */\nexport const useFullscreen = (\n  elementRef: RefObject<HTMLElement>,\n  options: UseFullscreenOptions = {},\n): UseFullscreenReturn => {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Check if fullscreen API is supported - comprehensive cross-browser check\n  const isSupported = useCallback((): boolean => {\n    if (typeof document === 'undefined' || typeof navigator === 'undefined')\n      return false;\n\n    const doc = document as FullscreenDocument;\n    const element = document.createElement('div') as FullscreenElement;\n    const browserInfo = getBrowserInfo();\n\n    // Check for support properties\n    const hasEnabledProperty = !!(\n      doc.fullscreenEnabled ||\n      doc.mozFullScreenEnabled ||\n      doc.webkitFullscreenEnabled ||\n      doc.msFullscreenEnabled\n    );\n\n    // Check for request methods on elements\n    const hasRequestMethod = !!(\n      element.requestFullscreen ||\n      element.mozRequestFullScreen ||\n      element.webkitRequestFullscreen ||\n      element.webkitRequestFullScreen ||\n      element.msRequestFullscreen\n    );\n\n    // Check for exit methods on document\n    const hasExitMethod = !!(\n      doc.exitFullscreen ||\n      doc.mozCancelFullScreen ||\n      doc.webkitExitFullscreen ||\n      doc.webkitCancelFullScreen ||\n      doc.msExitFullscreen\n    );\n\n    // Additional browser-specific checks\n    if (browserInfo.isSafari && browserInfo.isMobile) {\n      // Mobile Safari has limited fullscreen support\n      return false;\n    }\n\n    // Check if we're in a secure context (required for some browsers)\n    const isSecureContext =\n      typeof window !== 'undefined' &&\n      (window.isSecureContext ||\n        location.protocol === 'https:' ||\n        location.hostname === 'localhost');\n\n    return (\n      hasEnabledProperty && hasRequestMethod && hasExitMethod && isSecureContext\n    );\n  }, []);\n\n  // Get the current fullscreen element - comprehensive cross-browser check\n  const getFullscreenElement = useCallback((): Element | null => {\n    if (typeof document === 'undefined') return null;\n\n    const doc = document as FullscreenDocument;\n\n    // Try standard first, then vendor prefixes\n    const element =\n      doc.fullscreenElement ||\n      doc.mozFullScreenElement ||\n      doc.webkitFullscreenElement ||\n      doc.msFullscreenElement ||\n      null;\n\n    return element;\n  }, []);\n\n  // Enter fullscreen mode - comprehensive cross-browser implementation\n  const enterFullscreen = useCallback(async (): Promise<void> => {\n    if (!isSupported() || !elementRef.current) {\n      const errorMsg = !isSupported()\n        ? 'Fullscreen API is not supported in this browser'\n        : 'Element reference is not available';\n      setError(errorMsg);\n      options.onError?.(errorMsg);\n      throw new Error(errorMsg);\n    }\n\n    try {\n      setError(null);\n      const element = elementRef.current as FullscreenElement;\n      const browserInfo = getBrowserInfo();\n\n      // Browser-specific method selection with fallback chain\n      let requestMethod: (() => Promise<void>) | null = null;\n\n      if (element.requestFullscreen) {\n        // Standard API - supported by modern browsers\n        requestMethod = () =>\n          element.requestFullscreen({ navigationUI: 'hide' });\n      } else if (browserInfo.isSafari) {\n        // Safari-specific handling - try both variants\n        if (element.webkitRequestFullscreen) {\n          requestMethod = () =>\n            element.webkitRequestFullscreen?.() || Promise.resolve();\n        } else if (element.webkitRequestFullScreen) {\n          // Older Safari versions\n          requestMethod = () =>\n            element.webkitRequestFullScreen?.() || Promise.resolve();\n        }\n      } else if (browserInfo.isChrome && element.webkitRequestFullscreen) {\n        // Chrome and Chromium-based browsers\n        requestMethod = () =>\n          element.webkitRequestFullscreen?.() || Promise.resolve();\n      } else if (browserInfo.isFirefox && element.mozRequestFullScreen) {\n        // Firefox\n        requestMethod = () =>\n          element.mozRequestFullScreen?.() || Promise.resolve();\n      } else if (browserInfo.isEdge && element.msRequestFullscreen) {\n        // Legacy Edge\n        requestMethod = () =>\n          element.msRequestFullscreen?.() || Promise.resolve();\n      } else {\n        // Fallback chain for undetected browsers\n        if (element.webkitRequestFullscreen) {\n          requestMethod = () =>\n            element.webkitRequestFullscreen?.() || Promise.resolve();\n        } else if (element.webkitRequestFullScreen) {\n          requestMethod = () =>\n            element.webkitRequestFullScreen?.() || Promise.resolve();\n        } else if (element.mozRequestFullScreen) {\n          requestMethod = () =>\n            element.mozRequestFullScreen?.() || Promise.resolve();\n        } else if (element.msRequestFullscreen) {\n          requestMethod = () =>\n            element.msRequestFullscreen?.() || Promise.resolve();\n        }\n      }\n\n      if (!requestMethod) {\n        throw new Error(\n          'No compatible fullscreen method found for this browser',\n        );\n      }\n\n      await requestMethod();\n    } catch (err) {\n      // Enhanced error handling for specific browser issues\n      let errorMsg = 'Failed to enter fullscreen';\n\n      if (err instanceof Error) {\n        const { message } = err;\n        const browserInfo = getBrowserInfo();\n\n        if (message.includes('denied') || message.includes('not allowed')) {\n          errorMsg =\n            'Fullscreen request denied. User interaction may be required.';\n        } else if (\n          message.includes('security') ||\n          message.includes('permission')\n        ) {\n          errorMsg =\n            'Fullscreen blocked for security reasons. Ensure HTTPS or localhost.';\n        } else if (browserInfo.isSafari && message.includes('not supported')) {\n          errorMsg =\n            'Fullscreen not supported in this Safari version. Try updating your browser.';\n        } else if (browserInfo.isFirefox && message.includes('unavailable')) {\n          errorMsg = 'Firefox fullscreen unavailable. Check browser settings.';\n        } else {\n          errorMsg = message;\n        }\n      }\n\n      setError(errorMsg);\n      options.onError?.(errorMsg);\n      throw new Error(errorMsg);\n    }\n  }, [elementRef, isSupported, options]);\n\n  // Exit fullscreen mode - comprehensive cross-browser implementation\n  const exitFullscreen = useCallback(async (): Promise<void> => {\n    if (!isSupported()) {\n      const errorMsg = 'Fullscreen API is not supported in this browser';\n      setError(errorMsg);\n      options.onError?.(errorMsg);\n      throw new Error(errorMsg);\n    }\n\n    try {\n      setError(null);\n      const doc = document as FullscreenDocument;\n      const browserInfo = getBrowserInfo();\n\n      // Browser-specific method selection with fallback chain\n      let exitMethod: (() => Promise<void>) | null = null;\n\n      if (doc.exitFullscreen) {\n        // Standard API - supported by modern browsers\n        exitMethod = () => doc.exitFullscreen();\n      } else if (browserInfo.isSafari) {\n        // Safari-specific handling - try both variants\n        if (doc.webkitExitFullscreen) {\n          exitMethod = () => doc.webkitExitFullscreen?.() || Promise.resolve();\n        } else if (doc.webkitCancelFullScreen) {\n          // Older Safari versions\n          exitMethod = () =>\n            doc.webkitCancelFullScreen?.() || Promise.resolve();\n        }\n      } else if (browserInfo.isChrome && doc.webkitExitFullscreen) {\n        // Chrome and Chromium-based browsers\n        exitMethod = () => doc.webkitExitFullscreen?.() || Promise.resolve();\n      } else if (browserInfo.isFirefox && doc.mozCancelFullScreen) {\n        // Firefox\n        exitMethod = () => doc.mozCancelFullScreen?.() || Promise.resolve();\n      } else if (browserInfo.isEdge && doc.msExitFullscreen) {\n        // Legacy Edge\n        exitMethod = () => doc.msExitFullscreen?.() || Promise.resolve();\n      } else {\n        // Fallback chain for undetected browsers\n        if (doc.webkitExitFullscreen) {\n          exitMethod = () => doc.webkitExitFullscreen?.() || Promise.resolve();\n        } else if (doc.webkitCancelFullScreen) {\n          exitMethod = () =>\n            doc.webkitCancelFullScreen?.() || Promise.resolve();\n        } else if (doc.mozCancelFullScreen) {\n          exitMethod = () => doc.mozCancelFullScreen?.() || Promise.resolve();\n        } else if (doc.msExitFullscreen) {\n          exitMethod = () => doc.msExitFullscreen?.() || Promise.resolve();\n        }\n      }\n\n      if (!exitMethod) {\n        throw new Error(\n          'No compatible exit fullscreen method found for this browser',\n        );\n      }\n\n      await exitMethod();\n    } catch (err) {\n      // Enhanced error handling for exit fullscreen issues\n      let errorMsg = 'Failed to exit fullscreen';\n\n      if (err instanceof Error) {\n        const { message } = err;\n        const browserInfo = getBrowserInfo();\n\n        if (message.includes('denied') || message.includes('not allowed')) {\n          errorMsg = 'Exit fullscreen request denied. Try pressing Escape key.';\n        } else if (browserInfo.isSafari && message.includes('not supported')) {\n          errorMsg = 'Exit fullscreen not supported in this Safari version.';\n        } else if (browserInfo.isFirefox && message.includes('unavailable')) {\n          errorMsg = 'Firefox exit fullscreen unavailable. Try Escape key.';\n        } else {\n          errorMsg = message;\n        }\n      }\n\n      setError(errorMsg);\n      options.onError?.(errorMsg);\n      throw new Error(errorMsg);\n    }\n  }, [isSupported, options]);\n\n  // Toggle fullscreen mode\n  const toggleFullscreen = useCallback(async (): Promise<void> => {\n    if (isFullscreen) {\n      await exitFullscreen();\n    } else {\n      await enterFullscreen();\n    }\n  }, [isFullscreen, enterFullscreen, exitFullscreen]);\n\n  // Update fullscreen state\n  const updateFullscreenState = useCallback(() => {\n    const fullscreenElement = getFullscreenElement();\n    const newIsFullscreen =\n      !!fullscreenElement && fullscreenElement === elementRef.current;\n\n    if (newIsFullscreen !== isFullscreen) {\n      setIsFullscreen(newIsFullscreen);\n\n      if (newIsFullscreen) {\n        options.onEnter?.();\n      } else {\n        options.onExit?.();\n      }\n    }\n  }, [getFullscreenElement, elementRef, isFullscreen, options]);\n\n  // Set up event listeners for fullscreen changes\n  useEffect(() => {\n    if (!isSupported()) return;\n\n    // Comprehensive list of fullscreen change events for all browsers\n    const events = [\n      'fullscreenchange', // Standard\n      'mozfullscreenchange', // Firefox\n      'webkitfullscreenchange', // Chrome, Opera, newer Safari\n      'msfullscreenchange', // Internet Explorer/Edge\n    ];\n\n    // Additional error events for better error handling\n    const errorEvents = [\n      'fullscreenerror',\n      'mozfullscreenerror',\n      'webkitfullscreenerror',\n      'msfullscreenerror',\n    ];\n\n    // Error handler for fullscreen errors\n    const handleFullscreenError = () => {\n      setError('Fullscreen request was denied or failed');\n      options.onError?.('Fullscreen request was denied or failed');\n    };\n\n    // Add change event listeners\n    events.forEach((event) => {\n      document.addEventListener(event, updateFullscreenState);\n    });\n\n    // Add error event listeners\n    errorEvents.forEach((event) => {\n      document.addEventListener(event, handleFullscreenError);\n    });\n\n    // Initial state check\n    updateFullscreenState();\n\n    return () => {\n      events.forEach((event) => {\n        document.removeEventListener(event, updateFullscreenState);\n      });\n      errorEvents.forEach((event) => {\n        document.removeEventListener(event, handleFullscreenError);\n      });\n    };\n  }, [isSupported, updateFullscreenState]);\n\n  // Handle escape key to exit fullscreen\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isFullscreen) {\n        exitFullscreen();\n      }\n    };\n\n    if (isFullscreen) {\n      document.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isFullscreen, exitFullscreen]);\n\n  return {\n    isFullscreen,\n    isSupported: isSupported(),\n    toggleFullscreen,\n    enterFullscreen,\n    exitFullscreen,\n    error,\n  };\n};\n","const ArrowDownIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"currentColor\"\n  >\n    <path d=\"M6 18h12v2H6zm5-14v8.586L6.707 8.293 5.293 9.707 12 16.414l6.707-6.707-1.414-1.414L13 12.586V4z\" />\n  </svg>\n)\nexport default ArrowDownIcon\n","const CheckIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    strokeWidth={2}\n  >\n    <path d=\"M20 6 9 17l-5-5\" />\n  </svg>\n)\nexport default CheckIcon\n","import React from 'react';\n\nconst ChevDownIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"chev-down-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    strokeWidth=\"2\"\n    style={{ display: 'block', width: '100%', height: '100%' }}\n  >\n    <path d=\"m6 9 6 6 6-6\" />\n  </svg>\n);\n\nexport default React.memo(ChevDownIcon);\n","import React from 'react';\n\nconst ChevronLeft: React.FunctionComponent = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    style={{ display: 'block', width: '100%', height: '100%' }}\n  >\n    <polyline points=\"15 18 9 12 15 6\"></polyline>\n  </svg>\n);\n\nexport default React.memo(ChevronLeft);\n","import React from 'react';\n\nconst ChevronRightIcon: React.FunctionComponent = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    style={{ display: 'block', width: '100%', height: '100%' }}\n  >\n    <polyline points=\"9 18 15 12 9 6\"></polyline>\n  </svg>\n);\n\nexport default React.memo(ChevronRightIcon);\n","import * as React from \"react\"\n\nfunction SvgComponent() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={24}\n      height={24}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth={2}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      className=\"prefix__feather prefix__feather-x\"\n    >\n      <path d=\"M18 6L6 18M6 6l12 12\" />\n    </svg>\n  )\n}\n\nexport default SvgComponent\n","const LayoutIcon = (props: any) => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    fill='currentColor'\n  >\n    <path d=\"M19 3H5c-1.103 0-2 .897-2 2v4h18V5c0-1.103-.897-2-2-2zM3 19c0 1.103.897 2 2 2h8V11H3v8zm12 2h4c1.103 0 2-.897 2-2v-8h-6v10z\" />\n  </svg>\n)\nexport default LayoutIcon\n","import React from 'react';\n\nconst MaximizeIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"maximize-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-maximize-2\"\n  >\n    <path d=\"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7\" />\n  </svg>\n);\n\nexport default React.memo(MaximizeIcon);\n","import React from 'react';\n\nconst MinimizeIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"minimize-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-minimize-2\"\n  >\n    <path d=\"M4 14h6v6M20 10h-6V4M14 10l7-7M3 21l7-7\" />\n  </svg>\n);\n\nexport default React.memo(MinimizeIcon);\n","\nimport React from 'react';\n\nconst MinusIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"minus-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    style={{ display: 'block', width: '100%', height: '100%' }}\n  >\n    <path d=\"M5 12h14\" />\n  </svg>\n);\n\nexport default React.memo(MinusIcon);\n","\nimport React from 'react';\n\nconst MoonIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"moon-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-moon\"\n  >\n    <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />\n  </svg>\n);\n\nexport default React.memo(MoonIcon);\n","\nimport React from 'react';\n\nconst PlusIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"plus-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    style={{ display: 'block', width: '100%', height: '100%' }}\n  >\n    <path d=\"M12 5v14M5 12h14\" />\n  </svg>\n);\n\nexport default React.memo(PlusIcon);\n","\nimport React from 'react';\n\nconst StopIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"stop-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-stop-circle\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <path d=\"M9 9h6v6H9z\" />\n  </svg>\n);\n\nexport default React.memo(StopIcon);\n","\nimport React from 'react';\n\nconst SunIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"sun-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-sun\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"5\" />\n    <path d=\"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42\" />\n  </svg>\n);\n\nexport default React.memo(SunIcon);\n","import React from 'react';\n\nconst ParaIcon: React.FunctionComponent = () => (\n  <svg\n    data-testid=\"para-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"currentColor\"\n  >\n    <path d=\"M9 16h2v4h2V6h2v14h2V6h3V4H9c-3.309 0-6 2.691-6 6s2.691 6 6 6zM9 6h2v8H9c-2.206 0-4-1.794-4-4s1.794-4 4-4z\" />\n  </svg>\n);\n\nexport default React.memo(ParaIcon);\n","import React from 'react';\n\nconst ChevronLeft: React.FunctionComponent = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-chevrons-left\"\n  >\n    <polyline points=\"11 17 6 12 11 7\"></polyline>\n    <polyline points=\"18 17 13 12 18 7\"></polyline>\n  </svg>\n);\n\nexport default React.memo(ChevronLeft);\n","import React from 'react';\n\nconst ChevronRightIcon: React.FunctionComponent = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    className=\"feather feather-chevrons-right\"\n  >\n    <polyline points=\"13 17 18 12 13 7\"></polyline>\n    <polyline points=\"6 17 11 12 6 7\"></polyline>\n  </svg>\n);\n\nexport default React.memo(ChevronRightIcon);\n","import React from 'react';\n\nconst ReplayIcon: React.FunctionComponent = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polygon points=\"5 3 19 12 5 21 5 3\"></polygon>\n  </svg>\n);\n\nexport default React.memo(ReplayIcon);\n","import { TimelineControlModel } from '@models/TimelineControlModel';\nimport cls from 'classnames';\nimport React, { useCallback, useMemo, useRef, useEffect } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport { useAriaLiveRegion } from '../../../hooks';\nimport { MoonIcon, StopIcon, SunIcon } from '../../icons';\nimport ChevronLeft from '../../icons/chev-left';\nimport ChevronRightIcon from '../../icons/chev-right';\nimport ChevronsLeftIcon from '../../icons/chevs-left';\nimport ChevronsRightIcon from '../../icons/chevs-right';\nimport ReplayIcon from '../../icons/replay-icon';\nimport {\n  navButton,\n  navButtonActive,\n  navButtonFocus,\n  navButtonHover,\n  navItem,\n  navItemDisabled,\n  navWrapper,\n  srOnly,\n  timelineControlContainer,\n  navButtonSvg,\n} from './timeline-control.css';\n\n/**\n * TimelineControl component\n * Provides navigation controls for a timeline, including next, previous, first, last, and slideshow buttons.\n * Optionally supports flipping the layout and dark mode toggle.\n *\n * @property {function} onNext - Function to go to the next item.\n * @property {function} onPrevious - Function to go to the previous item.\n * @property {function} onFirst - Function to jump to the first item.\n * @property {function} onLast - Function to jump to the last item.\n * @property {boolean} disableLeft - Whether to disable the left navigation buttons.\n * @property {boolean} disableRight - Whether to disable the right navigation buttons.\n * @property {boolean} slideShowRunning - Whether the slideshow is currently running.\n * @property {function} onReplay - Function to restart the slideshow.\n * @property {boolean} slideShowEnabled - Whether the slideshow feature is enabled.\n * @property {function} onToggleDarkMode - Function to toggle dark mode (if enabled).\n * @property {boolean} isDark - Whether dark mode is currently active.\n * @property {function} onPaused - Function to pause the slideshow (if running).\n * @returns {JSX.Element} The TimelineControl component.\n */\nconst Controls: React.FunctionComponent<TimelineControlModel> = ({\n  onNext,\n  onPrevious,\n  onFirst,\n  onLast,\n  disableLeft,\n  disableRight,\n  slideShowRunning,\n  onReplay,\n  slideShowEnabled,\n  onToggleDarkMode,\n  isDark,\n  onPaused,\n  activeTimelineItem,\n  totalItems,\n}: TimelineControlModel) => {\n  // Use unified context\n  const {\n    mode,\n    flipLayout,\n    disableInteraction,\n    buttonTexts,\n    classNames,\n    enableDarkToggle,\n  } = useTimelineContext();\n\n  // Use ARIA live region for screen reader announcements (WCAG 4.1.3)\n  const { announce, LiveRegion } = useAriaLiveRegion({\n    politeness: 'polite',\n  });\n\n  // Create button refs for roving tabindex\n  const buttonRefsMap = useRef<Map<string, React.RefObject<HTMLButtonElement>>>(\n    new Map(),\n  );\n\n  const flippedHorizontally = useMemo(\n    () => flipLayout && mode === 'HORIZONTAL',\n    [flipLayout, mode],\n  );\n\n  const canDisableLeft = useMemo(\n    () => disableLeft || slideShowRunning,\n    [disableLeft, slideShowRunning],\n  );\n\n  const canDisableRight = useMemo(\n    () => disableRight || slideShowRunning,\n    [disableRight, slideShowRunning],\n  );\n\n  // WCAG 2.4.3: Focus Order - Sequential tab navigation\n  // All buttons are tabbable in order, disabled buttons are skipped by browser\n\n  const handlePause = useCallback(() => {\n    onPaused?.();\n  }, [onPaused]);\n\n  const handlePlay = useCallback(() => {\n    onReplay?.();\n  }, [onReplay]);\n\n  const previousTitle = useMemo(\n    () => (flipLayout ? buttonTexts?.next : buttonTexts?.previous),\n    [flipLayout, buttonTexts?.next, buttonTexts?.previous],\n  );\n\n  const nextTitle = useMemo(\n    () => (flipLayout ? buttonTexts?.previous : buttonTexts?.next),\n    [flipLayout, buttonTexts?.previous, buttonTexts?.next],\n  );\n\n  const playOrPauseTile = useMemo(\n    () => (slideShowRunning ? buttonTexts?.stop : buttonTexts?.play),\n    [slideShowRunning, buttonTexts?.stop, buttonTexts?.play],\n  );\n\n  const jumpToLastTitle = useMemo(\n    () => (flipLayout ? buttonTexts?.first : buttonTexts?.last),\n    [flipLayout, buttonTexts?.first, buttonTexts?.last],\n  );\n\n  const jumpToFirstTitle = useMemo(\n    () => (flipLayout ? buttonTexts?.last : buttonTexts?.first),\n    [flipLayout, buttonTexts?.last, buttonTexts?.first],\n  );\n\n  // Announce position changes to screen readers (WCAG 4.1.3)\n  useEffect(() => {\n    if (\n      activeTimelineItem !== undefined &&\n      totalItems !== undefined &&\n      totalItems > 0\n    ) {\n      const current = activeTimelineItem + 1;\n      announce(`Item ${current} of ${totalItems}`);\n    }\n  }, [activeTimelineItem, totalItems, announce]);\n\n  // Announce slideshow status changes to screen readers\n  useEffect(() => {\n    if (slideShowRunning) {\n      announce('Slideshow is running');\n    }\n  }, [slideShowRunning, announce]);\n\n  return (\n    <div className={timelineControlContainer} key=\"control-wrapper\">\n      {/* ARIA live region for screen reader announcements */}\n      <LiveRegion />\n\n      <div\n        className={cls(navWrapper, 'timeline-controls', classNames?.controls)}\n        aria-label=\"Timeline navigation controls\"\n        role=\"toolbar\"\n      >\n        {/* Navigation group: First, Previous, Next, Last */}\n        {disableInteraction ? null : (\n          <div\n            role=\"group\"\n            aria-label=\"Item navigation\"\n            style={{ display: 'flex' }}\n          >\n            {/* jump to first */}\n            <div\n              className={cls(navItem, { [navItemDisabled]: canDisableLeft })}\n            >\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (!canDisableLeft) {\n                    const handler = flippedHorizontally ? onLast : onFirst;\n                    handler?.(event);\n                  }\n                }}\n                title={jumpToFirstTitle}\n                aria-label={jumpToFirstTitle}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-disabled={!!canDisableLeft}\n                tabIndex={canDisableLeft ? -1 : 0}\n                data-test-id=\"jump-to-first\"\n              >\n                <span className={navButtonSvg}>\n                  <ChevronsLeftIcon />\n                </span>\n              </button>\n            </div>\n\n            {/* previous */}\n            <div\n              className={cls(navItem, { [navItemDisabled]: canDisableLeft })}\n            >\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (!canDisableLeft) {\n                    const handler = flippedHorizontally ? onNext : onPrevious;\n                    handler?.(event);\n                  }\n                }}\n                title={previousTitle}\n                aria-label={previousTitle}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-disabled={!!canDisableLeft}\n                tabIndex={canDisableLeft ? -1 : 0}\n                data-test-id=\"previous\"\n              >\n                <span className={navButtonSvg}>\n                  <ChevronLeft />\n                </span>\n              </button>\n            </div>\n\n            {/* next */}\n            <div\n              className={cls(navItem, { [navItemDisabled]: canDisableRight })}\n            >\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (!canDisableRight) {\n                    const handler = flippedHorizontally ? onPrevious : onNext;\n                    handler?.(event);\n                  }\n                }}\n                title={nextTitle}\n                aria-label={nextTitle}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-disabled={!!canDisableRight}\n                tabIndex={canDisableRight ? -1 : 0}\n                data-test-id=\"next\"\n              >\n                <span className={navButtonSvg}>\n                  <ChevronRightIcon />\n                </span>\n              </button>\n            </div>\n\n            {/* jump to last */}\n            <div\n              className={cls(navItem, { [navItemDisabled]: canDisableRight })}\n            >\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (!canDisableRight) {\n                    const handler = flippedHorizontally ? onFirst : onLast;\n                    handler?.(event);\n                  }\n                }}\n                title={jumpToLastTitle}\n                aria-label={jumpToLastTitle}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-disabled={!!canDisableRight}\n                tabIndex={canDisableRight ? -1 : 0}\n                data-test-id=\"jump-to-last\"\n              >\n                <span className={navButtonSvg}>\n                  <ChevronsRightIcon />\n                </span>\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Slideshow control group */}\n        {slideShowEnabled && (\n          <div role=\"group\" aria-label=\"Slideshow controls\">\n            <div className={navItem}>\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (slideShowRunning) {\n                    handlePause();\n                  } else {\n                    handlePlay();\n                  }\n                }}\n                title={playOrPauseTile}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-label={playOrPauseTile}\n                aria-pressed={slideShowRunning ? 'true' : 'false'}\n                data-test-id=\"play-pause\"\n              >\n                <span className={navButtonSvg}>\n                  {slideShowRunning ? <StopIcon /> : <ReplayIcon />}\n                </span>\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Theme control group */}\n        {enableDarkToggle ? (\n          <div role=\"group\" aria-label=\"Theme controls\">\n            <div\n              className={cls(navItem, {\n                [navItemDisabled]: slideShowRunning,\n              })}\n            >\n              <button\n                className={cls(\n                  navButton,\n                  navButtonHover,\n                  navButtonActive,\n                  navButtonFocus,\n                )}\n                onClick={(event) => {\n                  if (!slideShowRunning) {\n                    onToggleDarkMode?.(event);\n                  }\n                }}\n                title={isDark ? buttonTexts?.light : buttonTexts?.dark}\n                aria-controls=\"timeline-main-wrapper\"\n                aria-label={isDark ? buttonTexts?.light : buttonTexts?.dark}\n                aria-pressed={isDark ? 'true' : 'false'}\n                aria-disabled={!!slideShowRunning}\n                tabIndex={slideShowRunning ? -1 : 0}\n                data-test-id=\"dark-toggle\"\n              >\n                <span className={navButtonSvg}>\n                  {isDark ? <SunIcon /> : <MoonIcon />}\n                </span>\n              </button>\n            </div>\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nControls.displayName = 'Timeline Control';\n\nexport default Controls;\n","import React, { forwardRef, memo } from 'react';\nimport { MaximizeIcon, MinimizeIcon } from '../../icons';\nimport { FullscreenButtonProps } from './fullscreen-button.model';\nimport { fullscreenButton } from './fullscreen-button.css';\n\n/**\n * FullscreenButton Component\n *\n * A reusable button component for toggling fullscreen mode with proper accessibility\n * and theming support. Switches between maximize and minimize icons based on state.\n *\n * @component\n * @example\n * ```tsx\n * <FullscreenButton\n *   isFullscreen={false}\n *   onToggle={() => toggleFullscreen()}\n *   theme={theme}\n *   disabled={false}\n *   size=\"medium\"\n * />\n * ```\n */\nconst FullscreenButton = memo(\n  forwardRef<HTMLButtonElement, FullscreenButtonProps>(\n    (\n      {\n        isFullscreen = false,\n        onToggle,\n        theme,\n        disabled = false,\n        size = 'medium',\n        className,\n        ariaLabel,\n        title,\n        testId = 'fullscreen-button',\n        children,\n        ...rest\n      },\n      ref,\n    ) => {\n      // Determine button content and labels\n      const defaultAriaLabel = isFullscreen\n        ? 'Exit fullscreen'\n        : 'Enter fullscreen';\n      const defaultTitle = isFullscreen\n        ? 'Exit Fullscreen (Esc)'\n        : 'Enter Fullscreen';\n\n      const buttonAriaLabel = ariaLabel || defaultAriaLabel;\n      const buttonTitle = title || defaultTitle;\n\n      // Handle button click\n      const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (!disabled) {\n          onToggle?.();\n        }\n      };\n\n      // Handle keyboard interaction\n      const handleKeyDown = (event: React.KeyboardEvent<HTMLButtonElement>) => {\n        if ((event.key === 'Enter' || event.key === ' ') && !disabled) {\n          event.preventDefault();\n          onToggle?.();\n        }\n      };\n\n      const classNameComputed = fullscreenButton({\n        size,\n        isFullscreen: isFullscreen ? 'true' : 'false',\n      } as any);\n\n      return (\n        <button\n          ref={ref}\n          className={`${className ?? ''} ${classNameComputed}`}\n          onClick={handleClick}\n          onKeyDown={handleKeyDown}\n          disabled={disabled}\n          aria-label={buttonAriaLabel}\n          title={buttonTitle}\n          data-testid={testId}\n          type=\"button\"\n          role=\"button\"\n          {...rest}\n        >\n          {children || (isFullscreen ? <MinimizeIcon /> : <MaximizeIcon />)}\n        </button>\n      );\n    },\n  ),\n);\n\nFullscreenButton.displayName = 'FullscreenButton';\n\nexport { FullscreenButton };\nexport type { FullscreenButtonProps };\n","import React, { forwardRef, memo, RefObject } from 'react';\nimport { useFullscreen } from '../../../hooks/useFullscreen';\nimport { FullscreenButton } from '../fullscreen-button';\nimport { FullscreenControlProps } from './fullscreen-control.model';\nimport { pickDefined } from '../../../utils/propUtils';\n\n/**\n * FullscreenControl Component\n *\n * A high-level component that combines the fullscreen hook with the fullscreen button\n * to provide complete fullscreen functionality for any target element.\n *\n * @component\n * @example\n * ```tsx\n * const timelineRef = useRef<HTMLDivElement>(null);\n *\n * <FullscreenControl\n *   targetRef={timelineRef}\n *   theme={theme}\n *   onEnterFullscreen={() => console.log('Entered fullscreen')}\n *   onExitFullscreen={() => console.log('Exited fullscreen')}\n *   size=\"medium\"\n * />\n * ```\n */\nconst FullscreenControl = memo(\n  forwardRef<HTMLButtonElement, FullscreenControlProps>(\n    (\n      {\n        targetRef,\n        theme,\n        onEnterFullscreen,\n        onExitFullscreen,\n        onError,\n        size = 'medium',\n        disabled = false,\n        className,\n        ariaLabel,\n        title,\n        testId = 'fullscreen-control',\n        ...rest\n      },\n      ref,\n    ) => {\n      // Use the fullscreen hook\n      const { isFullscreen, isSupported, toggleFullscreen, error } =\n        useFullscreen(targetRef, {\n          onEnter: onEnterFullscreen || (() => {}),\n          onExit: onExitFullscreen || (() => {}),\n          onError: onError || (() => {}),\n        });\n\n      // Don't render if fullscreen is not supported\n      if (!isSupported) {\n        return null;\n      }\n\n      return (\n        <FullscreenButton\n          {...rest}\n          ref={ref}\n          isFullscreen={isFullscreen}\n          onToggle={() => {\n            toggleFullscreen().catch((err) => {\n              const errorMessage =\n                err instanceof Error\n                  ? err.message\n                  : 'Fullscreen operation failed';\n              onError?.(errorMessage);\n            });\n          }}\n          theme={theme}\n          disabled={disabled || !!error}\n          size={size}\n          testId={testId}\n          {...pickDefined({\n            className,\n            ariaLabel,\n          })}\n          {...(title || error\n            ? { title: title || `Fullscreen unavailable: ${error}` }\n            : {})}\n        />\n      );\n    },\n  ),\n);\n\nFullscreenControl.displayName = 'FullscreenControl';\n\nexport { FullscreenControl };\nexport type { FullscreenControlProps };\n","import { FunctionComponent, KeyboardEvent, memo, useCallback } from 'react';\nimport { CheckIcon } from 'src/components/icons';\nimport { ListItemModel } from './list.model';\nimport {\n  checkbox,\n  checkboxSelected,\n  checkboxWrapper,\n  description as descriptionClass,\n  listItem,\n  listItemActive,\n  styleAndDescription,\n  title as titleClass,\n} from './list.css';\nimport { listItemRecipe } from './list.css';\n\n/**\n * ListItem component displays a selectable/clickable item with title and description\n * @component\n * @param {Object} props - Component props\n * @param {string} props.title - The title text of the list item\n * @param {string} props.id - Unique identifier for the list item\n * @param {string} props.description - Optional description text below the title\n * @param {Theme} props.theme - Theme object for styling\n * @param {(id: string) => void} props.onClick - Click handler function\n * @param {boolean} props.active - Whether the item is in active state\n * @param {boolean} [props.selected=false] - Whether the item is selected (for checkbox mode)\n * @param {boolean} [props.selectable=false] - Whether the item shows a checkbox\n * @returns {JSX.Element} Rendered ListItem component\n */\nconst ListItem: FunctionComponent<ListItemModel> = memo(\n  ({\n    title,\n    id,\n    description,\n    theme,\n    onClick,\n    active,\n    selected = false,\n    selectable = false,\n    rovingProps,\n  }: ListItemModel) => {\n    /**\n     * Memoized click handler\n     * @param {string} id - Item identifier\n     */\n    const handleOnClick = useCallback((id: string) => onClick?.(id), [onClick]);\n\n    /**\n     * Merged keyboard event handler for menu item (WCAG 2.1.1: Keyboard)\n     * Combines roving tabindex (arrows) + menu selection (Enter/Space)\n     * @param {KeyboardEvent} ev - Keyboard event\n     */\n    const handleKeyDown = useCallback(\n      (ev: KeyboardEvent) => {\n        // First, let roving tabindex handle arrow key navigation\n        if (rovingProps?.onKeyDown) {\n          rovingProps.onKeyDown(ev as any);\n        }\n\n        // Then handle Enter/Space for selection (if not already handled)\n        if (!ev.defaultPrevented && (ev.key === 'Enter' || ev.key === ' ')) {\n          ev.preventDefault();\n          handleOnClick(id);\n        }\n      },\n      [rovingProps, handleOnClick, id],\n    );\n\n    const itemClass = `${listItem} ${active ? listItemActive : ''} ${listItemRecipe({ active: !!active })}`;\n    return (\n      <li\n        data-testid=\"list-item\"\n        role=\"menuitem\"\n        onClick={() => handleOnClick(id)}\n        onKeyDown={handleKeyDown}\n        className={itemClass}\n        tabIndex={rovingProps?.tabIndex ?? -1}\n        ref={rovingProps?.ref}\n        onFocus={rovingProps?.onFocus}\n      >\n        {selectable ? (\n          <span className={checkboxWrapper}>\n            <span\n              role=\"checkbox\"\n              aria-checked={selected}\n              className={`${checkbox} ${selected ? checkboxSelected : ''}`}\n            >\n              {selected && <CheckIcon />}\n            </span>\n          </span>\n        ) : null}\n        <div className={styleAndDescription}>\n          <h1 className={titleClass}>{title}</h1>\n          {description && <p className={descriptionClass}>{description}</p>}\n        </div>\n      </li>\n    );\n  },\n);\n\nListItem.displayName = 'ListItem';\n\nexport { ListItem };\n","import { getUniqueID } from '@utils/index';\nimport {\n  FunctionComponent,\n  startTransition,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { useRovingTabIndex } from '@hooks/accessibility/useRovingTabIndex';\nimport { ListItem } from './list-item';\nimport { ListModel } from './list.model';\nimport { list } from './list.css';\nimport { defaultTheme } from '../../common/themes';\n\n/**\n * Extends the base list item with a unique identifier\n * @typedef {Object} EnhancedListItem\n * @extends {ListModel['items'][0]}\n * @property {string} id - Unique identifier for the list item\n */\ntype EnhancedListItem = ListModel['items'][0] & { id: string };\n\n/**\n * List component that renders selectable items with optional multi-select capability\n * @component\n * @param {Object} props - Component props\n * @param {Array<ListModel['items'][0]>} props.items - Array of items to render in the list\n * @param {string} props.theme - Theme configuration for styling\n * @param {(id: string) => void} [props.onClick] - Callback function when an item is clicked\n * @param {number} [props.activeItemIndex] - Index of the currently active item\n * @param {boolean} [props.multiSelectable=false] - Enable multi-select functionality\n * @returns {JSX.Element} Rendered list component\n */\nconst List: FunctionComponent<ListModel> = ({\n  items,\n  theme,\n  onClick,\n  activeItemIndex,\n  multiSelectable = false,\n}) => {\n  /**\n   * Memoized list items with generated unique IDs\n   */\n  const listItems = useMemo(\n    () => items.map((item) => ({ ...item, id: item.id || getUniqueID() })),\n    [items],\n  );\n\n  /**\n   * Initialize roving tabindex for keyboard navigation (WCAG 2.1.1: Keyboard)\n   * Supports ARIA Menu pattern: Up/Down arrows navigate, Enter selects\n   */\n  const rovingItems = useMemo(\n    () => listItems.map((item) => ({ id: item.id, disabled: false })),\n    [listItems],\n  );\n\n  const { getItemProps } = useRovingTabIndex({\n    items: rovingItems,\n    orientation: 'vertical',\n    loop: true, // Circular navigation within menu\n  });\n\n  /**\n   * Handles item selection and triggers appropriate callbacks\n   * @param {string} id - Item identifier\n   * @param {EnhancedListItem} item - Selected list item\n   */\n  const handleItemSelection = useCallback(\n    (id: string, item: EnhancedListItem) => {\n      if (multiSelectable && item.onSelect) {\n        startTransition(() => {\n          item.onSelect?.();\n        });\n      } else {\n        onClick?.(id);\n      }\n    },\n    [multiSelectable, onClick],\n  );\n\n  /**\n   * Prevent arrow key and Home/End events from bubbling to parent (e.g., timeline)\n   * @param {React.KeyboardEvent} e - Keyboard event\n   */\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    // Stop propagation for menu navigation keys to prevent timeline from capturing them\n    // Includes arrow keys, Home/End for first/last items, Enter/Space for selection\n    if (['ArrowUp', 'ArrowDown', 'Home', 'End', 'Enter', ' '].includes(e.key)) {\n      e.stopPropagation();\n    }\n  }, []);\n\n  /**\n   * Renders individual list items with proper props\n   * @param {EnhancedListItem} item - Item to render\n   * @param {number} index - Item index in the list\n   * @returns {JSX.Element} Rendered list item\n   */\n  const renderListItem = useCallback(\n    (item: EnhancedListItem, index: number) => {\n      return (\n        <ListItem\n          key={item.id}\n          {...item}\n          theme={theme || defaultTheme}\n          onClick={() => handleItemSelection(item.id, item)}\n          selectable={multiSelectable}\n          active={activeItemIndex === index}\n          rovingProps={getItemProps(item.id) as any}\n        />\n      );\n    },\n    [\n      theme,\n      handleItemSelection,\n      multiSelectable,\n      activeItemIndex,\n      getItemProps,\n    ],\n  );\n\n  return (\n    <ul className={list} role=\"menu\" onKeyDown={handleKeyDown}>\n      {listItems.map(renderListItem)}\n    </ul>\n  );\n};\n\nexport { List };\n","import React, {\n  FunctionComponent,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useMemo,\n  memo,\n  useState,\n  Children,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport useOutsideClick from '@hooks/useOutsideClick';\nimport useEscapeKey from '@hooks/useEscapeKey';\nimport { ChevronDown, CloseIcon } from '@components/icons';\nimport { useFocusTrap } from '@hooks/useFocusManager';\nimport { PopOverModel } from './popover.model';\nimport {\n  closeButton,\n  content,\n  header,\n  popoverHolder,\n  popoverWrapper,\n  selecter,\n  selecterIcon,\n  selecterIconOpen,\n  selecterLabel,\n} from './popover.css';\nimport { popoverHolderRecipe } from './popover.css';\nimport { computeCssVarsFromTheme } from '../../../styles/theme-bridge';\n\n// Memoized content wrapper applying the class from CSS module\nconst MemoizedContent = memo(({ children }: { children: React.ReactNode }) => (\n  <div className={content}>{children}</div>\n));\n\n/**\n * A customizable popover component that displays content in a floating panel\n * @param {PopOverModel} props - Component props\n * @returns {JSX.Element} PopOver component\n */\nconst PopOver: FunctionComponent<PopOverModel> = ({\n  children,\n  position,\n  placeholder,\n  theme,\n  width = 350,\n  isDarkMode = false,\n  icon,\n  $isMobile = false,\n  onItemSelect,\n}) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const triggerButtonRef = useRef<HTMLButtonElement>(null);\n  const popoverRef = useRef<HTMLDivElement>(null);\n  const closeReasonRef = useRef<'escape' | 'click-outside' | null>(null);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [popoverLayout, setPopoverLayout] = useState({\n    position: { top: 0, left: 0, width: 0 },\n    horizontalPosition: 'center' as 'left' | 'right' | 'center',\n  });\n  const [portalContainer, setPortalContainer] = useState<HTMLElement>(\n    document.body,\n  );\n\n  // Focus trap DISABLED for dropdown menu pattern (WCAG 2.4.3)\n  // Dropdown menus should allow Tab to exit naturally to next toolbar element\n  // Focus trap is only appropriate for modal dialogs, not menu popups\n  // const focusTrapRef = useFocusTrap(isOpen);\n  const focusTrapRef = useRef<HTMLElement | null>(null);\n\n  // Memoize theme CSS variables to prevent recalculation on every render\n  const themeCssVars = useMemo(() => computeCssVarsFromTheme(theme), [theme]);\n\n  // Get the current fullscreen element (with vendor prefix support)\n  const getFullscreenElement = useCallback((): HTMLElement | null => {\n    if (typeof document === 'undefined') return null;\n\n    const doc = document as Document & {\n      fullscreenElement?: Element;\n      webkitFullscreenElement?: Element;\n      mozFullScreenElement?: Element;\n      msFullscreenElement?: Element;\n    };\n\n    const fullscreenEl =\n      doc.fullscreenElement ||\n      doc.webkitFullscreenElement ||\n      doc.mozFullScreenElement ||\n      doc.msFullscreenElement ||\n      null;\n\n    return fullscreenEl as HTMLElement | null;\n  }, []);\n\n  // Update portal container when fullscreen state changes\n  useEffect(() => {\n    const updatePortalContainer = () => {\n      const fullscreenEl = getFullscreenElement();\n      setPortalContainer(fullscreenEl || document.body);\n    };\n\n    // Update immediately\n    updatePortalContainer();\n\n    // Listen for fullscreen changes\n    const events = [\n      'fullscreenchange',\n      'webkitfullscreenchange',\n      'mozfullscreenchange',\n      'msfullscreenchange',\n    ];\n\n    events.forEach((event) => {\n      document.addEventListener(event, updatePortalContainer);\n    });\n\n    return () => {\n      events.forEach((event) => {\n        document.removeEventListener(event, updatePortalContainer);\n      });\n    };\n  }, [getFullscreenElement]);\n\n  const toggleOpen = useCallback(() => {\n    setIsOpen((prev) => !prev);\n  }, []);\n\n  const closePopover = useCallback(\n    (closeReason: 'escape' | 'click-outside' = 'click-outside') => {\n      setIsOpen(false);\n      closeReasonRef.current = closeReason;\n\n      // IMPROVED: Selective focus restoration (WCAG 2.4.3: Focus Order)\n      // Only restore focus when closing via Escape key\n      // When user clicks outside, leave focus where they clicked\n\n      requestAnimationFrame(() => {\n        // Only restore focus if explicitly closed via Escape key\n        if (closeReason === 'escape' && triggerButtonRef.current) {\n          try {\n            triggerButtonRef.current.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n      });\n    },\n    [],\n  );\n\n  /**\n   * Handle menu item selection - close popover and restore focus\n   * This is called when a menu item is selected via Enter/Space\n   * @param {string} itemId - The selected item ID\n   */\n  const handleItemSelect = useCallback(\n    (itemId: string) => {\n      // Call parent's onItemSelect callback if provided\n      onItemSelect?.(itemId);\n\n      // Close popover (handles focus restoration via closePopover)\n      closePopover();\n    },\n    [onItemSelect, closePopover],\n  );\n\n  const handleKeyPress = useCallback(\n    (ev: React.KeyboardEvent) => {\n      if (ev.key === 'Enter' || ev.key === ' ') {\n        ev.preventDefault();\n        toggleOpen();\n      } else if (ev.key === 'ArrowDown') {\n        // Arrow Down: Open menu and focus first item\n        ev.preventDefault();\n        ev.stopPropagation(); // Prevent timeline navigation from receiving this event\n        setIsOpen(true);\n\n        // Focus first menu item after menu opens\n        requestAnimationFrame(() => {\n          if (!popoverRef.current) return;\n          const firstMenuItem =\n            popoverRef.current.querySelector('[role=\"menuitem\"]');\n          if (firstMenuItem instanceof HTMLElement) {\n            firstMenuItem.focus();\n            return;\n          }\n          // Fallback: focus first focusable element\n          const firstFocusable = popoverRef.current.querySelector(\n            'button:not([tabindex=\"-1\"]), [tabindex=\"0\"]',\n          );\n          if (firstFocusable instanceof HTMLElement) {\n            firstFocusable.focus();\n          }\n        });\n      } else if (ev.key === 'ArrowUp') {\n        // Arrow Up: Open menu and focus last item\n        ev.preventDefault();\n        ev.stopPropagation(); // Prevent timeline navigation from receiving this event\n        setIsOpen(true);\n\n        // Focus last menu item after menu opens\n        requestAnimationFrame(() => {\n          if (!popoverRef.current) return;\n          const menuItems =\n            popoverRef.current.querySelectorAll('[role=\"menuitem\"]');\n          if (menuItems.length > 0) {\n            const lastMenuItem = menuItems[menuItems.length - 1];\n            if (lastMenuItem instanceof HTMLElement) {\n              lastMenuItem.focus();\n              return;\n            }\n          }\n          // Fallback: focus last focusable element\n          const focusableElements = popoverRef.current.querySelectorAll(\n            'button:not([tabindex=\"-1\"]), [tabindex=\"0\"]',\n          );\n          if (focusableElements.length > 0) {\n            const lastFocusable =\n              focusableElements[focusableElements.length - 1];\n            if (lastFocusable instanceof HTMLElement) {\n              lastFocusable.focus();\n            }\n          }\n        });\n      }\n    },\n    [toggleOpen],\n  );\n\n  // Handle click outside to close popover with 'click-outside' reason (WCAG 2.1.2)\n  useOutsideClick(ref, () => closePopover('click-outside'));\n\n  // Handle Escape key to close popover with 'escape' reason (WCAG 2.1.2)\n  useEscapeKey(() => closePopover('escape'));\n\n  // Calculate optimal positioning for portal rendering\n  const calculatePopoverPosition = useCallback(() => {\n    if (!ref.current) return;\n\n    const triggerRect = ref.current.getBoundingClientRect();\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const popoverWidth = $isMobile ? Math.min(320, viewportWidth * 0.9) : width;\n\n    // Calculate horizontal position - center the popover under the button\n    let left = triggerRect.left;\n    let horizontalPos: 'left' | 'right' | 'center' = 'left';\n\n    if ($isMobile) {\n      // Center on mobile\n      left = (viewportWidth - popoverWidth) / 2;\n      horizontalPos = 'center';\n    } else {\n      // First try to center the popover horizontally under the button\n      const buttonCenterX = triggerRect.left + triggerRect.width / 2;\n      let preferredLeft = buttonCenterX - popoverWidth / 2;\n\n      // Check if the preferred position fits within viewport\n      if (\n        preferredLeft >= 16 &&\n        preferredLeft + popoverWidth <= viewportWidth - 16\n      ) {\n        // Center alignment works\n        left = preferredLeft;\n        horizontalPos = 'center';\n      } else if (triggerRect.left + popoverWidth <= viewportWidth - 16) {\n        // Align with left edge of button\n        left = triggerRect.left;\n        horizontalPos = 'left';\n      } else if (triggerRect.right - popoverWidth >= 16) {\n        // Align with right edge of button\n        left = triggerRect.right - popoverWidth;\n        horizontalPos = 'right';\n      } else {\n        // Fallback: fit within viewport\n        left = Math.max(\n          16,\n          Math.min(triggerRect.left, viewportWidth - popoverWidth - 16),\n        );\n        horizontalPos = 'left';\n      }\n    }\n\n    // Calculate vertical position - directly below the button\n    const gap = 8; // Smaller gap for tighter positioning\n    let top = triggerRect.bottom + gap;\n\n    // Check if there's enough space below\n    const popoverHeight = 400; // Estimated height\n    const spaceBelow = viewportHeight - triggerRect.bottom - gap;\n    const spaceAbove = triggerRect.top - gap;\n\n    if (spaceBelow < popoverHeight && spaceAbove > popoverHeight) {\n      // Position above if not enough space below\n      top = triggerRect.top - popoverHeight - gap;\n    } else {\n      // Keep below, but ensure it doesn't go off-screen\n      top = Math.min(top, viewportHeight - popoverHeight - 16);\n    }\n\n    // Ensure minimum distance from viewport edge\n    top = Math.max(16, top);\n\n    // Combine state updates to prevent double re-render\n    setPopoverLayout({\n      position: { top, left, width: popoverWidth },\n      horizontalPosition: horizontalPos,\n    });\n  }, [width, $isMobile, position]);\n\n  // Position calculation on layout changes and scroll/resize\n  useLayoutEffect(() => {\n    if (isOpen) {\n      calculatePopoverPosition();\n    }\n  }, [isOpen, calculatePopoverPosition]);\n\n  // Recalculate position on scroll or resize with RAF-based throttling\n  useEffect(() => {\n    if (!isOpen) return;\n\n    // Use RAF to throttle position recalculation and prevent layout thrashing\n    let rafId: number | null = null;\n    const handlePositionUpdate = () => {\n      if (rafId !== null) return; // Skip if RAF already scheduled\n\n      rafId = requestAnimationFrame(() => {\n        calculatePopoverPosition();\n        rafId = null;\n      });\n    };\n\n    window.addEventListener('scroll', handlePositionUpdate, { passive: true });\n    window.addEventListener('resize', handlePositionUpdate, { passive: true });\n\n    return () => {\n      if (rafId !== null) cancelAnimationFrame(rafId);\n      window.removeEventListener('scroll', handlePositionUpdate);\n      window.removeEventListener('resize', handlePositionUpdate);\n    };\n  }, [isOpen, calculatePopoverPosition]);\n\n  // Handle fade in/out animations with CSS\n  // Use RAF to ensure state change is applied to DOM before CSS animation plays\n  useEffect(() => {\n    if (isOpen) {\n      // Fade in: trigger animation with RAF to ensure DOM is ready\n      requestAnimationFrame(() => {\n        setIsVisible(true);\n      });\n    } else {\n      // Fade out: CSS animation plays naturally while portal stays in DOM\n      // Then isVisible becomes false, triggering opacity transition\n      setIsVisible(false);\n    }\n  }, [isOpen]);\n\n  // AUTO-FOCUS DISABLED for natural keyboard navigation (WCAG 2.4.3: Focus Order)\n  // Per ARIA Authoring Practices, dropdown menu buttons should:\n  // 1. Keep focus on trigger button when opened via mouse click\n  // 2. Only move focus to first item when opened via Arrow Down key\n  // 3. Allow Tab key to move to next toolbar element (not trap focus)\n  // This preserves natural tab order and prevents unexpected focus stealing\n  //\n  // If auto-focus is needed in specific cases, implement via parent component\n  // using the onItemSelect callback or custom keyboard handler\n\n  // useEffect(() => {\n  //   if (!isOpen || !popoverRef.current) return;\n  //   const rafId = requestAnimationFrame(() => {\n  //     if (!popoverRef.current) return;\n  //     const firstMenuItem = popoverRef.current.querySelector('[role=\"menuitem\"]');\n  //     if (firstMenuItem instanceof HTMLElement) {\n  //       firstMenuItem.focus();\n  //       return;\n  //     }\n  //     const firstFocusable = popoverRef.current.querySelector(\n  //       'button:not([tabindex=\"-1\"]), [tabindex=\"0\"]'\n  //     );\n  //     if (firstFocusable instanceof HTMLElement) {\n  //       firstFocusable.focus();\n  //     }\n  //   });\n  //   return () => cancelAnimationFrame(rafId);\n  // }, [isOpen]);\n\n  /**\n   * Wrap children to intercept onClick for non-multiSelectable lists\n   * For multiSelectable lists, popover stays open to allow multiple selections\n   * and closes via Escape key or click outside\n   */\n  const wrappedChildren = useMemo(\n    () =>\n      Children.map(children, (child) => {\n        if (!React.isValidElement(child)) return child;\n        const typedChild = child as React.ReactElement<{\n          onClick?: (id?: string) => void;\n          multiSelectable?: boolean;\n          [key: string]: unknown;\n        }>;\n\n        // Check if this is a List component with onClick (non-multiSelectable)\n        const hasOnClick = !!typedChild.props?.onClick;\n        const isMultiSelectable = !!typedChild.props?.multiSelectable;\n\n        // Only wrap onClick for non-multiSelectable lists to avoid infinite loops\n        // MultiSelectable lists keep popover open for multiple selections\n        if (hasOnClick && !isMultiSelectable) {\n          return React.cloneElement(typedChild, {\n            onClick: (id?: string) => {\n              // Call original onClick\n              typedChild.props.onClick?.(id);\n              // Close popover after selection\n              if (id) {\n                handleItemSelect(id);\n              }\n            },\n          });\n        }\n\n        // Return unmodified for multiSelectable lists\n        return typedChild;\n      }),\n    [children, handleItemSelect],\n  );\n\n  return (\n    <>\n      <div className={popoverWrapper} ref={ref}>\n        <button\n          id=\"popover-trigger\"\n          type=\"button\"\n          onClick={toggleOpen}\n          onKeyDown={handleKeyPress}\n          title={placeholder}\n          className={selecter}\n          style={themeCssVars}\n          aria-expanded={isOpen}\n          aria-haspopup=\"menu\"\n          aria-label={placeholder || 'Open menu'}\n          tabIndex={0}\n          ref={triggerButtonRef}\n        >\n          {placeholder && <span className={selecterLabel}>{placeholder}</span>}\n          <span\n            className={[selecterIcon, isOpen ? selecterIconOpen : ''].join(' ')}\n          >\n            {icon || <ChevronDown />}\n          </span>\n        </button>\n        {ReactDOM.createPortal(\n          <div\n            ref={(el) => {\n              // Combine focus trap ref with popover ref\n              popoverRef.current = el;\n              if (focusTrapRef.current !== el) {\n                focusTrapRef.current = el;\n              }\n            }}\n            className={[\n              popoverHolder,\n              popoverHolderRecipe({\n                visible: isVisible,\n                position: position === 'bottom' ? 'bottom' : 'top',\n                leftMobile: !!$isMobile,\n              }),\n            ].join(' ')}\n            style={{\n              ...themeCssVars,\n              width: `${popoverLayout.position.width}px`,\n              position: 'fixed',\n              zIndex: 99999,\n              left: `${popoverLayout.position.left}px`,\n              top: `${popoverLayout.position.top}px`,\n              transform: 'none',\n              // Prevent interaction when popover is not visible (fade-out animation playing)\n              pointerEvents: isVisible ? 'auto' : 'none',\n            }}\n            data-position-x={popoverLayout.horizontalPosition}\n            role=\"menu\"\n            aria-labelledby=\"popover-trigger\"\n          >\n            <div className={header}>\n              <button\n                className={closeButton}\n                onClick={() => closePopover()}\n                type=\"button\"\n                aria-label=\"Close menu\"\n                title=\"Close menu\"\n              >\n                <CloseIcon />\n              </button>\n            </div>\n            <MemoizedContent>{wrappedChildren}</MemoizedContent>\n          </div>,\n          portalContainer,\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default memo(PopOver);\n","import { FunctionComponent, useMemo } from 'react';\nimport { useTimelineContext } from '../contexts';\nimport { List } from '../elements/list/list';\nimport PopOver from '../elements/popover';\nimport { ArrowDownIcon, LayoutIcon, ParaIcon } from '../icons';\nimport {\n  ChangeDensityProp,\n  LayoutSwitcherProp,\n  QuickJumpProp,\n} from './timeline-popover.model';\n\nconst LayoutSwitcher: FunctionComponent<LayoutSwitcherProp> = ({\n  onUpdateTimelineMode,\n  theme,\n  mode,\n  isDarkMode,\n  position,\n  isMobile,\n}: LayoutSwitcherProp) => {\n  const { buttonTexts, showAllCardsHorizontal } = useTimelineContext();\n\n  const LayoutIconMemo = useMemo(() => <LayoutIcon />, []);\n\n  const activeTimelineMode = useMemo(\n    () => mode,\n    [showAllCardsHorizontal, mode],\n  );\n\n  const layoutOptions = useMemo(\n    () => ({\n      alternating: buttonTexts?.changeLayoutOptions?.alternating,\n      horizontal: buttonTexts?.changeLayoutOptions?.horizontal,\n      horizontal_all: buttonTexts?.changeLayoutOptions?.horizontal_all,\n      vertical: buttonTexts?.changeLayoutOptions?.vertical,\n    }),\n    [buttonTexts],\n  );\n\n  const verticalItems = useMemo(\n    () => [\n      {\n        description: layoutOptions.vertical?.helpText || '',\n        id: 'VERTICAL',\n        onSelect: () => onUpdateTimelineMode('VERTICAL'),\n        selected: activeTimelineMode === 'VERTICAL',\n        title: layoutOptions.vertical?.text || 'Vertical',\n      },\n      {\n        description: layoutOptions.alternating?.helpText || '',\n        id: 'VERTICAL_ALTERNATING',\n        onSelect: () => onUpdateTimelineMode('VERTICAL_ALTERNATING'),\n        selected: activeTimelineMode === 'VERTICAL_ALTERNATING',\n        title: layoutOptions.alternating?.text || 'Alternating',\n      },\n    ],\n    [activeTimelineMode, layoutOptions],\n  );\n\n  // horizontal list OF options when the mode is `HORIZONTAL`\n  const horizontalItems = useMemo(\n    () => [\n      {\n        description: layoutOptions.horizontal?.helpText || '',\n        id: 'HORIZONTAL',\n        onSelect: () => {\n          onUpdateTimelineMode('HORIZONTAL');\n        },\n        selected: activeTimelineMode === 'HORIZONTAL',\n        title: layoutOptions.horizontal?.text || 'Horizontal',\n      },\n      {\n        description: layoutOptions.horizontal_all?.helpText || '',\n        id: 'HORIZONTAL_ALL',\n        onSelect: () => {\n          onUpdateTimelineMode('HORIZONTAL_ALL');\n        },\n        selected: activeTimelineMode === 'HORIZONTAL_ALL',\n        title: layoutOptions.horizontal?.text || 'Horizontal All',\n      },\n    ],\n    [activeTimelineMode, layoutOptions],\n  );\n\n  return (\n    <PopOver\n      placeholder={buttonTexts?.changeLayout || 'Change layout'}\n      position={position}\n      theme={theme}\n      isDarkMode={isDarkMode}\n      icon={LayoutIconMemo}\n      $isMobile={isMobile}\n    >\n      <List\n        items={\n          mode === 'HORIZONTAL' || mode === 'HORIZONTAL_ALL'\n            ? horizontalItems\n            : verticalItems\n        }\n        theme={theme}\n        multiSelectable\n      />\n    </PopOver>\n  );\n};\n\nconst QuickJump: FunctionComponent<QuickJumpProp> = ({\n  activeItem,\n  items,\n  theme,\n  onActivateItem,\n  isDarkMode,\n  position,\n  isMobile,\n}: QuickJumpProp) => {\n  const { buttonTexts } = useTimelineContext();\n\n  const ArrowDownIconMemo = useMemo(() => <ArrowDownIcon />, []);\n\n  return (\n    <PopOver\n      placeholder={buttonTexts?.jumpTo || 'Jump to timeline item'}\n      position={position}\n      theme={theme}\n      width={400}\n      isDarkMode={isDarkMode}\n      $isMobile={isMobile}\n      icon={ArrowDownIconMemo}\n    >\n      <List\n        items={items.map((item, index) => ({\n          active: index === activeItem,\n          description: item.description,\n          id: item.id,\n          label: item.title,\n          onSelect: () => {},\n          title: item.title ?? `Item ${index + 1}`,\n        }))}\n        theme={theme}\n        onClick={(id?: string) => id && onActivateItem(id)}\n      />\n    </PopOver>\n  );\n};\n\nconst ChangeDensity: FunctionComponent<ChangeDensityProp> = ({\n  onChange,\n  selectedDensity,\n  theme,\n  isDarkMode,\n  position,\n  isMobile,\n}) => {\n  const { buttonTexts } = useTimelineContext();\n\n  const ParaIconMemo = useMemo(() => <ParaIcon />, []);\n\n  const items = useMemo(\n    () => [\n      {\n        description: 'Show less text',\n        id: 'LOW',\n        onSelect: () => onChange('LOW'),\n        selected: selectedDensity === 'LOW',\n        title: 'Low',\n      },\n      {\n        description: 'Show more text',\n        id: 'HIGH',\n        onSelect: () => onChange('HIGH'),\n        selected: selectedDensity === 'HIGH',\n        title: 'High',\n      },\n    ],\n    [selectedDensity],\n  );\n\n  return (\n    <PopOver\n      placeholder={buttonTexts?.changeDensity || 'Change text density'}\n      theme={theme}\n      isDarkMode={isDarkMode}\n      position={position}\n      $isMobile={isMobile}\n      width={300}\n      icon={ParaIconMemo}\n    >\n      <List items={items} theme={theme} multiSelectable />\n    </PopOver>\n  );\n};\n\nexport { ChangeDensity, LayoutSwitcher, QuickJump };\n","// Import necessary dependencies\nimport React, { FunctionComponent, useMemo } from 'react';\nimport { useTimelineContext } from '../contexts';\nimport Controls from '../timeline-elements/timeline-control/timeline-control';\nimport { FullscreenControl } from '../timeline-elements/fullscreen-control';\nimport { pickDefined } from '../../utils/propUtils';\n// Removed direct styled import; buttons use native <button> with classes now\nimport { ChevronLeft, ChevronRight, CloseIcon } from '../icons';\nimport {\n  ChangeDensity,\n  LayoutSwitcher,\n  QuickJump,\n} from './timeline-popover-elements';\nimport { TimelineToolbarProps } from './timeline-toolbar.model';\nimport { TimelineMode } from '@models/TimelineModel';\nimport {\n  actionGroup as veActionGroup,\n  navigationGroup as veNavigationGroup,\n  searchControls as veSearchControls,\n  searchGroup as veSearchGroup,\n  searchInfo as veSearchInfo,\n  searchInput as veSearchInput,\n  searchWrapper as veSearchWrapper,\n  extraControls as veExtraControls,\n  extraControlChild as veExtraControlChild,\n  toolbarWrapper as veToolbarWrapper,\n  searchButton as veSearchButton,\n  searchButtonIcon as veSearchButtonIcon,\n  hideOnMobile,\n} from '../toolbar/toolbar.css';\n\n// Helper function to convert ReactNode to string safely\nconst getTextFromNode = (\n  content: React.ReactNode | string | undefined,\n): string => {\n  if (content === null || content === undefined) {\n    return '';\n  }\n  if (typeof content === 'string') {\n    return content;\n  }\n  if (typeof content === 'number' || typeof content === 'boolean') {\n    return String(content);\n  }\n  // For any other ReactNode, return empty string\n  return '';\n};\n\n// Define the TimelineToolbar component\nconst TimelineToolbar: FunctionComponent<TimelineToolbarProps> = ({\n  activeTimelineItem,\n  slideShowEnabled,\n  slideShowRunning,\n  flipLayout,\n  toggleDarkMode,\n  onPaused,\n  onFirst,\n  onLast,\n  onNext,\n  onPrevious,\n  onRestartSlideshow,\n  totalItems,\n  items = [],\n  id,\n  onActivateTimelineItem,\n  onUpdateTimelineMode,\n  onUpdateTextContentDensity,\n  mode,\n  searchQuery,\n  onSearchChange,\n  onTriggerSearch,\n  onClearSearch,\n  onNextMatch,\n  onPreviousMatch,\n  totalMatches,\n  currentMatchIndex,\n  onSearchKeyDown,\n  searchInputRef,\n  timelineRef,\n  onEnterFullscreen,\n  onExitFullscreen,\n  onFullscreenError,\n  stickyToolbar,\n}: TimelineToolbarProps) => {\n  // Access the stable and dynamic contexts\n  const {\n    cardLess,\n    enableQuickJump,\n    toolbarPosition,\n    enableLayoutSwitch,\n    buttonTexts,\n    theme,\n    isDarkMode: darkMode,\n    textContentDensity: textDensity,\n    isMobile,\n    textResolver,\n  } = useTimelineContext();\n\n  // Prepare QuickJump items with proper string conversions\n  const quickJumpItems = useMemo(() => {\n    return items.map((item) => ({\n      id: item.id ?? '',\n      title: getTextFromNode(item.title),\n      description: getTextFromNode(item.cardSubtitle),\n      ...pickDefined({\n        active: item.active,\n      }),\n    }));\n  }, [items]);\n\n  // Define methods to determine button state\n  const isLeftDisabled = useMemo(() => {\n    if (flipLayout) {\n      return activeTimelineItem === totalItems - 1;\n    }\n    return activeTimelineItem === 0;\n  }, [flipLayout, activeTimelineItem, totalItems]);\n\n  // Determine if the right arrow should be disabled\n  const isRightDisabled = useMemo(() => {\n    if (flipLayout) {\n      return activeTimelineItem === 0;\n    }\n    return activeTimelineItem === totalItems - 1;\n  }, [flipLayout, activeTimelineItem, totalItems]);\n\n  const hideExtraControls = useMemo(() => {\n    return cardLess || slideShowRunning;\n  }, [cardLess, slideShowRunning]);\n\n  const canShowDensity = useMemo(() => {\n    return items.every((item) => item.cardDetailedText);\n  }, []);\n\n  const handleInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    onSearchChange(event.target.value);\n  };\n\n  // Handle clear search and focus the input\n  const handleClearSearch = () => {\n    onClearSearch();\n    // The focus restoration is now handled in the hook\n  };\n\n  // Add KeyDown handler for Enter key navigation\n  const handleSearchKeyDown = (\n    event: React.KeyboardEvent<HTMLInputElement>,\n  ) => {\n    if (event.key === 'Enter' && totalMatches > 0) {\n      event.preventDefault(); // Prevent potential form submission\n\n      // Navigate to next match - focus restoration is handled in the hook\n      if (onSearchKeyDown) {\n        onSearchKeyDown(event);\n      } else {\n        onNextMatch();\n      }\n    }\n  };\n\n  // Disable search navigation if no matches or slideshow running\n  const disableSearchNav = useMemo(\n    () => totalMatches === 0 || slideShowRunning,\n    [totalMatches, slideShowRunning],\n  );\n\n  // ARIA: tie the input to the live match count\n  const searchInfoId = useMemo(() => {\n    return id ? `timeline-search-info-${id}` : 'timeline-search-info';\n  }, [id]);\n\n  // Render the TimelineToolbar component\n  return (\n    <div\n      className={veToolbarWrapper({ sticky: Boolean(stickyToolbar) })}\n      role=\"toolbar\"\n      aria-label=\"Timeline toolbar with navigation, search, and layout controls\"\n      aria-orientation=\"horizontal\"\n      aria-keyshortcuts=\"Tab to navigate controls sequentially\"\n    >\n      <div\n        className={veNavigationGroup}\n        role=\"group\"\n        aria-label=\"Timeline navigation controls\"\n      >\n        <Controls\n          disableLeft={isLeftDisabled}\n          disableRight={isRightDisabled}\n          id={id}\n          isDark={darkMode}\n          onToggleDarkMode={toggleDarkMode}\n          activeTimelineItem={activeTimelineItem || 0}\n          totalItems={totalItems}\n          {...pickDefined({\n            onFirst,\n            onLast,\n            onNext,\n            onPrevious,\n            onReplay: onRestartSlideshow,\n            slideShowEnabled,\n            slideShowRunning,\n            onPaused,\n          })}\n        />\n      </div>\n      <div\n        className={`${veSearchGroup} ${hideOnMobile}`}\n        role=\"search\"\n        aria-label=\"Timeline search\"\n      >\n        <div className={veSearchWrapper}>\n          <input\n            ref={searchInputRef}\n            type=\"search\"\n            placeholder={textResolver.searchPlaceholder()}\n            value={searchQuery}\n            onChange={handleInputChange}\n            onKeyDown={(event) => {\n              // Support Enter for search/navigation, Shift+Enter for previous, Escape to clear\n              if (event.key === 'Escape') {\n                event.preventDefault();\n                handleClearSearch();\n                return;\n              }\n              if (event.key === 'Enter') {\n                event.preventDefault();\n\n                // First Enter: Trigger search if no results exist yet\n                if (totalMatches === 0 && searchQuery.trim()) {\n                  onTriggerSearch();\n                  return;\n                }\n\n                // Subsequent Enters: Navigate through existing results\n                if (totalMatches > 0) {\n                  if (event.shiftKey) {\n                    onPreviousMatch();\n                  } else {\n                    onNextMatch();\n                  }\n                }\n                return;\n              }\n              handleSearchKeyDown(event);\n            }}\n            aria-label={textResolver.searchAriaLabel()}\n            disabled={slideShowRunning}\n            aria-keyshortcuts=\"Enter Shift+Enter Escape\"\n            aria-describedby={\n              searchQuery && totalMatches > 0 ? searchInfoId : undefined\n            }\n            autoComplete=\"off\"\n            spellCheck=\"false\"\n            className={veSearchInput}\n          />\n          {searchQuery && (\n            <button\n              className={veSearchButton}\n              onClick={handleClearSearch}\n              title={textResolver.clearSearch()}\n              aria-label={textResolver.clearSearch()}\n              type=\"button\"\n            >\n              <span className={veSearchButtonIcon}>\n                <CloseIcon />\n              </span>\n            </button>\n          )}\n          <div\n            className={veSearchControls}\n            role=\"group\"\n            aria-label=\"Search navigation\"\n          >\n            {/* ARIA live region for search match announcements (WCAG 4.1.3: Status Messages) */}\n            <span\n              data-testid=\"search-live-region\"\n              role=\"status\"\n              aria-live=\"polite\"\n              aria-atomic=\"true\"\n              style={{\n                position: 'absolute',\n                width: '1px',\n                height: '1px',\n                padding: 0,\n                margin: -1,\n                overflow: 'hidden',\n                clip: 'rect(0, 0, 0, 0)',\n                whiteSpace: 'nowrap',\n                border: 0,\n              }}\n            />\n            {totalMatches > 0 && (\n              <span\n                id={searchInfoId}\n                role=\"status\"\n                aria-live=\"polite\"\n                aria-atomic=\"true\"\n                className={veSearchInfo}\n                aria-label={`Search result ${currentMatchIndex + 1} of ${totalMatches}`}\n              >\n                {`${currentMatchIndex + 1} / ${totalMatches}`}\n              </span>\n            )}\n            {searchQuery && totalMatches === 0 && (\n              <span\n                role=\"status\"\n                aria-live=\"polite\"\n                aria-atomic=\"true\"\n                style={{\n                  position: 'absolute',\n                  width: 1,\n                  height: 1,\n                  padding: 0,\n                  margin: -1,\n                  overflow: 'hidden',\n                  clip: 'rect(0, 0, 0, 0)',\n                  whiteSpace: 'nowrap',\n                  border: 0,\n                }}\n              >\n                {textResolver.noSearchResults()}\n              </span>\n            )}\n            {searchQuery && (\n              <>\n                <button\n                  className={veSearchButton}\n                  onClick={onPreviousMatch}\n                  title={textResolver.previousMatch()}\n                  aria-label={textResolver.previousMatch()}\n                  aria-controls={searchInfoId}\n                  aria-describedby={totalMatches > 0 ? searchInfoId : undefined}\n                  disabled={disableSearchNav}\n                  type=\"button\"\n                >\n                  <span className={veSearchButtonIcon}>\n                    <ChevronLeft />\n                  </span>\n                </button>\n                <button\n                  className={veSearchButton}\n                  onClick={onNextMatch}\n                  title={textResolver.nextMatch()}\n                  aria-label={textResolver.nextMatch()}\n                  aria-controls={searchInfoId}\n                  aria-describedby={totalMatches > 0 ? searchInfoId : undefined}\n                  disabled={disableSearchNav}\n                  type=\"button\"\n                >\n                  <span className={veSearchButtonIcon}>\n                    <ChevronRight />\n                  </span>\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className={veActionGroup} role=\"group\" aria-label=\"Timeline actions\">\n        <div\n          className={`${veExtraControls} ${hideOnMobile}`}\n          key=\"timeline-extra-controls\"\n          style={{ visibility: hideExtraControls ? 'hidden' : 'visible' }}\n          role=\"group\"\n          aria-label=\"Additional timeline controls\"\n        >\n          <div className={veExtraControlChild} key=\"quick-jump\">\n            {enableQuickJump ? (\n              <QuickJump\n                activeItem={activeTimelineItem ?? 0}\n                isDarkMode={darkMode}\n                items={quickJumpItems}\n                onActivateItem={onActivateTimelineItem}\n                theme={theme}\n                position={toolbarPosition}\n                isMobile={isMobile}\n              />\n            ) : null}\n          </div>\n          <div className={veExtraControlChild} key=\"layout-switcher\">\n            {!cardLess && enableLayoutSwitch ? (\n              <LayoutSwitcher\n                isDarkMode={darkMode}\n                theme={theme}\n                onUpdateTimelineMode={(modeString: string) =>\n                  onUpdateTimelineMode(modeString as TimelineMode)\n                }\n                position={toolbarPosition}\n                isMobile={isMobile}\n                {...pickDefined({\n                  mode,\n                })}\n              />\n            ) : null}\n          </div>\n          {canShowDensity ? (\n            <div className={veExtraControlChild} key=\"change-density\">\n              <ChangeDensity\n                isDarkMode={darkMode}\n                theme={theme}\n                onChange={onUpdateTextContentDensity}\n                position={toolbarPosition}\n                selectedDensity={textDensity}\n                isMobile={isMobile}\n              ></ChangeDensity>\n            </div>\n          ) : null}\n          <div className={veExtraControlChild} key=\"fullscreen-control\">\n            {timelineRef && (\n              <FullscreenControl\n                targetRef={timelineRef}\n                theme={theme}\n                size=\"medium\"\n                disabled={false}\n                {...pickDefined({\n                  onEnterFullscreen,\n                  onExitFullscreen,\n                  onError: onFullscreenError,\n                })}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Export the TimelineToolbar component\nexport { TimelineToolbar };\n","/**\n * Google Fonts integration utilities for React Chrono Timeline\n *\n * Provides a robust, modular system for loading and applying Google Fonts\n * with support for individual font styles (bold, italic) per text element\n */\n\nexport interface FontWeight {\n  100: 'thin';\n  200: 'extra-light';\n  300: 'light';\n  400: 'regular';\n  500: 'medium';\n  600: 'semi-bold';\n  700: 'bold';\n  800: 'extra-bold';\n  900: 'black';\n}\n\nexport interface FontStyle {\n  normal: 'normal';\n  italic: 'italic';\n}\n\nexport type FontWeightValue =\n  | keyof FontWeight\n  | 'thin'\n  | 'extra-light'\n  | 'light'\n  | 'regular'\n  | 'medium'\n  | 'semi-bold'\n  | 'bold'\n  | 'extra-bold'\n  | 'black';\nexport type FontStyleValue = keyof FontStyle | 'normal' | 'italic';\n\n/**\n * Configuration for individual text elements\n */\nexport interface TextElementFont {\n  /** Font weight (100-900 or named weights) */\n  weight?: FontWeightValue;\n  /** Font style (normal or italic) */\n  style?: FontStyleValue;\n  /** Custom font size override */\n  size?: string;\n}\n\n/**\n * Complete Google Fonts configuration for all timeline text elements\n */\nexport interface GoogleFontsConfig {\n  /** Primary font family name from Google Fonts */\n  fontFamily: string;\n\n  /** Font configurations for different text elements */\n  elements?: {\n    /** Timeline item titles */\n    title?: TextElementFont;\n    /** Timeline card titles */\n    cardTitle?: TextElementFont;\n    /** Timeline card subtitles */\n    cardSubtitle?: TextElementFont;\n    /** Timeline card main text content */\n    cardText?: TextElementFont;\n    /** Timeline controls and UI text */\n    controls?: TextElementFont;\n  };\n\n  /** Additional font weights to load (e.g., [400, 700, 'italic']) */\n  weights?: Array<FontWeightValue | FontStyleValue | string>;\n\n  /** Font display strategy for loading */\n  display?: 'auto' | 'block' | 'swap' | 'fallback' | 'optional';\n\n  /** Preconnect to Google Fonts for faster loading */\n  preconnect?: boolean;\n}\n\n/**\n * Internal font weight mapping for URL generation\n */\nconst FONT_WEIGHT_MAP: Record<string, number> = {\n  thin: 100,\n  'extra-light': 200,\n  light: 300,\n  regular: 400,\n  medium: 500,\n  'semi-bold': 600,\n  bold: 700,\n  'extra-bold': 800,\n  black: 900,\n};\n\n/**\n * Normalize font weight to numeric value\n */\nfunction normalizeFontWeight(weight: FontWeightValue): number {\n  if (typeof weight === 'number') {\n    // Ensure weight is within valid range (100-900)\n    return Math.min(900, Math.max(100, Math.round(weight / 100) * 100));\n  }\n  return FONT_WEIGHT_MAP[weight] || 400;\n}\n\n/**\n * Generate Google Fonts URL with specified weights and styles\n */\nfunction generateGoogleFontsUrl(config: GoogleFontsConfig): string {\n  const { fontFamily, weights = [], display = 'swap' } = config;\n\n  // Validate font family\n  if (!fontFamily || fontFamily.trim().length === 0) {\n    throw new Error('Font family name is required');\n  }\n\n  // Collect all required weights and styles\n  const weightSet = new Set<string>();\n\n  // Add base weights\n  weights.forEach((weight) => {\n    if (weight === 'italic') {\n      weightSet.add('400italic');\n    } else if (typeof weight === 'string' && weight.includes('italic')) {\n      weightSet.add(weight);\n    } else {\n      try {\n        const numericWeight = normalizeFontWeight(weight as FontWeightValue);\n        weightSet.add(numericWeight.toString());\n      } catch {\n        // Invalid weight, skip it\n        console.warn(`Invalid font weight: ${weight}`);\n      }\n    }\n  });\n\n  // Add weights from element configurations\n  if (config.elements) {\n    Object.values(config.elements).forEach((element) => {\n      if (element?.weight) {\n        try {\n          const numericWeight = normalizeFontWeight(element.weight);\n          const suffix = element.style === 'italic' ? 'italic' : '';\n          weightSet.add(`${numericWeight}${suffix}`);\n        } catch {\n          console.warn(`Invalid element font weight: ${element.weight}`);\n        }\n      }\n      if (element?.style === 'italic' && !element?.weight) {\n        weightSet.add('400italic');\n      }\n    });\n  }\n\n  // Default weights if none specified\n  if (weightSet.size === 0) {\n    weightSet.add('400');\n    weightSet.add('700');\n  }\n\n  const weightsParam = Array.from(weightSet).sort().join(';');\n  const familyParam = encodeURIComponent(fontFamily.replace(/\\s+/g, '+'));\n\n  return `https://fonts.googleapis.com/css2?family=${familyParam}:wght@${weightsParam}&display=${display}`;\n}\n\n/**\n * Load Google Fonts by injecting link tag into document head\n */\nexport function loadGoogleFonts(config: GoogleFontsConfig): Promise<void> {\n  return new Promise((resolve, reject) => {\n    // Check if font is already loaded\n    const fontUrl = generateGoogleFontsUrl(config);\n    const existingLink = Array.from(\n      document.querySelectorAll('link[rel=\"stylesheet\"]'),\n    ).find((link) => (link as HTMLLinkElement).href === fontUrl);\n\n    if (existingLink) {\n      resolve();\n      return;\n    }\n\n    // Add preconnect for faster loading\n    if (config.preconnect !== false) {\n      const preconnect = document.createElement('link');\n      preconnect.rel = 'preconnect';\n      preconnect.href = 'https://fonts.googleapis.com';\n      if (\n        !document.querySelector('link[href=\"https://fonts.googleapis.com\"]')\n      ) {\n        document.head.appendChild(preconnect);\n      }\n\n      const preconnectStatic = document.createElement('link');\n      preconnectStatic.rel = 'preconnect';\n      preconnectStatic.href = 'https://fonts.gstatic.com';\n      preconnectStatic.crossOrigin = 'anonymous';\n      if (!document.querySelector('link[href=\"https://fonts.gstatic.com\"]')) {\n        document.head.appendChild(preconnectStatic);\n      }\n    }\n\n    // Create and load font link\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = fontUrl;\n\n    link.onload = () => resolve();\n    link.onerror = () =>\n      reject(new Error(`Failed to load Google Font: ${config.fontFamily}`));\n\n    document.head.appendChild(link);\n  });\n}\n\n/**\n * Generate CSS custom properties for font configuration\n */\nexport function generateFontCssVars(\n  config: GoogleFontsConfig,\n): Record<string, string> {\n  const cssVars: Record<string, string> = {};\n\n  // Set base font family\n  cssVars['--timeline-font-family'] =\n    `\"${config.fontFamily}\", system-ui, ui-sans-serif, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif`;\n\n  // Set element-specific font properties\n  if (config.elements) {\n    Object.entries(config.elements).forEach(([elementType, elementConfig]) => {\n      const prefix = `--timeline-${elementType}`;\n\n      // Set element-specific font family (inherits from base font family)\n      cssVars[`${prefix}-font-family`] =\n        cssVars['--timeline-font-family'] || '';\n\n      if (elementConfig.weight) {\n        const numericWeight = normalizeFontWeight(elementConfig.weight);\n        cssVars[`${prefix}-font-weight`] = numericWeight.toString();\n      }\n\n      if (elementConfig.style) {\n        cssVars[`${prefix}-font-style`] = elementConfig.style;\n      }\n\n      if (elementConfig.size) {\n        cssVars[`${prefix}-font-size`] = elementConfig.size;\n      }\n    });\n  }\n\n  return cssVars;\n}\n\n/**\n * Generate vanilla-extract compatible font styles\n */\nexport function generateVanillaExtractStyles(config: GoogleFontsConfig) {\n  const baseStyle = {\n    fontFamily: `\"${config.fontFamily}\", system-ui, ui-sans-serif, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif`,\n  };\n\n  const elementStyles: Record<string, any> = {};\n\n  if (config.elements) {\n    Object.entries(config.elements).forEach(([elementType, elementConfig]) => {\n      elementStyles[elementType] = {\n        ...baseStyle,\n        ...(elementConfig.weight && {\n          fontWeight: normalizeFontWeight(elementConfig.weight),\n        }),\n        ...(elementConfig.style && {\n          fontStyle: elementConfig.style,\n        }),\n        ...(elementConfig.size && {\n          fontSize: elementConfig.size,\n        }),\n      };\n    });\n  }\n\n  return {\n    base: baseStyle,\n    elements: elementStyles,\n  };\n}\n\n/**\n * Hook for using Google Fonts in React components\n */\nexport function useGoogleFonts(config: GoogleFontsConfig) {\n  const [loaded, setLoaded] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n\n  React.useEffect(() => {\n    loadGoogleFonts(config)\n      .then(() => {\n        setLoaded(true);\n        setError(null);\n      })\n      .catch((err) => {\n        setError(err.message);\n        setLoaded(false);\n      });\n  }, [config]);\n\n  const cssVars = React.useMemo(() => generateFontCssVars(config), [config]);\n\n  const styles = React.useMemo(\n    () => generateVanillaExtractStyles(config),\n    [config],\n  );\n\n  return { loaded, error, cssVars, styles };\n}\n\n// Re-export React for the hook\nimport React from 'react';\n","/**\n * FontProvider component for Google Fonts integration\n *\n * Handles loading Google Fonts and providing font styles via CSS custom properties\n */\n\nimport React, { useEffect, useState, useMemo } from 'react';\nimport {\n  GoogleFontsConfig,\n  loadGoogleFonts,\n  generateFontCssVars,\n} from './google-fonts';\n\ninterface FontProviderProps {\n  children: React.ReactNode;\n  googleFonts?: GoogleFontsConfig;\n  className?: string;\n}\n\n/**\n * FontProvider component that loads Google Fonts and applies font styles\n */\nexport const FontProvider: React.FC<FontProviderProps> = ({\n  children,\n  googleFonts,\n  className = '',\n}) => {\n  const [fontLoaded, setFontLoaded] = useState(false);\n  const [fontError, setFontError] = useState<string | null>(null);\n\n  // Load Google Fonts when config changes\n  useEffect(() => {\n    if (!googleFonts) {\n      setFontLoaded(true);\n      return;\n    }\n\n    setFontLoaded(false);\n    setFontError(null);\n\n    loadGoogleFonts(googleFonts)\n      .then(() => {\n        setFontLoaded(true);\n      })\n      .catch((error) => {\n        setFontError(error.message);\n        setFontLoaded(true); // Still render children with fallback fonts\n        console.warn('Failed to load Google Fonts:', error);\n      });\n  }, [googleFonts]);\n\n  // Generate CSS custom properties\n  const cssVars = useMemo(() => {\n    if (!googleFonts || !fontLoaded) return {};\n    return generateFontCssVars(googleFonts);\n  }, [googleFonts, fontLoaded]);\n\n  // Apply CSS variables to the document root instead of wrapper\n  useEffect(() => {\n    if (!fontLoaded || !cssVars || Object.keys(cssVars).length === 0) {\n      return;\n    }\n\n    // Set CSS custom properties on document root\n    Object.entries(cssVars).forEach(([property, value]) => {\n      document.documentElement.style.setProperty(property, value);\n    });\n\n    // Cleanup function to remove CSS variables\n    return () => {\n      Object.keys(cssVars).forEach((property) => {\n        document.documentElement.style.removeProperty(property);\n      });\n    };\n  }, [cssVars, fontLoaded]);\n\n  const containerStyle = useMemo(() => {\n    return {\n      // Provide fallback fonts while loading\n      fontFamily: googleFonts?.fontFamily\n        ? `\"${googleFonts.fontFamily}\", system-ui, ui-sans-serif, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif`\n        : undefined,\n    };\n  }, [googleFonts]);\n\n  return (\n    <div\n      className={`timeline-font-provider ${className}`}\n      style={containerStyle}\n      data-font-loaded={fontLoaded}\n      data-font-error={!!fontError}\n    >\n      {children}\n    </div>\n  );\n};\n\n/**\n * Hook to access font loading state\n */\nexport const useFontState = () => {\n  // This could be enhanced to use context if needed\n  return {\n    loaded: true, // Simplified for now\n    error: null,\n  };\n};\n","import { TitleModel } from '@models/TimelineCardTitleModel';\nimport cls from 'classnames';\nimport React, { useMemo } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport { titleActive, titleWrapper } from './timeline-card-title.css';\nimport { cardTitleRecipe } from '../timeline-card-content/timeline-card-content.css';\n\n/**\n * TimelineItemTitle component\n * This component renders the title of a timeline item and applies appropriate styling based on the given props.\n *\n * @property {string | ReactNode} title - The text or JSX element of the title.\n * @property {boolean} active - Indicates whether the title is active or not.\n * @property {Theme} theme - The theme object, used for styling.\n * @property {string} align - The alignment of the title.\n * @property {string} classString - Additional CSS classes for the title.\n * @returns {JSX.Element} The TimelineItemTitle component.\n */\nconst TimelineItemTitle: React.FunctionComponent<TitleModel> = ({\n  title,\n  active,\n  theme,\n  align,\n  classString,\n}: TitleModel) => {\n  const { mode } = useTimelineContext();\n  const TITLE_CLASS = 'timeline-item-title'; // Base class name for the title\n\n  // Determine if margin-bottom should be applied (only for horizontal modes)\n  const isHorizontalMode = useMemo(\n    () => mode === 'HORIZONTAL' || mode === 'HORIZONTAL_ALL',\n    [mode],\n  );\n\n  // Computed class name for the title, combining base class, active state, and additional classes\n  const titleClass = useMemo(\n    () =>\n      cls(\n        TITLE_CLASS,\n        active ? 'active' : '',\n        classString,\n        cardTitleRecipe({ active: !!active, hasMarginBottom: isHorizontalMode }),\n        titleWrapper, // Add the base CSS class that includes Google Fonts styling\n      ),\n    [active, classString, isHorizontalMode],\n  );\n\n  return (\n    <div\n      className={titleClass}\n      style={{\n        textAlign: align || undefined,\n        visibility: title ? 'visible' : 'hidden',\n      }}\n      title={typeof title === 'string' ? title : undefined} // Native tooltip for full text on hover\n      data-ve-class={titleWrapper}\n      data-ve-active-class={titleActive}\n    >\n      {title}\n    </div>\n  );\n};\n\nexport default TimelineItemTitle;\n","import { useCallback, useEffect, useMemo, useRef } from 'react';\nimport cls from 'classnames';\nimport { useTimelineContext } from '../../../contexts';\n\ninterface UseTimelineCardProps {\n  active?: boolean;\n  autoScroll?: (params: {\n    pointOffset?: number;\n    contentHeight?: number;\n    contentOffset?: number;\n  }) => void;\n  slideShowRunning?: boolean;\n  cardLess?: boolean;\n  showAllCardsHorizontal?: boolean;\n  id?: string;\n  onClick?: (id?: string) => void;\n  mode?: 'HORIZONTAL' | 'VERTICAL' | 'VERTICAL_ALTERNATING' | 'HORIZONTAL_ALL';\n  position?: 'TOP' | 'BOTTOM';\n  iconChild?: React.ReactNode;\n}\n\nexport const useTimelineCard = ({\n  active,\n  autoScroll,\n  slideShowRunning,\n  cardLess,\n  showAllCardsHorizontal,\n  id,\n  onClick,\n  mode,\n  position,\n  iconChild,\n}: UseTimelineCardProps) => {\n  const circleRef = useRef<HTMLButtonElement>(null);\n  const wrapperRef = useRef<HTMLDivElement>(null);\n  const contentRef = useRef<HTMLDivElement>(null);\n\n  const { disableClickOnCircle, disableInteraction, disableAutoScrollOnClick } =\n    useTimelineContext();\n\n  const handleClick = useCallback(() => {\n    if (\n      !disableClickOnCircle &&\n      !disableInteraction &&\n      !disableAutoScrollOnClick &&\n      onClick &&\n      !slideShowRunning\n    ) {\n      onClick(id);\n    }\n  }, [\n    disableClickOnCircle,\n    disableInteraction,\n    disableAutoScrollOnClick,\n    onClick,\n    slideShowRunning,\n    id,\n  ]);\n\n  useEffect(() => {\n    if (active) {\n      const circle = circleRef.current;\n      const wrapper = wrapperRef.current;\n\n      if (circle && wrapper) {\n        const circleOffsetLeft = circle.offsetLeft;\n        const wrapperOffsetLeft = wrapper.offsetLeft;\n\n        autoScroll?.({\n          pointOffset: circleOffsetLeft + wrapperOffsetLeft,\n        });\n\n        // Bring the timeline point itself to keyboard focus for accessibility\n        requestAnimationFrame(() => {\n          try {\n            circle.focus({ preventScroll: true });\n          } catch (_) {\n            // ignore focus errors\n          }\n        });\n      }\n    }\n  }, [active, autoScroll, mode]);\n\n  const modeLower = useMemo(() => mode?.toLowerCase(), [mode]);\n\n  const containerClass = useMemo(\n    () =>\n      cls(\n        'timeline-horz-card-wrapper',\n        modeLower,\n        position === 'TOP' ? 'bottom' : 'top',\n        showAllCardsHorizontal ? 'show-all' : '',\n      ),\n    [modeLower, position, showAllCardsHorizontal],\n  );\n\n  const titleClass = useMemo(\n    () => cls(modeLower, position),\n    [modeLower, position],\n  );\n\n  const circleClass = useMemo(\n    () =>\n      cls(\n        'timeline-circle',\n        { 'using-icon': !!iconChild },\n        modeLower,\n        active ? 'active' : 'in-active',\n      ),\n    [active, iconChild, modeLower],\n  );\n\n  const canShowTimelineContent = useMemo(() => {\n    // In horizontal_all mode with showAllCardsHorizontal, always show content\n    // In regular horizontal mode, only show content for active items (unless cardLess)\n    const shouldShowContent = showAllCardsHorizontal || (active && !cardLess);\n    return shouldShowContent;\n  }, [active, cardLess, showAllCardsHorizontal]);\n\n  return {\n    circleRef,\n    wrapperRef,\n    contentRef,\n    handleClick,\n    modeLower,\n    containerClass,\n    titleClass,\n    circleClass,\n    canShowTimelineContent,\n  };\n};\n","import React from 'react';\nimport { shapeWrapper, timelinePoint } from './timeline-point.css';\nimport { useTimelineContext } from '../../../contexts';\n\ninterface TimelinePointProps {\n  circleClass: string;\n  handleClick: () => void;\n  circleRef: React.RefObject<HTMLButtonElement>;\n  title?: string;\n  theme?: any;\n  timelinePointDimension?: number;\n  timelinePointShape?: 'circle' | 'square' | 'diamond';\n  iconChild?: React.ReactNode;\n  active?: boolean;\n  disabled?: boolean;\n  itemId?: string;\n}\n\nconst TimelinePoint: React.FC<TimelinePointProps> = ({\n  circleClass,\n  handleClick,\n  circleRef,\n  title,\n  theme,\n  timelinePointDimension,\n  timelinePointShape,\n  iconChild,\n  active = false,\n  disabled = false,\n  itemId,\n}) => {\n  // Get disableTimelinePoint and isDarkMode from context to match vertical timeline behavior\n  const { disableTimelinePoint, isDarkMode } = useTimelineContext();\n\n  // Focus is now handled by useTimelineNavigation hook\n  // Only during keyboard navigation, not toolbar navigation\n\n  const usingIcon = !!iconChild;\n\n  // If timeline points are disabled, don't render anything\n  if (disableTimelinePoint) {\n    return null;\n  }\n\n  return (\n    <div className={shapeWrapper}>\n      <button\n        className={`${circleClass} ${timelinePoint({\n          shape: timelinePointShape,\n          hasIcon: usingIcon,\n          state: active ? 'active' : 'inactive',\n          disabled,\n        })} ${usingIcon ? 'using-icon' : ''} ${active ? 'active' : ''}`}\n        onClick={handleClick}\n        ref={circleRef}\n        data-testid=\"timeline-circle\"\n        data-item-id={itemId}\n        aria-label={title ?? 'Timeline point'}\n        aria-selected={active}\n        aria-disabled={disabled}\n        disabled={disabled}\n        tabIndex={-1}\n        type=\"button\"\n        style={{\n          height: timelinePointDimension\n            ? `${timelinePointDimension}px`\n            : '2rem', // Fallback height to ensure visibility\n          width: timelinePointDimension\n            ? `${timelinePointDimension}px`\n            : '2rem', // Fallback width to ensure visibility\n          background: usingIcon\n            ? theme?.iconBackgroundColor || theme?.primary\n            : active\n              ? theme?.secondary || theme?.primary\n              : theme?.primary || '#2563eb', // Fallback color\n          border: active\n            ? `${timelinePointDimension ? Math.round(timelinePointDimension * 0.2) : 3}px solid ${theme?.primary || '#2563eb'}`\n            : `2px solid ${theme?.primary || '#2563eb'}`, // Fallback border\n          color: theme?.primary || '#2563eb', // Ensure color is set for CSS currentColor\n        }}\n      >\n        {iconChild ?? null}\n      </button>\n    </div>\n  ) as React.ReactElement;\n};\n\nexport default TimelinePoint;\n","/**\n * Shallow comparison utility for objects\n */\nexport function shallowEqual<T extends Record<string, any>>(\n  obj1: T | undefined | null,\n  obj2: T | undefined | null,\n): boolean {\n  // Handle null/undefined cases\n  if (obj1 === obj2) return true;\n  if (!obj1 || !obj2) return false;\n\n  const keys1 = Object.keys(obj1);\n  const keys2 = Object.keys(obj2);\n\n  if (keys1.length !== keys2.length) return false;\n\n  for (const key of keys1) {\n    if (obj1[key] !== obj2[key]) return false;\n  }\n\n  return true;\n}\n\n/**\n * Deep comparison for arrays of simple objects\n */\nexport function arrayEqual<T>(\n  arr1: T[] | undefined | null,\n  arr2: T[] | undefined | null,\n): boolean {\n  if (arr1 === arr2) return true;\n  if (!arr1 || !arr2) return false;\n  if (arr1.length !== arr2.length) return false;\n\n  for (let i = 0; i < arr1.length; i++) {\n    const item1 = arr1[i];\n    const item2 = arr2[i];\n\n    // For objects with id property, compare by id\n    if (typeof item1 === 'object' && item1 !== null && 'id' in item1) {\n      if ((item1 as any).id !== (item2 as any).id) return false;\n    } else if (item1 !== item2) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Comparison for media objects\n */\nexport function mediaEqual(\n  media1: any | undefined,\n  media2: any | undefined,\n): boolean {\n  if (media1 === media2) return true;\n  if (!media1 || !media2) return false;\n\n  // Compare relevant media properties\n  return (\n    media1.source?.url === media2.source?.url &&\n    media1.type === media2.type &&\n    media1.name === media2.name\n  );\n}\n","import { RefObject, useCallback, useEffect, useRef, useState } from 'react';\n\ntype SlideshowHookReturn = {\n  paused: boolean;\n  remainInterval: number;\n  setStartWidth: (width: number) => void;\n  setupTimer: (interval: number) => void;\n  startWidth: number;\n  tryPause: () => void;\n  tryResume: () => void;\n};\n\n/**\n * Custom hook to manage slideshow functionality with pause/resume capabilities\n * Uses requestAnimationFrame for smoother animation performance\n * @param ref - Reference to the HTML element containing the slideshow\n * @param active - Whether the current slide is active\n * @param slideShowActive - Whether the slideshow functionality is enabled\n * @param slideItemDuration - Duration in milliseconds for each slide\n * @param id - Unique identifier for the current slide\n * @param onElapsed - Callback function triggered when slide duration elapses\n * @returns Object containing slideshow control functions and state\n */\nconst useSlideshow = (\n  ref: RefObject<HTMLElement>,\n  active: boolean,\n  slideShowActive: boolean,\n  slideItemDuration: number,\n  id: string,\n  onElapsed?: (id: string) => void,\n): SlideshowHookReturn => {\n  const startTime = useRef<number | null>(null);\n  const timerRef = useRef<number>(0);\n  const rafRef = useRef<number>(0);\n  const [startWidth, setStartWidth] = useState<number>(0);\n  const [paused, setPaused] = useState<boolean>(false);\n  const slideShowElapsed = useRef<number>(0);\n  const [remainInterval, setRemainInterval] = useState<number>(0);\n  const isRunning = useRef<boolean>(false);\n\n  /**\n   * Cleans up timers and animation frames\n   */\n  const cleanupTimer = useCallback(() => {\n    // Clear timeout if exists\n    if (timerRef.current) {\n      window.clearTimeout(timerRef.current);\n      timerRef.current = 0;\n    }\n\n    // Cancel animation frame if exists\n    if (rafRef.current) {\n      window.cancelAnimationFrame(rafRef.current);\n      rafRef.current = 0;\n    }\n\n    isRunning.current = false;\n  }, []);\n\n  /**\n   * Handles timer completion\n   */\n  const handleTimerComplete = useCallback(() => {\n    cleanupTimer();\n    setPaused(true);\n    setStartWidth(0);\n    setRemainInterval(slideItemDuration);\n    if (id && onElapsed) {\n      onElapsed(id);\n    }\n  }, [id, onElapsed, slideItemDuration, cleanupTimer]);\n\n  /**\n   * Sets up a new timer for the slideshow using requestAnimationFrame for smoother animations\n   * @param interval - Duration in milliseconds for the timer\n   */\n  const setupTimer = useCallback(\n    (interval: number) => {\n      if (!slideItemDuration || interval <= 0 || !active || !slideShowActive) {\n        return;\n      }\n\n      cleanupTimer();\n      setRemainInterval(interval);\n      startTime.current = performance.now();\n      setPaused(false);\n      isRunning.current = true;\n\n      // For very short durations, use setTimeout as fallback\n      if (interval < 50) {\n        timerRef.current = window.setTimeout(() => {\n          handleTimerComplete();\n        }, interval);\n        return;\n      }\n\n      // Use requestAnimationFrame for smoother animation\n      const endTime = startTime.current + interval;\n\n      const animationStep = (timestamp: number) => {\n        if (!isRunning.current) return;\n\n        if (timestamp >= endTime) {\n          handleTimerComplete();\n          return;\n        }\n\n        // Continue animation loop\n        rafRef.current = window.requestAnimationFrame(animationStep);\n      };\n\n      rafRef.current = window.requestAnimationFrame(animationStep);\n    },\n    [\n      slideItemDuration,\n      active,\n      slideShowActive,\n      cleanupTimer,\n      handleTimerComplete,\n    ],\n  );\n\n  /**\n   * Pauses the current slideshow if conditions are met\n   */\n  const tryPause = useCallback(() => {\n    if (!active || !slideShowActive) {\n      return;\n    }\n\n    cleanupTimer();\n    setPaused(true);\n\n    if (startTime.current !== null) {\n      const elapsed = performance.now() - startTime.current;\n      slideShowElapsed.current = elapsed;\n    }\n\n    if (ref.current) {\n      setStartWidth(ref.current.clientWidth);\n    }\n  }, [active, slideShowActive, cleanupTimer]);\n\n  /**\n   * Resumes the slideshow if conditions are met\n   */\n  const tryResume = useCallback(() => {\n    if (!active || !slideShowActive || !slideItemDuration) {\n      return;\n    }\n\n    const remainingInterval = slideItemDuration - slideShowElapsed.current;\n    if (remainingInterval > 0) {\n      setPaused(false);\n      setupTimer(remainingInterval);\n    }\n  }, [active, slideShowActive, slideItemDuration, setupTimer]);\n\n  // Auto-start timer when slideshow becomes active\n  useEffect(() => {\n    if (slideShowActive && active && slideItemDuration > 0) {\n      setupTimer(slideItemDuration);\n    } else if (!slideShowActive) {\n      cleanupTimer();\n    }\n    return cleanupTimer;\n  }, [slideShowActive, active, slideItemDuration, setupTimer, cleanupTimer]);\n\n  // Cleanup effect when active state changes\n  useEffect(() => {\n    if (!active) {\n      cleanupTimer();\n    }\n    return () => {\n      // Cleanup when component unmounts or dependencies change\n      cleanupTimer();\n    };\n  }, [active, cleanupTimer]);\n\n  return {\n    paused,\n    remainInterval,\n    setStartWidth,\n    setupTimer,\n    startWidth,\n    tryPause,\n    tryResume,\n  };\n};\n\nexport { useSlideshow };\n","import { MediaState } from '@models/TimelineMediaModel';\nimport { useState, useCallback } from 'react';\n\ninterface UseMediaLoadResult {\n  loadFailed: boolean;\n  mediaLoaded: boolean;\n  handleMediaLoaded: () => void;\n  handleError: () => void;\n}\n\n/**\n * Custom hook to handle media loading state and error handling\n *\n * @param id - The ID of the media element\n * @param onMediaStateChange - Callback to notify parent component of media state changes\n * @returns Object with loading state and handler functions\n */\nexport const useMediaLoad = (\n  id: string,\n  onMediaStateChange: (state: MediaState) => void,\n): UseMediaLoadResult => {\n  const [loadFailed, setLoadFailed] = useState(false);\n  const [mediaLoaded, setMediaLoaded] = useState(false);\n\n  // This function will be invoked when the user has finished loading media\n  const handleMediaLoaded = useCallback(() => {\n    setMediaLoaded(true);\n  }, []);\n\n  // This function handles errors when loading media\n  const handleError = useCallback(() => {\n    setLoadFailed(true);\n    onMediaStateChange({\n      id,\n      paused: false,\n      playing: false,\n    });\n  }, [onMediaStateChange, id]);\n\n  return {\n    loadFailed,\n    mediaLoaded,\n    handleMediaLoaded,\n    handleError,\n  };\n};\n","import { useMemo } from 'react';\n\n/**\n * Custom hook to detect YouTube URLs\n * @param url - The URL to check\n * @returns boolean indicating if the URL is a YouTube URL\n */\nexport const useYouTubeDetection = (url: string) => {\n  return useMemo(\n    () => /^(https?:\\/\\/)?(www\\.youtube\\.com|youtu\\.?be)\\/.+$/.test(url),\n    [url],\n  );\n};\n","import { useCallback, useState } from 'react';\n\n/**\n * Custom hook to handle text display toggle functionality\n * @returns Object with toggle states and functions\n */\nexport const useToggleControls = () => {\n  const [expandDetails, setExpandDetails] = useState(false);\n  const [showText, setShowText] = useState(true);\n\n  const toggleExpand = useCallback(() => {\n    setExpandDetails((prev) => !prev);\n    setShowText(true);\n  }, []);\n\n  const toggleText = useCallback(() => {\n    setExpandDetails(false);\n    setShowText((prev) => !prev);\n  }, []);\n\n  return {\n    expandDetails,\n    showText,\n    toggleExpand,\n    toggleText,\n  };\n};\n","import { ReactNode, useMemo, ForwardRefExoticComponent } from 'react';\nimport { hexToRGBA } from '@utils/index';\nimport { TextOrContentModel } from '../../timeline-card-content/text-or-content';\n\ninterface UseViewOptionsParams {\n  showText: boolean;\n  expandDetails: boolean;\n  textOverlay: boolean;\n  detailsText?: ForwardRefExoticComponent<TextOrContentModel>;\n  title?: ReactNode;\n  content?: ReactNode;\n  theme: any;\n  cardHeight: number | 'auto' | undefined;\n  mediaHeight: number;\n}\n\ninterface UseViewOptionsResult {\n  canShowTextMemo: boolean;\n  canShowTextContent: boolean;\n  canExpand: boolean;\n  gradientColor: string;\n  canShowGradient: boolean;\n  getCardHeight: number | undefined;\n}\n\n/**\n * Custom hook for handling view options and memoized calculated values\n */\nexport const useViewOptions = ({\n  showText,\n  expandDetails,\n  textOverlay,\n  detailsText,\n  title,\n  content,\n  theme,\n  cardHeight,\n  mediaHeight,\n}: UseViewOptionsParams): UseViewOptionsResult => {\n  const canShowTextMemo = useMemo(\n    () => showText && !!detailsText,\n    [showText, detailsText],\n  );\n\n  const canShowTextContent = useMemo(\n    () => !!(title ?? content ?? detailsText),\n    [title, content, detailsText],\n  );\n\n  const canExpand = useMemo(\n    () => textOverlay && !!detailsText,\n    [textOverlay, detailsText],\n  );\n\n  const gradientColor = useMemo(\n    () => hexToRGBA(theme?.cardDetailsBackGround ?? '', 0.8),\n    [theme?.cardDetailsBackGround],\n  );\n\n  const canShowGradient = useMemo(\n    () => !expandDetails && showText && textOverlay,\n    [expandDetails, showText, textOverlay],\n  );\n\n  const getCardHeight = useMemo(() => {\n    // FIX for Issue #498: Handle 'auto' cardHeight\n    const height = textOverlay ? cardHeight : mediaHeight;\n    return height === 'auto' ? undefined : height;\n  }, [textOverlay, cardHeight, mediaHeight]);\n\n  return {\n    canShowTextMemo,\n    canShowTextContent,\n    canExpand,\n    gradientColor,\n    canShowGradient,\n    getCardHeight,\n  };\n};\n","import { memo } from 'react';\nimport { errorMessage } from '../timeline-card-media.css';\n\ninterface ErrorMessageProps {\n  message: string;\n}\n\n/**\n * Displays an error message when media fails to load\n */\nexport const LazyErrorMessage = memo(({ message }: ErrorMessageProps) => (\n  <span className={errorMessage}>{message}</span>\n));\n","import { MediaState } from '@models/TimelineMediaModel';\nimport React, { memo, useEffect, useRef } from 'react';\nimport { cardVideo } from '../timeline-card-media.css';\n\ninterface VideoPlayerProps {\n  url: string;\n  active: boolean;\n  id: string;\n  name: string;\n  onMediaStateChange: (state: MediaState) => void;\n  handleMediaLoaded: () => void;\n  handleError: () => void;\n}\n\n/**\n * Renders a standard video player\n */\nexport const VideoPlayer = memo(\n  ({\n    url,\n    active,\n    id,\n    name,\n    onMediaStateChange,\n    handleMediaLoaded,\n    handleError,\n  }: VideoPlayerProps) => {\n    const videoRef = useRef<HTMLVideoElement>(null);\n\n    useEffect(() => {\n      if (!videoRef.current) return;\n\n      if (active) {\n        videoRef.current.play().catch(() => {\n          // Handle autoplay failure silently\n        });\n      } else {\n        videoRef.current.pause();\n      }\n    }, [active]);\n\n    return (\n      <video\n        className={cardVideo}\n        controls\n        autoPlay={active}\n        ref={videoRef}\n        onLoadedData={handleMediaLoaded}\n        data-testid=\"rc-video\"\n        onPlay={() =>\n          onMediaStateChange({\n            id,\n            paused: false,\n            playing: true,\n          })\n        }\n        onPause={() =>\n          onMediaStateChange({\n            id,\n            paused: true,\n            playing: false,\n          })\n        }\n        onEnded={() =>\n          onMediaStateChange({\n            id,\n            paused: false,\n            playing: false,\n          })\n        }\n        onError={handleError}\n        preload=\"metadata\"\n      >\n        <source src={url}></source>\n      </video>\n    );\n  },\n);\n","import React, { memo } from 'react';\nimport { iframeVideo } from '../timeline-card-media.css';\n\ninterface YoutubePlayerProps {\n  url: string;\n  active: boolean;\n  name: string;\n}\n\n/**\n * Renders a YouTube player iframe\n */\nexport const YoutubePlayer = memo(\n  ({ url, active, name }: YoutubePlayerProps) => (\n    <iframe\n      className={iframeVideo}\n      style={{ border: 'none' }}\n      allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n      allowFullScreen\n      src={`${url}${active ? '?autoplay=1&enablejsapi=1' : '?enablejsapi=1'}`}\n      title={name}\n      data-testid=\"timeline-card-content-video\"\n      loading=\"lazy\"\n    />\n  ),\n);\n","import React, { memo } from 'react';\nimport {\n  cardImage,\n  imageHidden,\n  imageRounded,\n  imageVisible,\n  imageWrapper,\n} from '../timeline-card-media.css';\nimport { TimelineMode } from '@models/TimelineModel';\n\ninterface ImageDisplayProps {\n  url: string;\n  name: string;\n  mode: TimelineMode;\n  mediaLoaded: boolean;\n  borderLessCards: boolean;\n  mediaHeight: number;\n  imageFit?: string;\n  handleMediaLoaded: () => void;\n  handleError: () => void;\n}\n\n/**\n * Renders an image with appropriate loading and error handling\n */\nexport const ImageDisplay = memo(\n  ({\n    url,\n    name,\n    mode,\n    mediaLoaded,\n    borderLessCards,\n    mediaHeight,\n    imageFit,\n    handleMediaLoaded,\n    handleError,\n  }: ImageDisplayProps) => (\n    <div className={imageWrapper} style={{ height: mediaHeight }}>\n      <img\n        className={[\n          cardImage,\n          mediaLoaded ? imageVisible : imageHidden,\n          borderLessCards ? imageRounded : undefined,\n        ]\n          .filter(Boolean)\n          .join(' ')}\n        src={url}\n        onLoad={handleMediaLoaded}\n        onError={handleError}\n        alt={name}\n        loading=\"lazy\"\n        data-testid=\"timeline-card-content-image\"\n        width=\"100%\"\n        height=\"auto\"\n        style={{\n          objectFit: (imageFit as React.CSSProperties['objectFit']) ?? 'cover',\n        }}\n      />\n    </div>\n  ),\n);\n","import { MediaState } from '@models/TimelineMediaModel';\nimport { TimelineMode } from '@models/TimelineModel';\nimport React, { memo } from 'react';\nimport { LazyErrorMessage } from './ErrorMessage';\nimport { VideoPlayer } from './VideoPlayer';\nimport { YoutubePlayer } from './YoutubePlayer';\nimport { ImageDisplay } from './ImageDisplay';\n\ninterface MediaContentProps {\n  media: {\n    type: string;\n    source: {\n      url: string;\n    };\n    name?: string;\n  };\n  isYouTube: boolean;\n  loadFailed: boolean;\n  mediaLoaded: boolean;\n  active: boolean;\n  id: string;\n  mediaHeight: number;\n  mode: TimelineMode;\n  borderLessCards: boolean;\n  mediaSettings: any;\n  handleMediaLoaded: () => void;\n  handleError: () => void;\n  onMediaStateChange: (state: MediaState) => void;\n}\n\n/**\n * Renders the appropriate media content based on type (video, YouTube, image)\n */\nexport const MediaContent = memo(\n  ({\n    media,\n    isYouTube,\n    loadFailed,\n    mediaLoaded,\n    active,\n    id,\n    mediaHeight,\n    mode,\n    borderLessCards,\n    mediaSettings,\n    handleMediaLoaded,\n    handleError,\n    onMediaStateChange,\n  }: MediaContentProps) => {\n    if (media.type === 'VIDEO') {\n      if (isYouTube) {\n        return (\n          <YoutubePlayer\n            url={media.source.url}\n            active={active}\n            name={media.name ?? ''}\n          />\n        );\n      }\n\n      return loadFailed ? (\n        <LazyErrorMessage message=\"Failed to load the video\" />\n      ) : (\n        <VideoPlayer\n          url={media.source.url}\n          active={active}\n          id={id}\n          name={media.name ?? ''}\n          onMediaStateChange={onMediaStateChange}\n          handleMediaLoaded={handleMediaLoaded}\n          handleError={handleError}\n        />\n      );\n    }\n\n    if (media.type === 'IMAGE') {\n      return loadFailed ? (\n        <LazyErrorMessage message=\"Failed to load the image.\" />\n      ) : (\n        <ImageDisplay\n          url={media.source.url}\n          name={media.name ?? ''}\n          mode={mode}\n          mediaLoaded={mediaLoaded}\n          borderLessCards={borderLessCards}\n          mediaHeight={mediaHeight}\n          imageFit={mediaSettings?.fit}\n          handleMediaLoaded={handleMediaLoaded}\n          handleError={handleError}\n        />\n      );\n    }\n\n    return null;\n  },\n);\n","import cls from 'classnames';\nimport React from 'react';\nimport { Title } from './memoized-model';\nimport { useTimelineContext } from '../../contexts';\nimport { titleStyles } from '../../../styles/system/font-styles.css';\n\n/**\n * Renders the timeline's title with optional link using configurable semantic tags.\n * @param {Title} props - Title properties\n * @returns {JSX.Element | null} The rendered title\n */\nconst TitleMemoComponent = ({\n  title,\n  url,\n  theme,\n  color,\n  dir,\n  active,\n  fontSize = '1rem',\n  classString = '',\n}: Title) => {\n  const { semanticTags } = useTimelineContext();\n\n  const Tag: any = semanticTags?.cardTitle ?? 'span';\n\n  return title ? (\n    <Tag\n      className={cls(titleStyles.card, active ? 'active' : '', {\n        [classString]: true,\n      })}\n      style={{ color }}\n      dir={dir}\n      data-class={classString}\n    >\n      {url ? (\n        <a href={url} target=\"_blank\" rel=\"noreferrer\" tabIndex={-1}>\n          {title}\n        </a>\n      ) : (\n        title\n      )}\n    </Tag>\n  ) : null;\n};\n\nexport const TitleMemo = React.memo(TitleMemoComponent);\n\nTitleMemo.displayName = 'Timeline Title';\n","import { button, buttonIcon } from './timeline-card-media-buttons.css';\nimport { buttonWrapper } from './timeline-card-media.css';\n\nexport const ExpandButton = (\n  props: React.PropsWithChildren<React.HTMLAttributes<HTMLButtonElement>>,\n) => (\n  <button className={button} {...props}>\n    <span className={buttonIcon}>{props.children}</span>\n  </button>\n);\n\nexport const ShowHideTextButton = (\n  props: React.PropsWithChildren<React.HTMLAttributes<HTMLButtonElement>>,\n) => (\n  <button className={button} {...props}>\n    <span className={buttonIcon}>{props.children}</span>\n  </button>\n);\n\nexport const ButtonWrapper: React.FC<React.PropsWithChildren<{}>> = ({\n  children,\n}) => <ul className={buttonWrapper}>{children}</ul>;\n","import { memo, useMemo } from 'react';\nimport { MinusIcon, PlusIcon } from '../../icons';\nimport { ShowHideTextButton } from '../timeline-card-media/timeline-card-media-buttons';\nimport { ShowHideTextButtonModel } from './memoized-model';\n\n/**\n * Renders a button to toggle showing or hiding text content.\n * @param {ShowHideTextButtonModel} props - Button properties\n * @returns {JSX.Element | null} The toggle button\n */\nconst ShowOrHideTextButtonMemo = memo<ShowHideTextButtonModel>(\n  ({ textOverlay, onToggle, theme, show }: ShowHideTextButtonModel) => {\n    const label = useMemo(() => {\n      return show ? 'Hide Text' : 'Show Text';\n    }, [show]);\n\n    return textOverlay ? (\n      <ShowHideTextButton\n        onPointerDown={onToggle}\n        tabIndex={0}\n        onKeyDown={(ev) => ev.key === 'Enter' && onToggle?.(ev)}\n        aria-label={label}\n        title={label}\n      >\n        {show ? <MinusIcon /> : <PlusIcon />}\n      </ShowHideTextButton>\n    ) : null;\n  },\n);\n\nShowOrHideTextButtonMemo.displayName = 'Show Hide Text Button';\n\nexport { ShowOrHideTextButtonMemo };\n","import { memo, useMemo } from 'react';\nimport { MaximizeIcon, MinimizeIcon } from '../../icons';\nimport { ExpandButton } from '../timeline-card-media/timeline-card-media-buttons';\nimport { ExpandButtonModel } from './memoized-model';\n\n/**\n * Renders a button to expand or collapse timeline card content.\n * @param {ExpandButtonModel} props - The expand button properties\n * @returns {JSX.Element | null} The expand/collapse button\n */\nconst ExpandButtonMemo = memo<ExpandButtonModel>(\n  ({ theme, expanded, onExpand, textOverlay }: ExpandButtonModel) => {\n    const label = useMemo(() => {\n      return expanded ? 'Minimize' : 'Maximize';\n    }, [expanded]);\n\n    return textOverlay ? (\n      <ExpandButton\n        onPointerDown={onExpand}\n        onKeyDown={(ev) => ev.key === 'Enter' && onExpand?.(ev)}\n        aria-expanded={expanded}\n        tabIndex={0}\n        aria-label={label}\n        title={label}\n      >\n        {expanded ? <MinimizeIcon /> : <MaximizeIcon />}\n      </ExpandButton>\n    ) : null;\n  },\n  (prev, next) => prev.expanded === next.expanded,\n);\n\nExpandButtonMemo.displayName = 'Expand Button';\n\nexport { ExpandButtonMemo };\n","import cls from 'classnames';\nimport React from 'react';\n// Replaced styled component with semantic tag + classes\nimport { Content } from './memoized-model';\nimport { useTimelineContext } from '../../contexts';\nimport { subtitleStyles } from '../../../styles/system/font-styles.css';\n\n/**\n * Renders the subtitle content for the timeline card using configurable semantic tags.\n * @param {Content} props - Subtitle properties\n * @returns {JSX.Element | null} The rendered subtitle\n */\nconst SubTitleMemo = React.memo<Content>(\n  ({ content, color, dir, theme, fontSize, classString, padding }: Content) => {\n    const { semanticTags } = useTimelineContext();\n\n    const Tag: any = semanticTags?.cardSubtitle ?? 'span';\n    return content ? (\n      <Tag\n        style={{ color }}\n        dir={dir}\n        className={cls(subtitleStyles.card, 'card-sub-title', classString)}\n      >\n        {content}\n      </Tag>\n    ) : null;\n  },\n  (prev, next) =>\n    prev.theme?.cardSubtitleColor === next.theme?.cardSubtitleColor,\n);\n\nSubTitleMemo.displayName = 'Timeline Content';\n\nexport { SubTitleMemo };\n","import { memo } from 'react';\nimport { useBackground } from '../../../hooks/useBackground';\nimport { useMeasureHeight } from '../../../hooks/useMeasureHeight';\nimport { detailsTextWrapper } from '../timeline-card-media/timeline-card-media.css';\nimport { DetailsTextMemoModel } from './memoized-model';\nimport { useTimelineContext } from '../../contexts';\n\nconst arePropsEqual = (\n  prev: DetailsTextMemoModel,\n  next: DetailsTextMemoModel,\n): boolean => {\n  return (\n    prev.height === next.height &&\n    prev.show === next.show &&\n    prev.expand === next.expand &&\n    prev.theme?.cardDetailsBackGround === next.theme?.cardDetailsBackGround\n  );\n};\n\nconst DetailsTextMemo = memo<DetailsTextMemoModel>(\n  ({ theme, show, expand, textOverlay, text: Text, onRender }) => {\n    const background = useBackground(theme?.cardDetailsBackGround);\n    const measureRef = useMeasureHeight(onRender);\n\n    if (!textOverlay) return null;\n\n    return (\n      <div\n        ref={measureRef}\n        className={detailsTextWrapper}\n        style={{\n          background,\n          height: show ? '100%' : 0,\n          overflow: expand ? 'auto' : 'hidden',\n        }}\n      >\n        <Text />\n      </div>\n    );\n  },\n  arePropsEqual,\n);\n\nDetailsTextMemo.displayName = 'DetailsText';\n\nexport { DetailsTextMemo };\n","import React, { useRef, ReactNode, useState, useCallback } from 'react';\nimport { assignInlineVars } from '@vanilla-extract/dynamic';\nimport {\n  cardMediaHeader,\n  mediaDetailsWrapper,\n  mediaDetailsAbsolute,\n  mediaDetailsCard,\n  mediaDetailsGradient,\n  mediaDetailsMaximized,\n  mediaDetailsExpanded,\n  readMoreButton,\n} from '../timeline-card-media.css';\nimport { gradientVar } from '../timeline-card-media.css';\nimport { TitleMemo } from '../../memoized/title-memo';\nimport { ButtonWrapper } from '../timeline-card-media-buttons';\nimport { ShowOrHideTextButtonMemo } from '../../memoized/show-hide-button';\nimport { ExpandButtonMemo } from '../../memoized/expand-button-memo';\nimport { SubTitleMemo } from '../../memoized/subtitle-memo';\nimport { DetailsTextMemo } from '../../memoized/details-text-memo';\nimport { TimelineMode } from '@models/TimelineModel';\nimport { pickDefined } from '../../../../utils/propUtils';\n\nexport interface ContentDisplayProps {\n  readonly mode: TimelineMode;\n  readonly textOverlay: boolean;\n  readonly theme: any;\n  readonly expandDetails: boolean;\n  readonly showText: boolean;\n  readonly canExpand: boolean;\n  readonly canShowGradient: boolean;\n  readonly gradientColor: string | null;\n  readonly title?: ReactNode;\n  readonly active: boolean;\n  readonly url?: string;\n  readonly fontSizes: any;\n  readonly classNames: any;\n  readonly toggleText: () => void;\n  readonly toggleExpand: () => void;\n  readonly content?: ReactNode;\n  readonly canShowTextMemo: boolean;\n  readonly detailsText?: any; // Use 'any' to bypass type checking temporarily\n  readonly onDetailsTextRef: (height?: number) => void;\n}\n\nconst ContentDisplayComponent: React.FunctionComponent<ContentDisplayProps> = (\n  props,\n) => {\n  const {\n    mode,\n    textOverlay,\n    theme,\n    expandDetails,\n    showText,\n    canExpand,\n    canShowGradient,\n    gradientColor,\n    title,\n    active,\n    url,\n    fontSizes,\n    classNames,\n    toggleText,\n    toggleExpand,\n    content,\n    canShowTextMemo,\n    detailsText,\n    onDetailsTextRef,\n  } = props;\n\n  const moreRef = useRef<HTMLDivElement>(null);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [showReadMore, setShowReadMore] = useState(false);\n\n  const toggleReadMore = useCallback(\n    (e: React.MouseEvent) => {\n      e.stopPropagation();\n      setIsExpanded(!isExpanded);\n    },\n    [isExpanded],\n  );\n\n  React.useLayoutEffect(() => {\n    if (moreRef.current && textOverlay) {\n      const checkOverflow = () => {\n        if (moreRef.current) {\n          const containerHeight = moreRef.current.clientHeight;\n\n          // Calculate the total height of all children, checking their scrollHeight too\n          let totalChildrenHeight = 0;\n          let hasInternalOverflow = false;\n\n          Array.from(moreRef.current.children).forEach((child) => {\n            const childElement = child as HTMLElement;\n            const childHeight = childElement.offsetHeight;\n            const childScrollHeight = childElement.scrollHeight;\n\n            totalChildrenHeight += childHeight;\n\n            // Check if this child has internal overflow\n            if (childScrollHeight > childHeight) {\n              console.log('Child has internal overflow:', {\n                childTagName: childElement.tagName,\n                childClassName: childElement.className,\n                childHeight,\n                childScrollHeight,\n              });\n              hasInternalOverflow = true;\n            }\n          });\n\n          console.log('Overflow check:', {\n            containerHeight,\n            totalChildrenHeight,\n            hasInternalOverflow,\n            hasOverflow:\n              totalChildrenHeight > containerHeight || hasInternalOverflow,\n            showText,\n            hasDetailsText: !!detailsText,\n            hasContent: !!content,\n            isExpanded,\n          });\n\n          // Check if children exceed container height OR if any child has internal overflow\n          const hasOverflow =\n            totalChildrenHeight > containerHeight + 5 || hasInternalOverflow;\n          if (hasOverflow) {\n            console.log('SETTING SHOW READ MORE TO TRUE');\n            setShowReadMore(true);\n          } else {\n            console.log('SETTING SHOW READ MORE TO FALSE');\n            setShowReadMore(false);\n          }\n        }\n      };\n\n      // Check immediately\n      checkOverflow();\n\n      // Also check after delays to ensure content is rendered\n      const timeoutId1 = setTimeout(checkOverflow, 100);\n      const timeoutId2 = setTimeout(checkOverflow, 300);\n      const timeoutId3 = setTimeout(checkOverflow, 500);\n\n      // Use ResizeObserver to detect when content size changes\n      const resizeObserver = new ResizeObserver(() => {\n        console.log('ResizeObserver triggered');\n        checkOverflow();\n      });\n\n      if (moreRef.current) {\n        resizeObserver.observe(moreRef.current);\n      }\n\n      return () => {\n        clearTimeout(timeoutId1);\n        clearTimeout(timeoutId2);\n        clearTimeout(timeoutId3);\n        resizeObserver.disconnect();\n      };\n    }\n    return undefined;\n  }, [textOverlay, content, detailsText, title, showText, isExpanded]);\n\n  return (\n    <div\n      ref={moreRef}\n      className={[\n        mediaDetailsWrapper,\n        textOverlay ? mediaDetailsAbsolute : undefined,\n        canExpand || !showText ? mediaDetailsCard : undefined,\n        canShowGradient ? mediaDetailsGradient : undefined,\n        textOverlay && !isExpanded ? mediaDetailsMaximized : undefined,\n        textOverlay && isExpanded ? mediaDetailsExpanded : undefined,\n      ]\n        .filter(Boolean)\n        .join(' ')}\n      style={\n        canShowGradient && gradientColor\n          ? assignInlineVars({ [gradientVar]: gradientColor })\n          : undefined\n      }\n    >\n      <div className={cardMediaHeader}>\n        <TitleMemo\n          title={title}\n          theme={theme}\n          active={active}\n          url={url ?? ''}\n          fontSize={fontSizes?.cardTitle}\n          classString={classNames?.cardTitle}\n          {...pickDefined({\n            color: theme?.cardTitleColor || theme?.titleColor,\n          })}\n        />\n        {canExpand && !textOverlay && (\n          <ButtonWrapper>\n            <ShowOrHideTextButtonMemo\n              onToggle={toggleText}\n              show={showText}\n              textOverlay\n              theme={theme}\n            />\n            <ExpandButtonMemo\n              theme={theme}\n              expanded={expandDetails}\n              onExpand={toggleExpand}\n              textOverlay\n            />\n          </ButtonWrapper>\n        )}\n      </div>\n      {showText && (\n        <SubTitleMemo\n          content={content}\n          fontSize={fontSizes?.cardSubtitle}\n          classString={classNames?.cardSubTitle}\n          padding\n          theme={theme}\n          {...pickDefined({\n            color: theme?.cardSubtitleColor,\n          })}\n        />\n      )}\n      {canShowTextMemo && detailsText && (\n        <DetailsTextMemo\n          theme={theme}\n          show={showText}\n          expand={textOverlay ? isExpanded : expandDetails}\n          text={detailsText}\n          onRender={onDetailsTextRef}\n          textOverlay={textOverlay}\n        />\n      )}\n      {textOverlay && showReadMore && (\n        <button\n          className={readMoreButton}\n          onClick={toggleReadMore}\n          type=\"button\"\n        >\n          {isExpanded ? 'Read Less' : 'Read More'}\n        </button>\n      )}\n    </div>\n  ) as React.ReactElement;\n};\n\n// Export the memoized component\nexport const ContentDisplay = ContentDisplayComponent;\n\n// Add display name for DevTools\nContentDisplay.displayName = 'ContentDisplay';\n","import { CardMediaModel } from '@models/TimelineMediaModel';\nimport cls from 'classnames';\nimport React, { memo, useCallback } from 'react';\nimport { mediaEqual } from '@utils/comparison';\nimport { useTimelineContext } from '../../contexts';\nimport {\n  mediaWrapper,\n  justifyEnd,\n  justifyStart,\n} from './timeline-card-media.css';\nimport { useMediaLoad } from './hooks/useMediaLoad';\nimport { useYouTubeDetection } from './hooks/useYouTubeDetection';\nimport { useToggleControls } from './hooks/useToggleControls';\nimport { useViewOptions } from './hooks/useViewOptions';\nimport { MediaContent } from './components/MediaContent';\nimport { ContentDisplay } from './components/ContentDisplay';\n\n/**\n * CardMedia component - A highly optimized component for media rendering in timeline cards\n */\nconst CardMedia: React.FunctionComponent<CardMediaModel> = memo(\n  ({\n    active,\n    id,\n    onMediaStateChange,\n    title,\n    content,\n    media,\n    slideshowActive,\n    url,\n    detailsText,\n  }: CardMediaModel) => {\n    // Custom hooks for state management\n    const { loadFailed, mediaLoaded, handleMediaLoaded, handleError } =\n      useMediaLoad(id || '', onMediaStateChange);\n    const isYouTube = useYouTubeDetection(media.source.url);\n    const { expandDetails, showText, toggleExpand, toggleText } =\n      useToggleControls();\n\n    // Use unified timeline context\n    const {\n      theme,\n      mode,\n      cardHeight,\n      borderLessCards,\n      mediaHeight,\n      textOverlay,\n      mediaSettings,\n      // consume from context rather than placeholders\n      fontSizes,\n      classNames,\n      isDarkMode,\n    } = useTimelineContext();\n\n    // Use view options hook for calculated values\n    const {\n      canShowTextMemo,\n      canShowTextContent,\n      canExpand,\n      gradientColor,\n      canShowGradient,\n      getCardHeight,\n    } = useViewOptions({\n      showText,\n      expandDetails,\n      textOverlay,\n      detailsText: detailsText as React.ForwardRefExoticComponent<any>,\n      title,\n      content,\n      theme,\n      cardHeight,\n      mediaHeight,\n    });\n\n    // Cast mode to TimelineMode\n    const timelineMode = mode;\n\n    // Details text callback\n    const onDetailsTextRef = useCallback((height?: number) => {\n      if (height) {\n        // Do something with height if needed\n      }\n    }, []);\n\n    return (\n      <>\n        <div\n          className={cls(\n            mediaWrapper,\n            'card-media-wrapper',\n            classNames?.cardMedia,\n            mediaSettings?.align === 'right' ? justifyEnd : justifyStart,\n          )}\n          style={{\n            height: textOverlay ? 'calc(100% - 1em)' : 0,\n            minHeight: getCardHeight,\n          }}\n        >\n          <MediaContent\n            media={media}\n            isYouTube={isYouTube}\n            loadFailed={loadFailed}\n            mediaLoaded={mediaLoaded}\n            active={active || false}\n            id={id || ''}\n            mediaHeight={mediaHeight}\n            mode={timelineMode}\n            borderLessCards={borderLessCards}\n            mediaSettings={mediaSettings}\n            handleMediaLoaded={handleMediaLoaded}\n            handleError={handleError}\n            onMediaStateChange={onMediaStateChange}\n          />\n        </div>\n\n        {canShowTextContent && (\n          <ContentDisplay\n            mode={timelineMode}\n            textOverlay={textOverlay}\n            theme={theme}\n            expandDetails={expandDetails}\n            showText={showText}\n            canExpand={canExpand}\n            canShowGradient={canShowGradient}\n            gradientColor={gradientColor}\n            title={title}\n            active={active || false}\n            url={url || ''}\n            fontSizes={fontSizes}\n            classNames={classNames}\n            toggleText={toggleText}\n            toggleExpand={toggleExpand}\n            content={content}\n            canShowTextMemo={canShowTextMemo}\n            detailsText={detailsText}\n            onDetailsTextRef={onDetailsTextRef}\n          />\n        )}\n      </>\n    ) as React.ReactElement;\n  },\n  (prevProps, nextProps) => {\n    // Only compare props that this component actually uses/render depends on\n    return (\n      prevProps.active === nextProps.active &&\n      prevProps.slideshowActive === nextProps.slideshowActive &&\n      prevProps.id === nextProps.id &&\n      prevProps.title === nextProps.title &&\n      prevProps.url === nextProps.url &&\n      prevProps.content === nextProps.content &&\n      prevProps.detailsText === nextProps.detailsText &&\n      mediaEqual(prevProps.media, nextProps.media)\n    );\n  },\n);\n\nCardMedia.displayName = 'Card Media';\n\nexport default CardMedia;\n","import { FunctionComponent, PointerEvent, useCallback, useMemo } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport ChevronIcon from '../../icons/chev-right';\nimport { ContentFooterProps } from './header-footer.model';\nimport {\n  chevronIconWrapper,\n  showMoreButton,\n} from './timeline-card-content.css';\n\n/**\n * ContentFooter\n *\n * A functional component that renders the footer of the timeline card.\n * It displays the read more/less button, progress bar, and triangle icon.\n * The read more/less button appears only if the content is large.\n * The progress bar and triangle icon are displayed only if the card is in slideshow mode.\n *\n * @property {boolean} showProgressBar - Determines if progress bar should be displayed.\n * @property {Function} onExpand - Function called when expanding content.\n * @property {string} triangleDir - Direction of the triangle icon.\n * @property {boolean} showMore - Determines if 'read more' should be displayed.\n * @property {boolean} textContentIsLarge - Determines if text content is large.\n * @property {boolean} showReadMore - Determines if 'read more' button should be displayed.\n * @property {number} remainInterval - Remaining interval for progress bar.\n * @property {boolean} paused - Determines if progress is paused.\n * @property {number} startWidth - Starting width of progress bar.\n * @property {boolean} canShow - Determines if the element can be shown.\n * @property {React.RefObject} progressRef - Ref to the progress bar.\n * @property {boolean} isNested - Determines if component is nested.\n * @property {boolean} isResuming - Determines if slideshow is resuming.\n *\n * @returns {JSX.Element} ContentFooter component.\n */\nconst ContentFooter: FunctionComponent<ContentFooterProps> = ({\n  onExpand,\n  showMore,\n  textContentIsLarge,\n  showReadMore,\n  canShow,\n  buttonClassName,\n  iconWrapperClassName,\n}: ContentFooterProps) => {\n  const { theme } = useTimelineContext();\n\n  const handleClick = useCallback(\n    (ev: PointerEvent) => {\n      ev.stopPropagation();\n      ev.preventDefault();\n      onExpand();\n    },\n    [onExpand],\n  );\n\n  const canShowMore = useMemo(() => {\n    // Show read more button when:\n    // 1. The feature is enabled (showReadMore)\n    // 2. The text is large enough OR we're already in expanded state\n    // 3. We have actual content to show (canShow)\n    return showReadMore && canShow && (textContentIsLarge || showMore);\n  }, [showReadMore, textContentIsLarge, canShow, showMore]);\n\n  return (\n    <>\n      {canShowMore ? (\n        <button\n          className={buttonClassName || showMoreButton}\n          onPointerDown={handleClick}\n          onKeyUp={(event) => {\n            if (event.key === 'Enter') {\n              onExpand();\n            }\n          }}\n          tabIndex={0}\n        >\n          {<span>{showMore ? 'read less' : 'read more'}</span>}\n          <span className={iconWrapperClassName || chevronIconWrapper}>\n            <ChevronIcon />\n          </span>\n        </button>\n      ) : null}\n    </>\n  );\n};\n\nexport { ContentFooter };\n","import { FunctionComponent, memo, useMemo } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport { SubTitleMemo } from '../memoized/subtitle-memo';\nimport { TitleMemo } from '../memoized/title-memo';\nimport { ContentHeaderProps } from './header-footer.model';\nimport { timelineCardHeader } from './timeline-card-content.css';\nimport { pickDefined } from '../../../utils/propUtils';\n// Styled component removed in VE migration\n\n/**\n * ContentHeader component\n * This component renders the header of the timeline card including the title and subtitle.\n * It doesn't render the title and subtitle if the card has media.\n * The title and subtitle are memoized to prevent unnecessary re-renders.\n *\n * @property {string} title - The title of the card.\n * @property {string} url - The URL of the card.\n * @property {boolean} media - Indicates whether the card has media or not.\n * @property {string} content - The main content of the card.\n * @returns {JSX.Element} The ContentHeader component.\n */\nconst ContentHeader: FunctionComponent<ContentHeaderProps> = memo(\n  ({ title, url, media, content, cardTitle }: ContentHeaderProps) => {\n    // Using context to get global values\n    const { fontSizes, classNames, theme, isMobile, semanticTags } =\n      useTimelineContext();\n\n    const isNotMedia = useMemo(() => !media, [media]);\n\n    return (\n      <header className={timelineCardHeader}>\n        {/* Render mobile title only if cardTitle exists */}\n        {isMobile && cardTitle ? (\n          <h3\n            style={{\n              fontSize: '1.5rem',\n              color: theme?.cardTitleColor || theme?.titleColor,\n              margin: 0,\n              fontWeight: 600,\n              lineHeight: 1.4,\n            }}\n          >\n            {cardTitle}\n          </h3>\n        ) : null}\n\n        {isNotMedia ? (\n          <TitleMemo\n            title={title}\n            theme={theme}\n            url={url || ''}\n            fontSize={fontSizes?.cardTitle || ''}\n            classString={classNames?.cardTitle || ''}\n            {...pickDefined({\n              color: theme?.cardTitleColor || theme?.titleColor,\n            })}\n          />\n        ) : null}\n\n        {/* Render subtitle if there is no media */}\n\n        {isNotMedia ? (\n          <SubTitleMemo\n            content={content}\n            theme={theme}\n            fontSize={fontSizes?.cardSubtitle || ''}\n            classString={classNames?.cardSubTitle || ''}\n            {...pickDefined({\n              color: theme?.cardSubtitleColor,\n            })}\n          />\n        ) : null}\n      </header>\n    );\n  },\n);\n\n// Setting display name for easier debugging\nContentHeader.displayName = 'ContentHeader';\n\nexport { ContentHeader };\n","import { TimelineContentModel } from '@models/TimelineContentModel';\nimport { TimelineProps } from '@models/TimelineModel';\nimport { Theme } from '@models/Theme';\nimport {\n  ForwardRefExoticComponent,\n  ReactNode,\n  forwardRef,\n  useMemo,\n} from 'react';\nimport xss from 'xss';\nimport { useTimelineContext } from '../../contexts';\nimport {\n  timelineContentDetails,\n  timelineSubContent,\n} from './timeline-card-content.css';\nimport { vars } from 'src/styles/tokens/index.css';\n\n// Define the type for the TextOrContentModel\nexport type TextOrContentModel = Pick<\n  TimelineContentModel,\n  'timelineContent' | 'theme' | 'detailedText'\n> & {\n  showMore?: boolean;\n};\n\n// Function to render an array of text\nconst renderTextArray: (\n  p: Pick<TimelineProps, 'parseDetailsAsHTML' | 'fontSizes' | 'theme'> & {\n    cardTextClassName: string;\n    detailedText: (string | ReactNode)[];\n    isDarkMode?: boolean;\n  },\n) => ReactNode = ({\n  fontSizes,\n  parseDetailsAsHTML,\n  theme,\n  detailedText,\n  cardTextClassName,\n  isDarkMode,\n}) => {\n  return detailedText.map((text, index) => {\n    // Only apply xss if text is a string\n    const props =\n      parseDetailsAsHTML && typeof text === 'string'\n        ? {\n            dangerouslySetInnerHTML: {\n              __html: xss(text),\n            },\n          }\n        : null;\n\n    return (\n      <span\n        className={`${timelineSubContent} ${cardTextClassName ?? ''}`}\n        key={`timeline-text-${typeof text === 'string' ? text.substring(0, 10) : ''}-${index}`}\n        style={{\n          color:\n            theme?.cardDetailsColor ||\n            'var(--vep-color-cardDetails, var(--timeline-text-color, currentColor))',\n        }}\n        {...props}\n      >\n        {parseDetailsAsHTML ? null : text}\n      </span>\n    );\n  });\n};\n\n// Function to get the TextOrContent component\nconst getTextOrContent: (\n  p: TextOrContentModel,\n) => ForwardRefExoticComponent<TextOrContentModel> = ({\n  timelineContent,\n  theme,\n  detailedText,\n  showMore,\n}) => {\n  const TextOrContent = forwardRef<HTMLParagraphElement, TextOrContentModel>(\n    (prop, ref) => {\n      const isTextArray = Array.isArray(detailedText);\n      const {\n        fontSizes,\n        classNames,\n        parseDetailsAsHTML,\n        textContentDensity,\n        isDarkMode,\n      } = useTimelineContext();\n\n      const shouldNotShowText = useMemo(() => {\n        return (\n          (parseDetailsAsHTML && !isTextArray) || textContentDensity === 'LOW'\n        );\n      }, [isTextArray, parseDetailsAsHTML, textContentDensity]);\n\n      // Generate the text content based on detailedText\n      const getTextContent = () => {\n        if (!isTextArray) {\n          return parseDetailsAsHTML && typeof detailedText === 'string'\n            ? xss(detailedText)\n            : detailedText;\n        }\n\n        return renderTextArray({\n          cardTextClassName: classNames?.cardText || '',\n          detailedText: detailedText as (string | ReactNode)[],\n          fontSizes,\n          parseDetailsAsHTML,\n          theme: theme || ({} as Theme),\n          isDarkMode,\n        });\n      };\n\n      // Create props for HTML content if needed\n      const getTextContentProps = (textContent: string) => {\n        if (parseDetailsAsHTML && !isTextArray) {\n          return {\n            dangerouslySetInnerHTML: {\n              __html: xss(textContent),\n            },\n          };\n        }\n        return {};\n      };\n\n      const renderDetailedContent = (textContent: string) => {\n        const textContentProps = getTextContentProps(textContent);\n\n        return (\n          <p\n            className={\n              timelineContentDetails + ' ' + (showMore ? 'active' : '')\n            }\n            ref={ref as any}\n            {...textContentProps}\n            style={{\n              color: `${\n                theme?.detailsColor ??\n                theme?.cardDetailsColor ??\n                vars.color.card?.details ??\n                vars.color.text?.primary ??\n                'currentColor'\n              } !important`,\n              // color: theme?.cardDetailsColor || 'var(--vep-color-cardDetails, var(--timeline-text-color, currentColor))'\n            }}\n          >\n            {shouldNotShowText ? null : parseDetailsAsHTML ? null : textContent}\n          </p>\n        );\n      };\n\n      const renderTimelineContent = () => {\n        if (timelineContent) {\n          return <div ref={ref}>{timelineContent}</div>;\n        }\n\n        const textContent = getTextContent();\n        if (!textContent) return null;\n\n        // If detailedText was an array, render the array of spans directly as children\n        if (isTextArray) {\n          return (\n            <p\n              className={\n                timelineContentDetails + ' ' + (showMore ? 'active' : '')\n              }\n              ref={ref as any}\n              style={{\n                color: `${vars.color.text} !important`, // Ensure color is applied correctly\n                // color: theme?.cardDetailsColor || 'var(--vep-color-cardDetails, var(--timeline-text-color, currentColor))'\n              }}\n            >\n              {shouldNotShowText ? null : textContent}\n            </p>\n          );\n        }\n\n        // Non-array case: render as string/HTML as appropriate\n        return renderDetailedContent(String(textContent));\n      };\n\n      return renderTimelineContent();\n    },\n  );\n\n  TextOrContent.displayName = 'Text Or Content';\n\n  return TextOrContent;\n};\n\nexport { getTextOrContent };\n","import { forwardRef } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport { DetailsTextProps } from './details-text.model';\nimport { getTextOrContent } from './text-or-content';\nimport { contentDetailsWrapperRecipe } from './timeline-card-content.css';\nimport { vars } from 'src/styles/tokens.css';\n\nconst DetailsText = forwardRef<HTMLDivElement, DetailsTextProps>(\n  (prop, ref) => {\n    const {\n      showMore,\n      cardActualHeight,\n      detailsHeight,\n      gradientColor,\n      customContent,\n      timelineContent,\n      detailedText,\n      contentDetailsClass,\n    } = prop;\n\n    const {\n      useReadMore,\n      borderLessCards,\n      contentDetailsHeight,\n      textOverlay,\n      theme,\n      contentAlignment,\n    } = useTimelineContext();\n\n    const TextContent = getTextOrContent({\n      detailedText,\n      showMore: showMore || false,\n      theme,\n      timelineContent,\n    });\n\n    return (\n      <>\n        {/* detailed text */}\n        <div\n          aria-expanded={showMore}\n          className={\n            contentDetailsClass +\n            ' ' +\n            contentDetailsWrapperRecipe({\n              alignHorizontal: contentAlignment.horizontal,\n              alignVertical: contentAlignment.vertical,\n            })\n          }\n          ref={ref}\n          style={{\n            overflowY: showMore ? 'auto' : 'hidden',\n            width: borderLessCards ? 'calc(100% - 0.5rem)' : '100%',\n            background: vars.color.cardBg,\n            // background: theme?.cardDetailsBackGround || theme?.cardBgColor,\n            // Ensure custom scrollbar color reflects theme primary color for tests and styling parity\n            // scrollbarColor: `${theme?.primary} default` as unknown as string,\n            maxHeight: !useReadMore\n              ? 'none'\n              : showMore\n                ? '1000px'\n                : `${contentDetailsHeight ?? 150}px`,\n          }}\n        >\n          {customContent ?? (\n            <TextContent\n              {...{\n                detailedText,\n                showMore: showMore || false,\n                theme,\n                timelineContent,\n              }}\n            />\n          )}\n        </div>\n      </>\n    );\n  },\n);\n\nDetailsText.displayName = 'Details Text';\n\nexport { DetailsText };\n","import React, { useMemo } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport TimelineCard from '../timeline-card-content/timeline-card-content';\nimport { vars } from '../../../styles/tokens/index.css';\n\ninterface NestedTimelineCardsProps {\n  items: any[];\n  nestedCardHeight?: number;\n}\n\n/**\n * Specialized component for rendering nested timelines as simple cards\n * with a center connecting line instead of a full timeline layout\n */\nconst NestedTimelineCards: React.FC<NestedTimelineCardsProps> = ({\n  items,\n  nestedCardHeight,\n}) => {\n  const { isDarkMode } = useTimelineContext();\n\n  // Memoize container styles\n  const containerStyles = useMemo(\n    () => ({\n      position: 'relative' as const,\n      display: 'flex',\n      flexDirection: 'column' as const,\n      gap: '1rem',\n      padding: '1rem 0',\n    }),\n    [],\n  );\n\n  // Memoize center line styles\n  const centerLineStyles = useMemo(\n    () => ({\n      position: 'absolute' as const,\n      left: '50%',\n      top: '0',\n      bottom: '0',\n      width: '2px',\n      background: vars.color.primary,\n      transform: 'translateX(-50%)',\n      zIndex: 1,\n    }),\n    [],\n  );\n\n  // Memoize item wrapper styles\n  const itemWrapperStyles = useMemo(\n    () => ({\n      position: 'relative' as const,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      zIndex: 2,\n    }),\n    [],\n  );\n\n  // Memoize card container styles\n  const cardContainerStyles = useMemo(\n    () => ({\n      width: '100%',\n      maxWidth: '600px',\n      background: vars.color.nestedCardBg,\n      border: `1px solid ${vars.color.buttonBorder}`,\n      borderRadius: '8px',\n      padding: '1rem',\n      boxShadow: isDarkMode\n        ? '0 2px 4px rgba(0, 0, 0, 0.3)'\n        : '0 2px 4px rgba(0, 0, 0, 0.1)',\n      position: 'relative' as const,\n    }),\n    [],\n  );\n\n  // Memoize title styles\n  const titleStyles = useMemo(\n    () => ({\n      margin: '0 0 0.5rem 0',\n      color: vars.color.nestedCardTitle,\n      fontSize: '1.1rem',\n      fontWeight: '600',\n    }),\n    [],\n  );\n\n  // Memoize subtitle styles\n  const subtitleStyles = useMemo(\n    () => ({\n      margin: '0 0 0.75rem 0',\n      color: vars.color.nestedCardSubtitle,\n      fontSize: '0.95rem',\n    }),\n    [],\n  );\n\n  // Memoize details text styles with nested card height\n  const getDetailsStyles = useMemo(\n    () => ({\n      color: vars.color.nestedCardDetails,\n      fontSize: '0.9rem',\n      lineHeight: '1.5',\n      ...(nestedCardHeight && {\n        maxHeight: `${nestedCardHeight}px`,\n        overflow: 'auto' as const,\n      }),\n    }),\n    [nestedCardHeight],\n  );\n\n  // Memoize link styles\n  const linkStyles = useMemo(\n    () => ({\n      display: 'inline-block',\n      marginTop: '0.75rem',\n      color: vars.color.primary,\n      textDecoration: 'none',\n      fontSize: '0.9rem',\n      fontWeight: '500',\n    }),\n    [],\n  );\n\n  if (!items || items.length === 0) {\n    return null;\n  }\n\n  return (\n    <div style={containerStyles}>\n      {/* Center connecting line */}\n      <div style={centerLineStyles} />\n\n      {/* Render nested timeline items as simple cards */}\n      {items.map((item, index) => (\n        <div key={item.id || index} style={itemWrapperStyles}>\n          {/* Card container */}\n          <div style={cardContainerStyles}>\n            {/* Card content */}\n            <div>\n              {item.cardTitle && <h3 style={titleStyles}>{item.cardTitle}</h3>}\n\n              {item.cardSubtitle && (\n                <p style={subtitleStyles}>{item.cardSubtitle}</p>\n              )}\n\n              {item.cardDetailedText && (\n                <div\n                  style={getDetailsStyles}\n                  dangerouslySetInnerHTML={{ __html: item.cardDetailedText }}\n                />\n              )}\n\n              {item.url && (\n                <a\n                  href={item.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  style={linkStyles}\n                >\n                  Learn more →\n                </a>\n              )}\n            </div>\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default NestedTimelineCards;\n","import React from 'react';\nimport NestedTimelineCards from './nested-timeline-cards';\n\ninterface NestedTimelineRendererProps {\n  items: any[];\n  nestedCardHeight?: number;\n  mode?: string;\n  isChild?: boolean;\n}\n\n/**\n * Renders nested timeline items using a card-based layout with center connecting line\n * instead of full timeline rendering to avoid complex nested timeline layouts\n */\nconst NestedTimelineRenderer: React.FC<NestedTimelineRendererProps> = ({\n  items,\n  nestedCardHeight,\n}) => {\n  // Always use the card-based layout for nested timelines\n  return (\n    <NestedTimelineCards\n      items={items}\n      {...(nestedCardHeight !== undefined && { nestedCardHeight })}\n    />\n  );\n};\n\nexport default NestedTimelineRenderer;\n","import { TimelineContentModel } from '@models/TimelineContentModel';\nimport { MediaState } from '@models/TimelineMediaModel';\nimport { hexToRGBA } from '@utils/index';\nimport { shallowEqual, arrayEqual, mediaEqual } from '@utils/comparison';\nimport cls from 'classnames';\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useSlideshow } from '../../effects/useSlideshow';\nimport { useCardSize } from '../../../hooks/useCardSize';\nimport { useTimelineContext } from '../../contexts';\n// Remove the Timeline import to break the circular dependency\n// import Timeline from '../../timeline/timeline';\nimport CardMedia from '../timeline-card-media/timeline-card-media';\nimport { ContentFooter } from './content-footer';\nimport { ContentHeader } from './content-header';\nimport { DetailsText } from './details-text';\nimport { getTextOrContent } from './text-or-content';\nimport {\n  baseCard,\n  itemContentWrapper,\n  contentDetailsWrapper,\n  showMoreButton,\n  chevronIconWrapper,\n} from './timeline-card-content.css';\nimport { nestedTimelineWrapper } from '../../timeline-vertical/timeline-vertical.css';\nimport { SlideShowType } from '@models/TimelineModel';\nimport NestedTimelineRenderer from '../nested-timeline-renderer/nested-timeline-renderer';\n\n// Custom equality function for React.memo to prevent unnecessary re-renders\nconst arePropsEqual = (\n  prevProps: TimelineContentModel,\n  nextProps: TimelineContentModel,\n): boolean => {\n  // Always re-render if active state changes\n  if (prevProps.active !== nextProps.active) return false;\n  // If detailedText arrays are passed, compare structurally\n  if (\n    Array.isArray(prevProps.detailedText) ||\n    Array.isArray(nextProps.detailedText)\n  ) {\n    if (\n      !arrayEqual(prevProps.detailedText as any, nextProps.detailedText as any)\n    )\n      return false;\n  }\n\n  // Re-render if slideshow state changes\n  if (prevProps.slideShowActive !== nextProps.slideShowActive) return false;\n\n  // Re-render if hasFocus changes\n  if (prevProps.hasFocus !== nextProps.hasFocus) return false;\n\n  // Only re-render content-related props if they actually change\n  if (prevProps.content !== nextProps.content) return false;\n  // For non-array detailedText, compare by reference\n  if (\n    !Array.isArray(prevProps.detailedText) &&\n    !Array.isArray(nextProps.detailedText)\n  ) {\n    if (prevProps.detailedText !== nextProps.detailedText) return false;\n  }\n  if (prevProps.title !== nextProps.title) return false;\n  if (prevProps.cardTitle !== nextProps.cardTitle) return false;\n\n  // Efficient media comparison\n  if (!mediaEqual(prevProps.media, nextProps.media)) return false;\n\n  // Efficient theme comparison (shallow)\n  if (!shallowEqual(prevProps.theme, nextProps.theme)) return false;\n\n  // Efficient items comparison for nested timeline\n  if (!arrayEqual(prevProps.items, nextProps.items)) return false;\n\n  // Default to true - don't re-render\n  return true;\n};\n\nconst TimelineCardContent: React.FunctionComponent<TimelineContentModel> =\n  React.memo(\n    ({\n      active,\n      content,\n      detailedText,\n      id,\n      media,\n      onShowMore,\n      slideShowActive,\n      onElapsed,\n      theme,\n      onClick,\n      customContent,\n      hasFocus,\n      flip,\n      branchDir,\n      url,\n      timelineContent,\n      items,\n      isNested,\n      nestedCardHeight,\n      title,\n      cardTitle,\n      focusable,\n    }: TimelineContentModel) => {\n      const [showMore, setShowMore] = useState(false);\n      const detailsRef = useRef<HTMLDivElement | null>(null);\n      const progressRef = useRef<HTMLProgressElement | null>(null);\n      const isFirstRender = useRef(true);\n\n      // NOTE: Focus management is now handled separately (WCAG 2.4.3)\n      // Visual highlighting of active items is done via CSS (.active class)\n      // Keyboard focus is only set during actual keyboard navigation\n      // This prevents toolbar buttons from losing focus when timeline items are activated\n      const containerRef = useRef<HTMLDivElement>(null);\n\n      const [hasBeenActivated, setHasBeenActivated] = useState(false);\n      const [isResuming, setIsResuming] = useState(false);\n\n      // Use unified timeline context\n      // Note: theme is passed as a prop to this component, so we don't need it from context\n      const {\n        mode,\n        cardHeight,\n        useReadMore,\n        cardWidth,\n        borderLessCards,\n        highlightCardsOnHover,\n        textContentDensity,\n        textOverlay,\n        disableInteraction,\n        // Pull previously hard-coded values from context\n        slideItemDuration,\n        disableAutoScrollOnClick,\n        classNames,\n        slideShowType,\n        showProgressOnSlideshow,\n        isDarkMode,\n      } = useTimelineContext();\n\n      // Map textContentDensity to textDensity for backward compatibility\n      const textDensity = textContentDensity;\n\n      // Values now sourced from context above\n\n      const {\n        paused,\n        remainInterval,\n        startWidth,\n        tryPause,\n        setupTimer,\n        setStartWidth,\n      } = useSlideshow(\n        progressRef as unknown as React.RefObject<HTMLElement>,\n        !!active,\n        !!slideShowActive,\n        slideItemDuration,\n        id || '',\n        onElapsed,\n      );\n\n      const {\n        cardActualHeight,\n        detailsHeight,\n        textContentLarge,\n        updateCardSize,\n      } = useCardSize({\n        containerRef,\n        detailsRef,\n        setStartWidth,\n      });\n\n      // Memoize all calculated values to prevent re-renders\n      const canShowProgressBar = useMemo(() => {\n        return active && slideShowActive && showProgressOnSlideshow;\n      }, [active, slideShowActive, showProgressOnSlideshow]);\n\n      const canShowMore = useMemo(() => {\n        // Show read more functionality when:\n        // 1. We have detailed text content\n        // 2. The text is large enough to be truncated OR we're already in expanded state\n        return !!detailedText && (textContentLarge || showMore);\n      }, [detailedText, textContentLarge, showMore]);\n\n      const canShowReadMore = useMemo(() => {\n        return (\n          useReadMore && detailedText && !customContent && textDensity !== 'LOW'\n        );\n      }, [useReadMore, detailedText, customContent, textDensity]);\n\n      const canShowNestedTimeline = useMemo(() => {\n        return items && items.length > 0;\n      }, [items]);\n\n      const canShowDetailsText = useMemo(() => {\n        // Hide details when using text overlay with media, when density is LOW, otherwise show if content exists\n        return (\n          (detailedText ?? customContent ?? timelineContent) &&\n          !(textOverlay && media) &&\n          textDensity !== 'LOW'\n        );\n      }, [\n        detailedText,\n        customContent,\n        timelineContent,\n        textOverlay,\n        media,\n        textDensity,\n      ]);\n\n      // Initialize card size measurements when refs are ready\n      useEffect(() => {\n        // Use RAF to defer the initial measurement\n        const rafId = requestAnimationFrame(() => {\n          if (containerRef.current && detailsRef.current) {\n            updateCardSize(containerRef.current);\n          }\n        });\n\n        return () => cancelAnimationFrame(rafId);\n      }, [updateCardSize]);\n\n      // Remeasure card size when textDensity changes\n      useEffect(() => {\n        // When textDensity changes (e.g., from LOW to HIGH), we need to remeasure\n        // the card to update textContentLarge value\n        const rafId = requestAnimationFrame(() => {\n          if (containerRef.current && detailsRef.current) {\n            updateCardSize(containerRef.current);\n          }\n        });\n\n        return () => cancelAnimationFrame(rafId);\n      }, [textDensity, updateCardSize]);\n\n      // Reset details scroll position when toggling details\n      useEffect(() => {\n        const detailsEle = detailsRef.current;\n        if (detailsEle) {\n          detailsEle.scrollTop = 0;\n        }\n      }, [showMore]);\n\n      // Handle card activation\n      useEffect(() => {\n        if (active && !hasBeenActivated) {\n          setHasBeenActivated(true);\n        }\n      }, [active, hasBeenActivated]);\n\n      // Setup timer when card becomes active\n      useEffect(() => {\n        if (!slideItemDuration) {\n          return;\n        }\n\n        if (active && slideShowActive) {\n          setupTimer(slideItemDuration);\n        }\n\n        // Focus is now handled by useTimelineNavigation hook\n        // Only during keyboard navigation, not toolbar navigation\n\n        if (!slideShowActive) {\n          setHasBeenActivated(false);\n        }\n      }, [active, slideShowActive, slideItemDuration, hasFocus, setupTimer]);\n\n      // Focus management is now handled by useFocusManager hook\n\n      // Detect when resuming from pause\n      useEffect(() => {\n        if (!paused && !isFirstRender.current) {\n          setIsResuming(true);\n        }\n      }, [paused]);\n\n      // Track first render\n      useEffect(() => {\n        isFirstRender.current = false;\n\n        // Cleanup function\n        return () => {\n          isFirstRender.current = true;\n        };\n      }, []);\n\n      // Memoize handler functions\n      const handleMediaState = useCallback(\n        (state: MediaState) => {\n          if (!slideShowActive) {\n            return;\n          }\n          if (state.playing) {\n            // Pause slideshow when video starts playing\n            tryPause();\n          } else if (state.paused || state.ended) {\n            // Resume slideshow when video is paused or ends\n            // Continue to next slide immediately when video is paused/ended\n            if (id && onElapsed) {\n              onElapsed(id);\n            }\n          }\n        },\n        [slideShowActive, tryPause, id, onElapsed],\n      );\n\n      const handleCardClick = useCallback(\n        (event: React.MouseEvent) => {\n          // Check if click originated from an interactive element\n          const target = event.target as HTMLElement;\n          const isInteractiveElement = target.closest(\n            'a, button, input, textarea, select, [role=\"button\"]',\n          );\n\n          // If clicking an interactive element, let it handle its own events\n          if (isInteractiveElement) {\n            // Allow default behavior (link navigation, button click, etc.)\n            return;\n          }\n\n          event.stopPropagation(); // Prevent event bubbling to parent handlers\n\n          // Don't handle clicks if we're in slideshow mode or if already active\n          if (slideShowActive || active) return;\n\n          if (onClick && !disableInteraction) {\n            // REMOVED: Manual focus calls (WCAG 2.4.3: Focus Order)\n            // Focus is no longer moved to timeline items during card click\n            // Visual highlighting is handled via CSS (.active class)\n            // Keyboard focus remains on the element that triggered the action\n\n            // Trigger the click handler which will handle scrolling and state updates\n            onClick(id || '');\n          }\n        },\n        [onClick, id, disableInteraction, slideShowActive, active],\n      );\n\n      const toggleShowMore = useCallback(() => {\n        if ((active && paused) || !slideShowActive) {\n          setShowMore((prev) => !prev);\n          onShowMore?.();\n          // REMOVED: Manual focus call (WCAG 2.4.3: Focus Order)\n          // Visual state is handled by CSS, not by moving keyboard focus\n        }\n      }, [active, paused, slideShowActive, onShowMore]);\n\n      // Memoize computed values to prevent re-renders\n      const triangleDir = useMemo(() => {\n        if (mode === 'VERTICAL_ALTERNATING') {\n          return flip ? 'right' : 'left';\n        }\n        return null;\n      }, [mode, flip]);\n\n      const gradientColor = useMemo(() => {\n        return hexToRGBA(theme?.cardBgColor ?? '#fff', 0.4);\n      }, [theme?.cardBgColor]);\n\n      const contentDetailsClass = useMemo(() => {\n        return cls(\n          'card-description',\n          classNames?.cardText ?? '',\n          borderLessCards ? 'no-border' : '',\n        );\n      }, [classNames?.cardText, borderLessCards]);\n\n      // Get the accessible label for the card\n      const accessibleLabel = useMemo(() => {\n        return (\n          (typeof cardTitle === 'string' ? cardTitle : null) ??\n          (typeof title === 'string' ? title : null) ??\n          'Timeline card'\n        );\n      }, [cardTitle, title]);\n\n      // Create the detailsText component for text overlay mode using the proper function\n      const detailsTextComponent = useMemo(() => {\n        // Only create the component if we need it for text overlay mode\n        if (textOverlay && (detailedText ?? customContent ?? timelineContent)) {\n          return getTextOrContent({\n            timelineContent,\n            theme: theme!,\n            detailedText: detailedText!,\n            showMore,\n          });\n        }\n        return null;\n      }, [\n        textOverlay,\n        detailedText,\n        customContent,\n        timelineContent,\n        theme,\n        showMore,\n      ]);\n\n      // The card's minimum height - FIX for Issue #498: Support 'auto' for dynamic sizing\n      const cardMinHeight = useMemo(() => {\n        let height: number | 'auto' | undefined;\n\n        if (textOverlay && media) {\n          height = cardHeight;\n        } else if (!isNested) {\n          height = cardHeight;\n        } else {\n          height = nestedCardHeight;\n        }\n\n        // When 'auto', return undefined to let content determine height\n        return height === 'auto' ? undefined : height;\n      }, [textOverlay, media, isNested, cardHeight, nestedCardHeight]);\n\n      return (\n        <section\n          aria-label={accessibleLabel}\n          ref={containerRef}\n          onClick={handleCardClick}\n          className={`timeline-card-content ${active ? 'active' : ''} ${classNames?.card ?? ''} ${baseCard({ borderless: borderLessCards })} ${itemContentWrapper}`}\n          data-testid=\"timeline-card-content\"\n          data-item-id={id}\n          tabIndex={focusable !== false && active ? 0 : -1}\n          role=\"article\"\n          aria-current={active ? 'true' : 'false'}\n          onDoubleClick={toggleShowMore}\n          style={{\n            minHeight: customContent ? undefined : cardMinHeight,\n            height: customContent ? cardMinHeight : undefined,\n            maxWidth: cardWidth ? `${cardWidth}px` : '100%',\n          }}\n        >\n          {/* Only show the content header if we're not using text overlay mode with media */}\n          {(!textOverlay || !media) && (\n            <ContentHeader\n              title={title}\n              url={url || ''}\n              media={media as any}\n              content={content}\n              cardTitle={cardTitle}\n              theme={theme as any}\n            />\n          )}\n\n          {media && (\n            <CardMedia\n              active={!!active}\n              cardHeight={cardHeight}\n              content={content}\n              hideMedia={showMore}\n              id={id || ''}\n              media={media as any}\n              onMediaStateChange={handleMediaState}\n              slideshowActive={!!slideShowActive}\n              theme={theme as any}\n              title={typeof title === 'string' ? title : ''}\n              url={url || ''}\n              startWidth={startWidth}\n              detailsText={detailsTextComponent as any}\n              paused={paused}\n              remainInterval={remainInterval}\n              showProgressBar={!!canShowProgressBar}\n              triangleDir={triangleDir || ''}\n              resuming={isResuming}\n              progressRef={progressRef as any}\n            />\n          )}\n\n          {canShowDetailsText && (\n            <DetailsText\n              showMore={showMore}\n              gradientColor={gradientColor}\n              detailedText={detailedText}\n              customContent={customContent}\n              timelineContent={timelineContent}\n              contentDetailsClass={`${contentDetailsClass} ${contentDetailsWrapper}`}\n              cardActualHeight={cardActualHeight}\n              detailsHeight={detailsHeight}\n              ref={detailsRef}\n            />\n          )}\n\n          {canShowNestedTimeline && (\n            <div className={nestedTimelineWrapper}>\n              <NestedTimelineRenderer\n                items={items || []}\n                mode={'VERTICAL'}\n                nestedCardHeight={nestedCardHeight || 0}\n                isChild={true}\n              />\n            </div>\n          )}\n\n          {canShowReadMore && canShowMore && (\n            <ContentFooter\n              onExpand={toggleShowMore}\n              triangleDir={triangleDir || ''}\n              showMore={showMore}\n              textContentIsLarge={textContentLarge}\n              showReadMore={canShowReadMore}\n              remainInterval={remainInterval}\n              startWidth={startWidth}\n              canShow={!!detailedText}\n              isNested={!!isNested}\n              theme={theme as any}\n              buttonClassName={showMoreButton}\n              iconWrapperClassName={chevronIconWrapper}\n            />\n          )}\n        </section>\n      );\n    },\n    arePropsEqual,\n  );\n\nexport default TimelineCardContent;\n","import React, { useCallback, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { wrapper as veCardWrapper } from '../timeline-horizontal-card.css';\nimport TimelineCardContent from '../../timeline-card-content/timeline-card-content';\nimport { pickDefined } from '../../../../utils/propUtils';\n\ninterface TimelineCardPortalProps {\n  containerClass: string;\n  contentRef: React.RefObject<HTMLDivElement>;\n  id: string;\n  theme?: any;\n  active: boolean;\n  disableInteraction: boolean;\n  showAllCardsHorizontal: boolean;\n  cardWidth?: number;\n  cardSubtitle?: string;\n  cardTitle?: string;\n  url?: string;\n  cardDetailedText?: string | string[];\n  slideShowRunning?: boolean;\n  media?: any;\n  onElapsed?: (id: string) => void;\n  customContent?: React.ReactNode;\n  hasFocus?: boolean;\n  onClick?: (id: string) => void;\n  timelineContent?: any;\n  isNested?: boolean;\n  nestedCardHeight?: number;\n  items?: any[];\n  wrapperId: string;\n}\n\nconst TimelineCardPortal: React.FC<TimelineCardPortalProps> = ({\n  containerClass,\n  contentRef,\n  id,\n  theme,\n  active,\n  disableInteraction,\n  showAllCardsHorizontal,\n  cardWidth,\n  cardSubtitle,\n  cardTitle,\n  url,\n  cardDetailedText,\n  slideShowRunning,\n  media,\n  onElapsed,\n  customContent,\n  hasFocus,\n  onClick,\n  timelineContent,\n  isNested,\n  nestedCardHeight,\n  items,\n  wrapperId,\n}) => {\n  const handleOnShowMore = useCallback(() => {}, []);\n\n  const Content = useMemo(() => {\n    return (\n      <div\n        className={`${containerClass} ${veCardWrapper} ${showAllCardsHorizontal || active ? 'highlight-active' : ''} ${active ? 'active' : ''}`}\n        ref={contentRef}\n        id={`timeline-card-${id}`}\n        tabIndex={-1}\n        style={{\n          minWidth:\n            cardWidth &&\n            (Number.isFinite(cardWidth) ? `${cardWidth}px` : undefined),\n          display: active || showAllCardsHorizontal ? 'flex' : 'none',\n          margin: showAllCardsHorizontal ? '0 1rem' : '0 auto',\n          transform: active ? 'scale(1.02)' : 'scale(1)',\n          transition: 'all 0.3s ease-in-out',\n          opacity: active ? 1 : showAllCardsHorizontal ? 0.7 : 0,\n          justifyContent: 'center',\n          alignItems: 'center',\n        }}\n      >\n        <TimelineCardContent\n          content={cardSubtitle}\n          active={active}\n          title={cardTitle}\n          detailedText={cardDetailedText}\n          onShowMore={handleOnShowMore}\n          theme={theme}\n          media={media}\n          id={id}\n          customContent={customContent}\n          focusable={false}\n          {...pickDefined({\n            url,\n            slideShowActive: slideShowRunning,\n            hasFocus,\n            onClick,\n            timelineContent,\n            isNested,\n            nestedCardHeight,\n            items,\n          })}\n          {...(onElapsed\n            ? { onElapsed: (id?: string) => id && onElapsed(id) }\n            : {})}\n        />\n      </div>\n    );\n  }, [\n    containerClass,\n    contentRef,\n    id,\n    active,\n    disableInteraction,\n    showAllCardsHorizontal,\n    cardWidth,\n    cardSubtitle,\n    cardTitle,\n    url,\n    cardDetailedText,\n    slideShowRunning,\n    theme,\n    media,\n    onElapsed,\n    customContent,\n    hasFocus,\n    onClick,\n    timelineContent,\n    isNested,\n    nestedCardHeight,\n    items,\n  ]);\n\n  const renderedPortal = useMemo(() => {\n    const ele = document.getElementById(wrapperId);\n    if (ele) {\n      return ReactDOM.createPortal(Content, ele);\n    }\n    return null;\n  }, [Content, wrapperId]);\n\n  return <>{renderedPortal}</>;\n};\n\nexport default TimelineCardPortal;\n","import { TimelineCardModel } from '@models/TimelineItemModel';\nimport React, { useMemo } from 'react';\nimport { useTimelineContext } from '../../contexts';\nimport TimelineItemTitle from '../timeline-item-title/timeline-card-title';\nimport {\n  wrapper,\n  timelineTitleContainer,\n} from './timeline-horizontal-card.css';\nimport { useTimelineCard } from './hooks/useTimelineCard';\nimport { pickDefined } from '../../../utils/propUtils';\nimport TimelinePoint from './timeline-point/timeline-point';\nimport TimelineCardPortal from './timeline-card-portal/timeline-card-portal';\n\nconst TimelineCard: React.FunctionComponent<TimelineCardModel> = ({\n  active,\n  autoScroll,\n  cardDetailedText,\n  cardSubtitle,\n  cardTitle,\n  url,\n  id,\n  media,\n  onClick,\n  onElapsed,\n  slideShowRunning,\n  title,\n  wrapperId,\n  customContent,\n  hasFocus,\n  iconChild,\n  timelineContent,\n  cardWidth,\n  cardHeight,\n  isNested,\n  nestedCardHeight,\n  items,\n}: TimelineCardModel) => {\n  const {\n    mode,\n    cardPositionHorizontal: position,\n    timelinePointDimension,\n    cardLess,\n    showAllCardsHorizontal,\n    classNames,\n    theme,\n    timelinePointShape,\n    disableInteraction,\n  } = useTimelineContext();\n\n  const {\n    circleRef,\n    wrapperRef,\n    contentRef,\n    handleClick,\n    modeLower,\n    containerClass,\n    titleClass,\n    circleClass,\n    canShowTimelineContent,\n  } = useTimelineCard({\n    cardLess,\n    showAllCardsHorizontal,\n    mode: mode as\n      | 'HORIZONTAL'\n      | 'VERTICAL'\n      | 'VERTICAL_ALTERNATING'\n      | 'HORIZONTAL_ALL',\n    position,\n    iconChild,\n    ...pickDefined({\n      active,\n      autoScroll,\n      slideShowRunning,\n      id,\n      onClick,\n    }),\n  });\n\n  // Convert cardDetailedText to the expected string or string[] format\n  const formatDetailedText = () => {\n    if (Array.isArray(cardDetailedText)) {\n      return cardDetailedText.map((text) =>\n        typeof text === 'string' ? text : String(text ?? ''),\n      );\n    }\n\n    if (typeof cardDetailedText === 'string') {\n      return cardDetailedText;\n    }\n\n    return cardDetailedText ? String(cardDetailedText) : undefined;\n  };\n\n  const formattedDetailedText = formatDetailedText();\n\n  // Memoized timeline point props similar to vertical timeline implementation\n  const timelinePointProps = useMemo(\n    () => ({\n      circleClass,\n      handleClick,\n      circleRef: circleRef as React.RefObject<HTMLButtonElement>,\n      title: typeof title === 'string' ? title : String(title ?? ''),\n      theme,\n      timelinePointDimension,\n      timelinePointShape,\n      iconChild,\n      disabled: disableInteraction,\n      ...pickDefined({\n        active,\n        itemId: id,\n      }),\n    }),\n    [\n      circleClass,\n      handleClick,\n      circleRef,\n      title,\n      theme,\n      timelinePointDimension,\n      timelinePointShape,\n      iconChild,\n      disableInteraction,\n      active,\n      id,\n    ],\n  );\n\n  return (\n    <div\n      ref={wrapperRef}\n      className=\"timeline-horizontal-item\"\n      data-testid=\"timeline-item\"\n    >\n      {/* Timeline Point - At the top */}\n      <div className=\"timeline-point-section\">\n        <TimelinePoint {...timelinePointProps} />\n      </div>\n\n      {/* Title - Right below the point */}\n      <div className=\"timeline-title-section\">\n        <TimelineItemTitle\n          title={title}\n          active={(active || false) && !disableInteraction}\n          theme={theme}\n          classString={classNames?.title || ''}\n        />\n      </div>\n\n      {/* Card Content - Below the title */}\n      {canShowTimelineContent && (\n        <div className=\"timeline-card-section\">\n          <TimelineCardPortal\n            containerClass={containerClass}\n            contentRef={contentRef as React.RefObject<HTMLDivElement>}\n            id={id || ''}\n            theme={theme}\n            active={active || false}\n            disableInteraction={disableInteraction}\n            showAllCardsHorizontal={showAllCardsHorizontal}\n            cardSubtitle={\n              typeof cardSubtitle === 'string'\n                ? cardSubtitle\n                : String(cardSubtitle ?? '')\n            }\n            cardTitle={\n              typeof cardTitle === 'string'\n                ? cardTitle\n                : String(cardTitle ?? '')\n            }\n            wrapperId={wrapperId}\n            {...pickDefined({\n              cardWidth,\n              cardHeight,\n              url,\n              slideShowRunning,\n              media,\n              onElapsed,\n              customContent,\n              hasFocus,\n              onClick,\n              timelineContent,\n              isNested,\n              nestedCardHeight,\n              items,\n            })}\n            {...(formattedDetailedText\n              ? { cardDetailedText: formattedDetailedText }\n              : {})}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TimelineCard;\n","import { TimelineHorizontalModel } from '@models/TimelineHorizontalModel';\nimport cls from 'classnames';\nimport React, {\n  ReactNode,\n  useContext,\n  useMemo,\n  useEffect,\n  useRef,\n} from 'react';\nimport { useTimelineContext } from '../contexts';\nimport { pickDefined } from '../../utils/propUtils';\nimport { useRovingTabIndex } from '../../hooks/accessibility/useRovingTabIndex';\nimport TimelineCard from '../timeline-elements/timeline-card/timeline-horizontal-card';\nimport {\n  timelineHorizontalWrapper,\n  timelineItemWrapper,\n} from './timeline-horizontal.css';\n\n/**\n * TimelineHorizontal\n * @property {TimelineHorizontalModel} items - The items to be displayed in the timeline.\n * @property {(item: TimelineItem) => void} handleItemClick - Function to handle item click.\n * @property {boolean} autoScroll - Whether to auto-scroll the timeline.\n * @property {string} wrapperId - The ID of the wrapper element.\n * @property {boolean} slideShowRunning - Whether the slideshow is running.\n * @property {() => void} onElapsed - Function to handle elapsed time.\n * @property {React.ReactNode} contentDetailsChildren - The children nodes for content details.\n * @property {boolean} hasFocus - Whether the timeline has focus.\n * @property {React.ReactNode} iconChildren - The children nodes for icons.\n * @property {number} nestedCardHeight - The height of the nested card.\n * @property {boolean} isNested - Whether the card is nested.\n * @returns {JSX.Element} The TimelineHorizontal component.\n */\n\nconst TimelineHorizontal: React.FunctionComponent<TimelineHorizontalModel> = ({\n  items,\n  handleItemClick,\n  autoScroll,\n  wrapperId,\n  slideShowRunning,\n  onElapsed,\n  contentDetailsChildren: children,\n  hasFocus,\n  iconChildren,\n  nestedCardHeight,\n  isNested,\n  mode: propMode,\n  theme: propTheme,\n  lineWidth: propLineWidth,\n}: TimelineHorizontalModel) => {\n  // Use unified context\n  const {\n    theme: contextTheme,\n    mode: contextMode,\n    itemWidth,\n    cardHeight,\n    flipLayout,\n    showAllCardsHorizontal,\n    cardWidth,\n    focusActiveItemOnLoad,\n  } = useTimelineContext();\n\n  // Prioritize prop theme over context theme\n  const theme = propTheme || contextTheme;\n  const lineWidth = propLineWidth || 2;\n\n  // Prioritize prop mode over context mode\n  const mode = propMode || contextMode;\n\n  // Memoize the wrapper class to avoid unnecessary re-renders\n  const wrapperClass = useMemo(\n    () =>\n      cls(\n        mode.toLowerCase(),\n        'timeline-horizontal-container',\n        showAllCardsHorizontal ? 'show-all-cards-horizontal' : '',\n      ),\n    [mode, showAllCardsHorizontal],\n  );\n\n  // Ref to the horizontal list to scope focus queries\n  const listRef = useRef<HTMLUListElement>(null);\n\n  /**\n   * Initialize roving tabindex for timeline cards (WCAG 2.1.1: Keyboard)\n   * Handles Left/Right arrow key navigation through timeline items in horizontal mode\n   */\n  const rovingItemsConfig = useMemo(\n    () =>\n      items.map((item, index) => ({\n        id: item.id || `item-${index}`,\n        disabled: false,\n      })),\n    [items],\n  );\n\n  const { getItemProps } = useRovingTabIndex({\n    items: rovingItemsConfig,\n    orientation: 'horizontal',\n    loop: false, // Explicit navigation, don't loop around\n    focusOnLoad: focusActiveItemOnLoad, // Respect focus-on-load setting\n  });\n\n  // Track if this is the initial render to prevent auto-focus unless focusActiveItemOnLoad is true\n  const isInitialRenderRef = useRef(true);\n\n  useEffect(() => {\n    isInitialRenderRef.current = false;\n  }, []);\n\n  // Find and focus the active timeline point button when items update\n  const activeId = useMemo(() => items.find((i) => i.active)?.id, [items]);\n\n  useEffect(() => {\n    if (!activeId) return;\n\n    // Only focus on initial render if focusActiveItemOnLoad is true\n    if (isInitialRenderRef.current && !focusActiveItemOnLoad) {\n      return;\n    }\n\n    // In both horizontal modes, focus the active point button if it exists\n    const root = listRef.current ?? document;\n    const activePoint = root.querySelector(\n      `button[data-testid=\"timeline-circle\"][data-item-id=\"${activeId}\"]`,\n    ) as HTMLButtonElement | null;\n    if (activePoint) {\n      requestAnimationFrame(() => {\n        try {\n          activePoint.focus({ preventScroll: false });\n        } catch (_) {\n          // ignore focus errors\n        }\n      });\n    }\n  }, [activeId, focusActiveItemOnLoad]);\n\n  const iconChildColln = useMemo(\n    () => React.Children.toArray(iconChildren),\n    [iconChildren],\n  );\n\n  // Memoize the timeline items to prevent unnecessary re-renders\n  const timelineItems = useMemo(() => {\n    return items.map((item, index) => {\n      // Get roving tabindex props for this item\n      const itemId = item.id || `item-${index}`;\n      const rovingProps = getItemProps(itemId) as any;\n\n      return (\n        <li\n          key={item.id}\n          className={cls(\n            timelineItemWrapper,\n            item.visible || showAllCardsHorizontal ? 'visible' : '',\n            'timeline-horz-item-container',\n          )}\n          style={{\n            width: itemWidth,\n            minWidth: showAllCardsHorizontal ? itemWidth : undefined,\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'flex-start',\n            height: '100%',\n          }}\n          aria-current={item.active ? 'true' : undefined}\n          id={`timeline-${mode.toLowerCase()}-item-${item.id}`}\n          tabIndex={rovingProps?.tabIndex ?? -1}\n          onKeyDown={rovingProps?.onKeyDown}\n          onFocus={rovingProps?.onFocus}\n        >\n          <TimelineCard\n            // Always required props\n            onClick={handleItemClick}\n            autoScroll={autoScroll}\n            wrapperId={wrapperId}\n            theme={theme}\n            cardHeight={cardHeight}\n            cardWidth={cardWidth}\n            // Always provided props\n            title={item.title}\n            cardTitle={item.cardTitle}\n            cardSubtitle={item.cardSubtitle}\n            cardDetailedText={item.cardDetailedText}\n            customContent={children ? (children as ReactNode[])[index] : null}\n            iconChild={iconChildColln[index]}\n            // Conditionally provided props - clean approach\n            {...pickDefined({\n              id: item.id,\n              url: item.url,\n              media: item.media,\n              timelineContent: item.timelineContent,\n              items: item.items,\n              isNested: item.isNested,\n              hasNestedItems: item.hasNestedItems,\n              visible: item.visible,\n              active: item.active,\n              slideShowRunning: slideShowRunning,\n              onElapsed: onElapsed,\n              hasFocus: hasFocus,\n              nestedCardHeight: nestedCardHeight,\n            })}\n          />\n        </li>\n      );\n    });\n  }, [\n    items,\n    itemWidth,\n    handleItemClick,\n    autoScroll,\n    wrapperId,\n    theme,\n    slideShowRunning,\n    cardHeight,\n    onElapsed,\n    children,\n    hasFocus,\n    iconChildren,\n    cardWidth,\n    isNested,\n    nestedCardHeight,\n    getItemProps,\n  ]);\n\n  return (\n    <ul\n      ref={listRef}\n      className={`${timelineHorizontalWrapper} ${wrapperClass}`}\n      style={\n        {\n          direction: flipLayout ? 'rtl' : 'ltr',\n          position: 'relative',\n          // Set CSS variables for the connecting line\n          '--timeline-line-color': theme?.primary || '#2563eb',\n          '--timeline-line-width': `${lineWidth}px`,\n        } as React.CSSProperties\n      }\n      data-testid=\"timeline-collection\"\n      aria-label=\"Timeline\"\n    >\n      {timelineItems}\n    </ul>\n  );\n};\n\nexport default TimelineHorizontal;\n","import { TimelinePointModel } from '@models/TimelineVerticalModel'; // Assuming model path\nimport cls from 'classnames'; // Utility for conditionally joining classNames\nimport React, {\n  memo, // Import memo for component optimization\n  useEffect,\n  useMemo,\n  useRef,\n  FunctionComponent, // Explicit import\n  MouseEvent,\n} from 'react';\nimport {\n  useTimelineStaticConfig,\n  useTimelineMemoizedObjects,\n} from '../contexts';\n// Using shape from veShape import below\nimport {\n  timelinePointContainer,\n  timelinePointWrapper,\n} from './timeline-vertical-shape.css';\nimport * as veShape from './timeline-vertical-shape.css'; // additive VE classes\n\n/**\n * Renders the circular point or icon on the timeline line for a vertical item.\n * Handles click events, active state highlighting, custom icons, and appearance\n * based on global theme and configuration settings. It uses React.memo for\n * performance optimization.\n *\n * @param {TimelinePointModel} props - The properties for the TimelinePoint component.\n * @returns {React.ReactElement} The rendered TimelinePoint component.\n */\nconst TimelinePoint: FunctionComponent<TimelinePointModel> = memo(\n  (props: TimelinePointModel) => {\n    const {\n      className, // 'left' or 'right' - passed to styled components\n      id, // Unique ID of the timeline item\n      onClick, // Callback function when the point is clicked\n      active, // Is this point currently active/highlighted?\n      onActive, // Callback function when the point should trigger the 'active' state calculation\n      slideShowRunning, // Is a slideshow currently active? (disables onClick)\n      iconChild, // Custom React node to display inside the point (replaces default shape)\n      timelinePointDimension, // Size (width/height) of the point\n      lineWidth, // Width of the timeline line connecting points\n      disableClickOnCircle, // Should clicks on the point be ignored?\n      cardLess, // Is the timeline in 'cardLess' mode?\n      isMobile, // Is the view currently mobile?\n    } = props;\n\n    // Ref to the button element representing the point\n    const circleRef = useRef<HTMLButtonElement>(null);\n\n    // Access context settings\n    const {\n      focusActiveItemOnLoad,\n      timelinePointShape,\n      disableTimelinePoint,\n      disableClickOnCircle: contextDisableClickOnCircle,\n      disableInteraction: contextDisableInteraction,\n      disableAutoScrollOnClick: contextDisableAutoScrollOnClick,\n    } = useTimelineStaticConfig();\n\n    const { theme, isDarkMode } = useTimelineMemoizedObjects();\n    const { buttonTexts } = useTimelineMemoizedObjects();\n\n    // Consolidated disable flags - prioritize props over context\n    const finalDisableClickOnCircle =\n      disableClickOnCircle ?? contextDisableClickOnCircle;\n    const finalDisableInteraction = contextDisableInteraction;\n    const finalDisableAutoScrollOnClick = contextDisableAutoScrollOnClick;\n\n    // Ref to track if this is the component's first render cycle\n    const isFirstRender = useRef(true);\n\n    /**\n     * Determines if the onActive callback should be invoked based on the active state\n     * and whether it's the initial render (controlled by focusActiveItemOnLoad).\n     */\n    const canInvokeOnActive = useMemo(() => {\n      // If focusing on load is enabled, invoke if active.\n      if (focusActiveItemOnLoad) {\n        return active;\n      }\n      // Otherwise, invoke only if active AND it's not the first render.\n      else {\n        return active && !isFirstRender.current;\n      }\n    }, [active, focusActiveItemOnLoad]); // Dependencies: active state and global setting\n\n    /**\n     * Effect to call the onActive callback when conditions are met.\n     * This usually happens when an item scrolls into view or is programmatically activated.\n     */\n    useEffect(() => {\n      if (canInvokeOnActive && onActive && circleRef.current) {\n        // Call the parent's onActive handler with the point's offsetTop\n        onActive(circleRef.current.offsetTop);\n      }\n      // Intentionally excluding onActive from dependencies if it's stable,\n      // otherwise, include it if it might change. Usually, it's stable.\n    }, [canInvokeOnActive, active]); // Re-run when activation condition or active state changes\n\n    /**\n     * Memoized CSS classes for the inner Shape component.\n     * Applies 'active' class and 'using-icon' if a custom icon is provided.\n     */\n    const circleClass = useMemo(\n      () =>\n        cls({\n          active: active, // Apply 'active' class if the point is active\n          'using-icon': !!iconChild, // Apply class if a custom icon is used\n        }),\n      [active, iconChild], // Dependencies: active state and presence of iconChild\n    );\n\n    /**\n     * Memoized click handler props for the TimelinePointContainer button.\n     * Only adds onClick if clicks are enabled and slideshow isn't running.\n     */\n    const clickHandlerProps = useMemo(() => {\n      // Return empty object (no click handler) if any disable condition is met\n      if (\n        finalDisableClickOnCircle ||\n        finalDisableInteraction ||\n        finalDisableAutoScrollOnClick\n      ) {\n        return {};\n      }\n\n      // Return props containing the onClick handler\n      return {\n        onClick: (ev: MouseEvent) => {\n          ev.stopPropagation(); // Prevent event bubbling up\n          // Call the provided onClick handler if it exists, passing the item ID\n          if (id && onClick && !slideShowRunning) {\n            onClick(id);\n          }\n        },\n      };\n    }, [\n      id,\n      onClick,\n      slideShowRunning,\n      finalDisableClickOnCircle,\n      finalDisableInteraction,\n      finalDisableAutoScrollOnClick,\n    ]); // Dependencies for the click logic\n\n    /**\n     * Effect to update the isFirstRender flag after the initial render is complete.\n     */\n    useEffect(() => {\n      // This effect runs only once after the initial mount\n      if (isFirstRender.current) {\n        isFirstRender.current = false;\n      }\n    }, []); // Empty dependency array ensures it runs only once\n\n    // Create an accessible label for the timeline point\n    const timelinePointLabel = useMemo(() => {\n      return (\n        buttonTexts?.timelinePoint ??\n        (active ? 'Active timeline point' : 'Timeline point')\n      );\n    }, [active, buttonTexts]);\n\n    return (\n      <div\n        className={`${className} ${timelinePointWrapper}`}\n        style={{\n          ...(isMobile ? { width: '25%' } : { width: '10%' }),\n          ...(lineWidth !== undefined && {\n            '--line-width': `${lineWidth}px`,\n          }),\n        }}\n        data-testid=\"tree-leaf\"\n      >\n        <button\n          className={`${className} timeline-vertical-circle ${timelinePointContainer}`}\n          {...clickHandlerProps}\n          ref={circleRef}\n          data-testid=\"tree-leaf-click\"\n          aria-label={timelinePointLabel}\n          style={{\n            ...(disableTimelinePoint && { visibility: 'hidden' }),\n          }}\n          aria-disabled={\n            finalDisableClickOnCircle ||\n            finalDisableInteraction ||\n            finalDisableAutoScrollOnClick ||\n            disableTimelinePoint\n          }\n          disabled={\n            finalDisableClickOnCircle ||\n            finalDisableInteraction ||\n            finalDisableAutoScrollOnClick ||\n            disableTimelinePoint\n          }\n          tabIndex={-1}\n        >\n          <div\n            className={`${circleClass} ${veShape.shape} ${\n              timelinePointShape === 'diamond' ? 'diamond' : ''\n            } ${active ? 'active' : ''} ${iconChild ? 'using-icon' : ''}`}\n            style={{\n              ...(timelinePointDimension !== undefined && {\n                width: `${timelinePointDimension}px`,\n                height: `${timelinePointDimension}px`,\n              }),\n              // Theme colors are now applied via CSS variables from computeCssVarsFromTheme\n            }}\n            aria-hidden=\"true\"\n          >\n            {iconChild}\n          </div>\n        </button>\n      </div>\n    ) as React.ReactElement;\n  },\n  // Use default shallow comparison for memoization.\n  // The previous custom comparison (prev.active === next.active && prev.isMobile === next.isMobile)\n  // was too restrictive and would prevent updates when other props like iconChild, theme, onClick, etc., changed.\n  // Default shallow comparison is generally safer unless profiling reveals a specific need for a custom function.\n);\n\n// Set display name for React DevTools\nTimelinePoint.displayName = 'TimelinePoint';\n\nexport { TimelinePoint }; // Export the component\n","import { VerticalItemModel } from '@models/TimelineVerticalModel';\nimport cls from 'classnames';\nimport {\n  useCallback,\n  useMemo,\n  useRef,\n  FunctionComponent,\n  ReactElement,\n} from 'react';\nimport { useTimelineContext } from '../contexts';\nimport TimelineCard from '../timeline-elements/timeline-card-content/timeline-card-content';\nimport TimelineItemTitle from '../timeline-elements/timeline-item-title/timeline-card-title';\nimport { TimelinePoint } from './timeline-point';\nimport {\n  timelineCardContentVisible,\n  timelineCardContentWrapper,\n  timelineItemTitleWrapper,\n  verticalItemWrapper,\n  verticalItemWrapperNested,\n} from './timeline-vertical.css';\nimport { pickDefined } from '../../utils/propUtils';\n\n/**\n * Represents a single item (row) in the vertical timeline.\n * It coordinates the display of the title, the central point/icon,\n * and the main content card based on the provided props and global context.\n *\n * @param {VerticalItemModel} props - The properties for the VerticalItem component.\n * @returns {JSX.Element} The rendered VerticalItem component.\n */\nconst VerticalItem: FunctionComponent<VerticalItemModel> = (\n  props: VerticalItemModel,\n): ReactElement => {\n  // Ref to the main list item element for calculating position/dimensions\n  const contentRef = useRef<HTMLLIElement>(null);\n\n  // Destructure all props for cleaner access\n  const {\n    active, // Is this item currently highlighted/active?\n    alternateCards, // Layout mode: alternate card sides?\n    cardDetailedText, // Detailed text content for the card\n    cardSubtitle, // Subtitle/main content for the card\n    cardTitle, // Title specifically for the card (distinct from the timeline item title)\n    url, // URL for navigation, potentially used by the card\n    className, // CSS class for the side ('left' or 'right')\n    contentDetailsChildren, // Custom React nodes for card details area\n    iconChild, // Custom React node for the timeline point/icon\n    hasFocus, // Does the card content have focus (e.g., for slideshow)?\n    id, // Unique ID for the item\n    media, // Media element (image/video) for the card\n    onActive, // Callback when item becomes active (e.g., scrolled into view)\n    onClick, // Callback when the item (or point) is clicked\n    onElapsed, // Callback when media finishes playing (if applicable)\n    slideShowRunning, // Is a slideshow currently active?\n    title, // Title for the timeline item itself (often a date or heading)\n    visible, // Is this item currently visible in the viewport?\n    timelineContent, // Custom React nodes for the main timeline content area\n    items, // Data for nested items (if any)\n    isNested, // Is this item part of a nested structure?\n    nestedCardHeight, // Specific height for nested cards\n    rovingProps, // Roving tabindex props for keyboard navigation (WCAG 2.1.1)\n  } = props;\n\n  // Extract only used context values to avoid unused variable warnings\n  const {\n    theme,\n    mode,\n    flipLayout,\n    lineWidth,\n    cardLess,\n    classNames,\n    timelinePointDimension,\n    disableClickOnCircle,\n    disableInteraction,\n    isMobile,\n    isDarkMode,\n  } = useTimelineContext();\n\n  // Helper functions for layout calculations\n  const calculateCardWidth = useCallback(() => {\n    if (alternateCards) {\n      return isMobile ? '75%' : '37.5%';\n    }\n    return isMobile ? '75%' : '90%';\n  }, [alternateCards, isMobile]);\n\n  const calculateJustifyContent = useCallback(() => {\n    const flip = !alternateCards && flipLayout;\n    if (flip) return 'flex-end';\n    return className === 'left' ? 'flex-end' : 'flex-start';\n  }, [alternateCards, flipLayout, className]);\n\n  const calculateCardOrder = useCallback(() => {\n    if (alternateCards) {\n      // Alternating mode: left side = card first (1), right side = card last (3)\n      return className === 'left' ? 1 : 3;\n    }\n\n    if (flipLayout) {\n      // Vertical flip mode: card first (1)\n      return 1;\n    }\n\n    // Standard vertical mode: card last (3)\n    return 3;\n  }, [alternateCards, flipLayout, className]);\n\n\n  const calculatePointOrder = useCallback(() => {\n    return 2;\n  }, []);\n\n  const calculateEmptySpaceOrder = useCallback(() => {\n    if (alternateCards) {\n      return className === 'left' ? 3 : 1;\n    }\n    return null;\n  }, [alternateCards, className]);\n\n  const EmptySpace = useMemo(() => {\n    if (!alternateCards || isNested) return null;\n    \n    const emptySpaceOrder = calculateEmptySpaceOrder();\n    if (emptySpaceOrder === null) return null;\n    \n    return (\n      <div\n        style={{\n          order: emptySpaceOrder,\n          width: '37.5%',\n          minHeight: '100%',\n          flexShrink: 0,\n          flexGrow: 0,\n        }}\n        aria-hidden=\"true\"\n      />\n    );\n  }, [alternateCards, isNested, calculateEmptySpaceOrder]);\n\n  /**\n   * Callback handler triggered by the TimelinePoint when it becomes active.\n   * Calculates the item's position and notifies the parent.\n   */\n  const handleOnActive = useCallback(\n    (offset: number) => {\n      if (contentRef.current && onActive) {\n        const { offsetTop, clientHeight } = contentRef.current;\n        onActive(offsetTop + offset, offsetTop, clientHeight);\n      }\n    },\n    [onActive],\n  );\n\n  /**\n   * Handler for the \"Read More\" action within the card.\n   * Recalculates position after content changes with a small delay.\n   */\n  const handleShowMore = useCallback(() => {\n    setTimeout(() => handleOnActive(0), 100);\n  }, [handleOnActive]);\n\n\n  /**\n   * Memoized CSS classes for the main VerticalItemWrapper.\n   * Includes the side ('left'/'right'), visibility, and base class.\n   */\n  const verticalItemClass = useMemo(\n    () =>\n      cls(\n        'vertical-item-row',\n        { [className]: !!className },\n        { visible: visible },\n        { 'no-alt': !alternateCards },\n      ),\n    [className, visible, alternateCards],\n  );\n\n  /**\n   * Memoized CSS classes for the TimelineCardContentWrapper.\n   */\n  const contentClass = useMemo(\n    () =>\n      cls(\n        'card-content-wrapper', // Base class\n        { [className]: !!className }, // Add 'left' or 'right'\n        { visible: visible }, // Add 'visible' class\n      ),\n    [className, visible],\n  );\n\n  // TimelinePoint props configuration\n  const timelinePointProps = useMemo(\n    () => ({\n      className,\n      mode,\n      onActive: handleOnActive,\n      onClick: onClick || (() => {}),\n      isMobile,\n      ...pickDefined({\n        active,\n        alternateCards,\n        id,\n        slideShowRunning,\n        iconChild,\n        timelinePointDimension,\n        lineWidth,\n        disableClickOnCircle,\n        cardLess,\n        isNested,\n      }),\n    }),\n    [\n      active,\n      alternateCards,\n      className,\n      id,\n      mode,\n      handleOnActive,\n      onClick,\n      slideShowRunning,\n      iconChild,\n      timelinePointDimension,\n      lineWidth,\n      disableClickOnCircle,\n      cardLess,\n      isMobile,\n      title,\n      theme,\n      isNested,\n    ],\n  );\n\n  const TimelinePointMemo = useMemo(\n    () => (\n      <div\n        style={{\n          order: calculatePointOrder(),\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'stretch',\n          minHeight: '100%',\n          width: '10%',\n          position: 'relative',\n          zIndex: -1,\n          flexShrink: 0,\n          flexGrow: 0,\n        }}\n      >\n        <TimelinePoint {...timelinePointProps} />\n      </div>\n    ),\n    [timelinePointProps, calculatePointOrder],\n  );\n\n\n  // Get a readable title for screen readers\n  const accessibleTitle = useMemo(() => {\n    if (typeof title === 'string') {\n      return title;\n    } else if (typeof cardTitle === 'string') {\n      return cardTitle;\n    } else {\n      return 'Timeline item';\n    }\n  }, [title, cardTitle]);\n\n  // Render the complete timeline item structure\n  return (\n    <li\n      className={`${verticalItemWrapper({\n        visible: visible !== false,\n        alignment: alternateCards\n          ? className === 'left'\n            ? 'left'\n            : 'right'\n          : 'center',\n        alternating: alternateCards,\n      })} ${verticalItemClass} ${isNested ? verticalItemWrapperNested : ''}`}\n      data-testid=\"vertical-item-row\"\n      data-item-id={id}\n      key={id}\n      ref={contentRef}\n      aria-current={active ? 'step' : undefined}\n      aria-label={accessibleTitle}\n      role=\"listitem\"\n      aria-selected={active}\n      tabIndex={rovingProps?.tabIndex ?? -1}\n      onKeyDown={rovingProps?.onKeyDown}\n      onFocus={rovingProps?.onFocus}\n    >\n      {/* Wrapper for the card content */}\n      <div\n        className={`${timelineCardContentWrapper} ${contentClass} ${visible ? timelineCardContentVisible : ''}`}\n        style={{\n          width: calculateCardWidth(),\n          justifyContent: calculateJustifyContent(),\n          order: calculateCardOrder(),\n          display: 'flex',\n          flexDirection: 'column',\n          flexShrink: 0,\n          flexGrow: 0,\n          paddingLeft: alternateCards ? '0' : '0.75rem',\n          paddingRight: alternateCards ? '0' : '0.75rem',\n        }}\n      >\n        {title && !isNested && (\n          <div className={timelineItemTitleWrapper}>\n            <TimelineItemTitle\n              title={title}\n              theme={theme}\n              align=\"left\"\n              {...(active !== undefined\n                ? { active: active && !disableInteraction }\n                : {})}\n              {...pickDefined({\n                classString: classNames?.title,\n              })}\n            />\n          </div>\n        )}\n        {!cardLess && (\n          <TimelineCard\n            branchDir={className}\n            onShowMore={handleShowMore}\n            flip={!alternateCards && flipLayout}\n            {...pickDefined({\n              active,\n              content: cardSubtitle,\n              customContent: contentDetailsChildren,\n              detailedText: cardDetailedText as string | string[],\n              hasFocus,\n              id,\n              media,\n              onElapsed,\n              slideShowActive: slideShowRunning,\n              theme,\n              url,\n              timelineContent,\n              items,\n              isNested,\n              nestedCardHeight,\n              title: cardTitle,\n              cardTitle: title,\n            })}\n            {...(onClick && typeof onClick === 'function' ? { onClick } : {})}\n          />\n        )}\n      </div>\n\n      {/* Empty space for alternating mode to balance layout after removing title column */}\n      {EmptySpace}\n\n      {/* Conditionally render the Timeline Point (hidden for nested items) */}\n      {!isNested ? TimelinePointMemo : null}\n    </li>\n  );\n};\n\n// Set display name for React DevTools\nVerticalItem.displayName = 'VerticalItem';\n\nexport default VerticalItem;\n","import { TimelineVerticalModel } from '@models/TimelineVerticalModel';\nimport {\n  useCallback,\n  FunctionComponent,\n  ReactNode,\n  memo,\n  useMemo,\n  ReactElement,\n} from 'react';\nimport { useTimelineContext } from '../contexts';\nimport TimelineVerticalItem from './timeline-vertical-item';\nimport { timelineVerticalWrapper } from './timeline-vertical.css';\nimport { useRovingTabIndex } from '@hooks/accessibility/useRovingTabIndex';\nimport React from 'react';\n\n/**\n * Renders the main vertical timeline structure.\n * It maps over the provided `items` array and renders a `TimelineVerticalItem`\n * for each, handling layout variations (like alternating cards) and distributing\n * props and callbacks appropriately.\n *\n * Implements roving tabindex pattern for keyboard navigation (WCAG 2.1.1)\n * Up/Down arrows navigate timeline items, Tab moves to next component\n *\n * @param {TimelineVerticalModel} props - The properties for the TimelineVertical component.\n * @returns {JSX.Element} The rendered TimelineVertical component.\n */\nconst TimelineVertical: FunctionComponent<TimelineVerticalModel> = memo(\n  ({\n    // Props with default values\n    alternateCards = true, // Default to alternating card layout on desktop\n    // Callbacks and data props\n    autoScroll, // Function to handle automatic scrolling when an item becomes active\n    contentDetailsChildren, // Optional array of custom nodes for each item's card details\n    hasFocus, // Does the timeline component itself have focus? (Passed down)\n    iconChildren, // Optional custom icon(s) for the timeline points\n    items, // Array of timeline item data objects\n    mode, // Timeline mode (e.g., VERTICAL, VERTICAL_ALTERNATING) - Used by children via context?\n    onClick, // Global click handler for items (passed down)\n    onElapsed, // Global handler for media elapsed events (passed down)\n    onOutlineSelection, // Handler for outline selection (potentially unused here, passed down?)\n    slideShowRunning, // Is a slideshow active? (Passed down)\n    theme, // Theme object (Used by children via context)\n    cardLess, // Render without cards? (Passed down)\n    nestedCardHeight, // Specific height for nested cards (Passed down)\n  }: TimelineVerticalModel): ReactElement => {\n    // Use responsive detection from context instead of hardcoding based on mode\n    // This enables proper responsive behavior for VERTICAL_ALTERNATING mode\n    const { isMobile, focusActiveItemOnLoad } = useTimelineContext();\n\n    /**\n     * Initialize roving tabindex for timeline items (WCAG 2.1.1: Keyboard)\n     * Handles Up/Down arrow key navigation through timeline items\n     * Only active item has tabIndex={0}, others have tabIndex={-1}\n     */\n    const rovingItemsConfig = useMemo(\n      () =>\n        items.map((item, index) => ({\n          id: item.id || `item-${index}`,\n          disabled: false,\n        })),\n      [items],\n    );\n\n    const { getItemProps } = useRovingTabIndex({\n      items: rovingItemsConfig,\n      orientation: 'vertical',\n      loop: false, // Explicit navigation, don't loop around\n      focusOnLoad: focusActiveItemOnLoad, // Respect focus-on-load setting\n    });\n\n    /**\n     * Callback handler passed to each TimelineVerticalItem's onActive.\n     * When an item becomes active (e.g., scrolls into view), this triggers the autoScroll function\n     * provided via props, allowing the parent component to scroll the timeline if needed.\n     * @param {number} offset - Vertical offset within the active item's point element.\n     * @param {number} wrapperOffset - The offsetTop of the active item's wrapper relative to the scroll parent.\n     * @param {number} height - The clientHeight of the active item's wrapper.\n     */\n    const handleOnActive = useCallback(\n      (offset: number, wrapperOffset: number, height: number) => {\n        // Call the autoScroll prop function if it exists\n        autoScroll?.({\n          contentHeight: height,\n          contentOffset: wrapperOffset,\n          pointOffset: offset,\n        });\n      },\n      [autoScroll], // Dependency: only recreate if autoScroll function changes\n    );\n\n    // Memoize the items rendering to avoid unnecessary recreations\n    const renderItems = useMemo(() => {\n      return items.map((item, index: number) => {\n        let itemClassName = ''; // CSS class for layout ('left' or 'right')\n\n        // Determine layout class based on mode and index\n        // In alternating mode on non-mobile views, alternate 'left' and 'right'\n        if (alternateCards && !isMobile) {\n          itemClassName = index % 2 === 0 ? 'left' : 'right';\n        }\n        // Otherwise (non-alternating or mobile), default to 'right'\n        else {\n          itemClassName = 'right';\n        }\n\n        // Extract specific content details node for this item, if provided\n        const contentDetails: ReactNode | null =\n          (contentDetailsChildren &&\n            Array.isArray(contentDetailsChildren) && // Ensure it's an array\n            contentDetailsChildren[index]) ?? // Get node at the current index\n          null;\n\n        // Determine the custom icon for this item\n        let customIcon: ReactNode | null = null;\n        if (Array.isArray(iconChildren)) {\n          // If iconChildren is an array, map icon to item by index\n          customIcon = iconChildren[index] ?? null;\n        } else if (iconChildren) {\n          // If iconChildren is a single node, apply it to all items\n          customIcon = iconChildren;\n        }\n\n        // Get roving tabindex props for this item\n        const itemId = item.id || `item-${index}`;\n        const rovingProps = getItemProps(itemId) as any;\n\n        // Render the individual timeline item component\n        return (\n          <TimelineVerticalItem\n            key={item.id || index} // Add key prop for React list rendering\n            {...item} // Spread all properties from the item data object\n            // --- Pass down calculated or specific props ---\n            alternateCards={alternateCards} // Pass down the alternating mode flag\n            className={itemClassName} // Pass down the calculated 'left'/'right' class\n            contentDetailsChildren={contentDetails} // Pass down the specific content details node\n            iconChild={customIcon} // Pass down the specific icon node\n            hasFocus={!!hasFocus} // Pass down the focus state\n            index={index} // Pass down the item's index\n            onActive={handleOnActive} // Pass down the memoized active handler\n            onClick={onClick} // Pass down the global click handler\n            onElapsed={onElapsed || (() => {})} // Pass down the global elapsed handler\n            // Removed onShowMore as the handler was empty\n            slideShowRunning={!!slideShowRunning} // Pass down the slideshow state\n            cardLess={!!cardLess} // Pass down the cardLess flag\n            nestedCardHeight={nestedCardHeight ?? 0} // Pass down the nested card height\n            rovingProps={rovingProps} // Pass roving tabindex props\n          />\n        );\n      });\n    }, [\n      items,\n      isMobile,\n      alternateCards,\n      contentDetailsChildren,\n      iconChildren,\n      hasFocus,\n      handleOnActive,\n      onClick,\n      onElapsed,\n      slideShowRunning,\n      cardLess,\n      nestedCardHeight,\n      getItemProps,\n    ]);\n\n    // Render the main timeline wrapper\n    return (\n      <ul\n        className={timelineVerticalWrapper}\n        data-testid=\"tree-main\"\n        data-cardless={cardLess}\n        role=\"list\"\n        aria-label=\"Timeline events\"\n      >\n        {renderItems}\n      </ul>\n    );\n  },\n);\n\n// Set display name for React DevTools\nTimelineVertical.displayName = 'TimelineVertical';\n\nexport default TimelineVertical;\n","import React from 'react';\nimport { TimelineMode } from '@models/TimelineModel';\nimport TimelineHorizontal from '../timeline-horizontal/timeline-horizontal';\nimport TimelineVertical from '../timeline-vertical/timeline-vertical';\nimport { Scroll } from '@models/TimelineHorizontalModel';\nimport { main as timelineMain } from './timeline-new.css';\nimport { pickDefined } from '../../utils/propUtils';\n\ninterface TimelineViewProps {\n  timelineMode: string;\n  activeTimelineItem: number;\n  autoScroll: (scroll: Partial<Scroll>) => void;\n  contentDetailsChildren?: React.ReactNode;\n  hasFocus: boolean;\n  iconChildren?: React.ReactNode;\n  items: any[]; // Using any to avoid type conflicts\n  handleTimelineItemClick: (itemId?: string) => void;\n  handleTimelineItemElapsed: (itemId?: string) => void;\n  slideShowRunning?: boolean;\n  id: string;\n  theme?: any;\n  lineWidth?: number;\n  onOutlineSelection?: (index: number) => void;\n  nestedCardHeight: number;\n}\n\nconst TimelineView: React.FC<TimelineViewProps> = ({\n  timelineMode,\n  activeTimelineItem,\n  autoScroll,\n  contentDetailsChildren,\n  hasFocus,\n  iconChildren,\n  items,\n  handleTimelineItemClick,\n  handleTimelineItemElapsed,\n  slideShowRunning,\n  id,\n  theme,\n  lineWidth,\n  onOutlineSelection,\n  nestedCardHeight,\n}) => {\n  // Horizontal Timeline (regular or \"all cards\" mode)\n  if (timelineMode === 'HORIZONTAL' || timelineMode === 'HORIZONTAL_ALL') {\n    return (\n      <TimelineHorizontal\n        autoScroll={autoScroll}\n        contentDetailsChildren={contentDetailsChildren}\n        handleItemClick={handleTimelineItemClick}\n        hasFocus={hasFocus}\n        iconChildren={iconChildren}\n        items={items}\n        mode={timelineMode as TimelineMode}\n        onElapsed={handleTimelineItemElapsed}\n        wrapperId={id}\n        nestedCardHeight={nestedCardHeight}\n        theme={theme}\n        {...(lineWidth !== undefined && { lineWidth })}\n        {...pickDefined({\n          slideShowRunning,\n        })}\n      />\n    );\n  }\n\n  // Vertical Alternating Timeline\n  if (timelineMode === 'VERTICAL_ALTERNATING') {\n    return (\n      <TimelineVertical\n        activeTimelineItem={activeTimelineItem}\n        alternateCards={true}\n        autoScroll={autoScroll}\n        contentDetailsChildren={contentDetailsChildren}\n        hasFocus={hasFocus}\n        iconChildren={iconChildren}\n        items={items}\n        mode={timelineMode as TimelineMode}\n        onClick={handleTimelineItemClick}\n        onElapsed={handleTimelineItemElapsed}\n        theme={theme}\n        nestedCardHeight={nestedCardHeight}\n        {...pickDefined({\n          slideShowRunning,\n        })}\n      />\n    );\n  }\n\n  // Vertical Timeline (default)\n  return (\n    <TimelineVertical\n      activeTimelineItem={activeTimelineItem}\n      alternateCards={false}\n      autoScroll={autoScroll}\n      contentDetailsChildren={contentDetailsChildren}\n      hasFocus={hasFocus}\n      iconChildren={iconChildren}\n      items={items}\n      mode={timelineMode as TimelineMode}\n      onClick={handleTimelineItemClick}\n      onElapsed={handleTimelineItemElapsed}\n      theme={theme}\n      nestedCardHeight={nestedCardHeight}\n      {...pickDefined({\n        slideShowRunning,\n        onOutlineSelection,\n      })}\n    />\n  );\n};\n\nexport default React.memo(TimelineView);\n","import { TimelineModel, TextDensity } from '@models/TimelineModel';\nimport { getUniqueID } from '@utils/index';\nimport cls from 'classnames';\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  useRef,\n} from 'react';\nimport { useTimelineContext } from '../contexts';\nimport useNewScrollPosition from '../effects/useNewScrollPosition';\nimport { useSlideshowProgress } from '../../hooks/useSlideshowProgress';\nimport * as ve from './timeline-new.css';\n// Note: Removed unused imports from timeline-main.css\nimport { computeCssVarsFromTheme } from '../../styles/theme-bridge';\nimport { lightThemeClass, darkThemeClass } from '../../styles/themes.css';\nimport { TimelineToolbar } from './timeline-toolbar';\nimport { useTimelineSearch } from '../../hooks/useTimelineSearch';\nimport { useTimelineNavigation } from '../../hooks/useTimelineNavigation';\nimport { useTimelineMode } from '../../hooks/useTimelineMode';\nimport { useTimelineScroll } from '../../hooks/useTimelineScroll';\nimport { useTimelineMedia } from '../../hooks/useTimelineMedia';\nimport { FontProvider } from '../fonts/font-provider';\nimport TimelineView from './TimelineView';\n\n// Disable TypeScript checking for the Timeline component\n// as we're addressing the type conflicts through our custom hooks\nconst Timeline: React.FunctionComponent<TimelineModel> = (\n  props: TimelineModel,\n) => {\n  // de-structure the props\n  const {\n    activeTimelineItem,\n    contentDetailsChildren,\n    iconChildren,\n    items = [],\n    mode: propMode,\n    onFirst,\n    onLast,\n    onNext,\n    onPrevious,\n    onRestartSlideshow,\n    onTimelineUpdated,\n    onItemSelected,\n    onOutlineSelection,\n    slideShowEnabled,\n    slideShowRunning,\n    slideItemDuration = 2000,\n    nestedCardHeight,\n    isChild = false,\n    onPaused,\n    uniqueId,\n    noUniqueId,\n  } = props;\n\n  // Use unified context\n  const {\n    // Navigation context properties\n    scrollable,\n    disableNavOnKey,\n    disableInteraction,\n    onScrollEnd,\n\n    // Theme context properties\n    theme,\n    isDarkMode: darkMode,\n    toggleDarkMode,\n\n    // Layout context properties\n    mode,\n    cardHeight,\n    cardLess,\n    flipLayout,\n    itemWidth,\n    lineWidth,\n    toolbarPosition,\n    disableToolbar,\n    toolbarSearchConfig,\n    borderLessCards,\n    showAllCardsHorizontal,\n    textContentDensity,\n    enableLayoutSwitch,\n    useReadMore,\n    cardPositionHorizontal,\n    updateShowAllCardsHorizontal: updateHorizontalAllCards,\n    updateTextContentDensity,\n\n    // Focus behavior\n    focusActiveItemOnLoad,\n\n    // Font properties\n    googleFonts,\n  } = useTimelineContext();\n  const [hasFocus, setHasFocus] = useState(false);\n  const [isKeyboardNavigation, setIsKeyboardNavigation] = useState(false);\n  // Use ref instead of state to avoid race conditions with useEffect (WCAG 2.4.3: Focus Order)\n  // Refs are synchronously updated, ensuring focus prevention logic sees latest value\n  const isToolbarNavigationRef = useRef(false);\n  // Track if current navigation is from search to enable/disable focus (WCAG 2.1.1: Keyboard)\n  // Timeline items should ONLY receive focus during search navigation, not in other scenarios\n  const isSearchNavigationRef = useRef(false);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const wrapperRef = useRef<HTMLDivElement>(null);\n  const keyboardTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  // Track if this is the initial render to prevent auto-focus unless focusActiveItemOnLoad is true\n  const isInitialRenderRef = useRef(true);\n  // Track if we've made the initial focus decision (to handle multiple useEffect runs on mount)\n  const hasInitialFocusedRef = useRef(false);\n\n  // Listen to native fullscreen change events to keep state in sync\n  useEffect(() => {\n    const handleFullscreenChange = () => {\n      const doc = document as Document & {\n        webkitFullscreenElement?: Element;\n        mozFullScreenElement?: Element;\n        msFullscreenElement?: Element;\n      };\n\n      const isCurrentlyFullscreen = !!(\n        doc.fullscreenElement ||\n        doc.webkitFullscreenElement ||\n        doc.mozFullScreenElement ||\n        doc.msFullscreenElement\n      );\n      setIsFullscreen(isCurrentlyFullscreen);\n    };\n\n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);\n    document.addEventListener('mozfullscreenchange', handleFullscreenChange);\n    document.addEventListener('msfullscreenchange', handleFullscreenChange);\n\n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n      document.removeEventListener(\n        'webkitfullscreenchange',\n        handleFullscreenChange,\n      );\n      document.removeEventListener(\n        'mozfullscreenchange',\n        handleFullscreenChange,\n      );\n      document.removeEventListener(\n        'msfullscreenchange',\n        handleFullscreenChange,\n      );\n      // Cleanup keyboard timeout\n      if (keyboardTimeoutRef.current) {\n        clearTimeout(keyboardTimeoutRef.current);\n        keyboardTimeoutRef.current = null;\n      }\n    };\n  }, []);\n\n  // Focus first timeline item when entering fullscreen (WCAG 2.4.3: Focus Order)\n  // This ensures keyboard users can immediately navigate the timeline after fullscreen\n  useEffect(() => {\n    if (!isFullscreen || !items.length) return;\n\n    // Use requestAnimationFrame to ensure DOM is updated\n    requestAnimationFrame(() => {\n      // Check if search is active - don't steal focus if user is searching\n      const activeElement = document.activeElement;\n      const isSearchActive =\n        activeElement?.tagName === 'INPUT' &&\n        (activeElement as HTMLInputElement).type === 'search';\n\n      if (isSearchActive) return;\n\n      // Find first timeline item and focus it\n      const firstItem = timelineMainRef.current?.querySelector(\n        '[data-testid=\"vertical-item-row\"], [data-testid=\"timeline-circle\"]',\n      ) as HTMLElement | null;\n\n      if (firstItem) {\n        try {\n          firstItem.focus({ preventScroll: true });\n        } catch (_) {\n          // Silently ignore focus errors (element may not be focusable)\n        }\n      }\n    });\n  }, [isFullscreen, items.length]);\n\n  // Memoize ID generation to prevent unnecessary regeneration\n  const id = useMemo(\n    () => `react-chrono-timeline-${noUniqueId ? uniqueId : getUniqueID()}`,\n    [noUniqueId, uniqueId],\n  );\n\n  // Use custom hooks - prioritize component prop mode over context mode\n  const { timelineMode, handleTimelineUpdate } = useTimelineMode({\n    initialMode: propMode || mode, // Prioritize prop mode over context mode\n    showAllCardsHorizontal,\n    updateHorizontalAllCards,\n  });\n\n  const [newOffSet, setNewOffset] = useNewScrollPosition(\n    timelineMode,\n    itemWidth,\n  );\n\n  // Ensure context's showAllCardsHorizontal stays in sync with computed mode\n  useEffect(() => {\n    if (timelineMode === 'HORIZONTAL_ALL') {\n      updateHorizontalAllCards(true);\n    } else if (timelineMode === 'HORIZONTAL') {\n      updateHorizontalAllCards(false);\n    }\n  }, [timelineMode, updateHorizontalAllCards]);\n\n  // First get the navigation functions\n  const {\n    activeItemIndex,\n    handleTimelineItemClick: handleTimelineItemClickInternal,\n    handleTimelineItemElapsed,\n    handleNext: handleNextInternal,\n    handlePrevious: handlePreviousInternal,\n    handleFirst: handleFirstInternal,\n    handleLast: handleLastInternal,\n    handleKeySelection,\n    syncActiveItemIndex,\n  } = useTimelineNavigation({\n    items,\n    mode: timelineMode,\n    timelineId: id,\n    hasFocus,\n    flipLayout: !!flipLayout,\n    slideShowRunning: !!slideShowRunning,\n    isKeyboardNavigation: !!isKeyboardNavigation,\n    isToolbarNavigationRef,\n    onTimelineUpdated: onTimelineUpdated || (() => {}),\n    onNext: onNext || (() => {}),\n    onPrevious: onPrevious || (() => {}),\n    onFirst: onFirst || (() => {}),\n    onLast: onLast || (() => {}),\n  });\n\n  const {\n    timelineMainRef,\n    horizontalContentRef,\n    handleScroll,\n    handleMainScroll,\n  } = useTimelineScroll({\n    mode: timelineMode,\n    onScrollEnd: onScrollEnd || (() => {}),\n    setNewOffset,\n    onNextItem: handleNextInternal,\n    onPreviousItem: handlePreviousInternal,\n    activeItemIndex: activeItemIndex,\n    totalItems: items.length,\n    isKeyboardNavigation: isKeyboardNavigation,\n  });\n\n  // Navigation functions are now available from the earlier useTimelineNavigation call\n\n  // Wrap timeline item click to reset navigation states\n  const handleTimelineItemClick = React.useCallback(\n    (itemId?: string, isSlideShow?: boolean) => {\n      // Capture whether search is active NOW, before any RAF callbacks run\n      // This prevents timing issues where focus changes before RAF executes\n      const wasSearchActive =\n        document.activeElement?.tagName === 'INPUT' &&\n        (document.activeElement as HTMLInputElement).type === 'search';\n\n      // Reset navigation states when clicking directly on items\n      setIsKeyboardNavigation(false);\n      isToolbarNavigationRef.current = false;\n      handleTimelineItemClickInternal(itemId, isSlideShow);\n\n      // DISABLED: Direct click focus\n      // Timeline items should ONLY receive focus during search navigation (WCAG 2.1.1: Keyboard)\n      // Not during direct clicks, keyboard navigation, or other scenarios\n      // Focus logic is now centralized in the main useEffect and only triggered for search\n      /*\n      if (itemId) {\n        requestAnimationFrame(() => {\n          const verticalRow = document.querySelector(\n            `[data-testid=\"vertical-item-row\"][data-item-id=\"${itemId}\"]`,\n          ) as HTMLElement | null;\n          const target =\n            verticalRow ||\n            (document.getElementById(\n              `timeline-card-${itemId}`,\n            ) as HTMLElement | null);\n\n          try {\n            // Only focus card if search was NOT active when function was called\n            // Timeline card is still updated/scrolled, just not focused\n            if (!wasSearchActive) {\n              target?.focus?.({ preventScroll: true });\n            }\n          } catch {}\n        });\n      }\n      */\n    },\n    [handleTimelineItemClickInternal],\n  );\n\n  // Enhanced navigation handlers that track source\n  // WCAG 2.4.3: Keep focus on toolbar button during activation (not on timeline item)\n  const handleNext = React.useCallback(\n    (event?: React.MouseEvent | React.KeyboardEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      handleNextInternal();\n      // Explicitly refocus button after navigation to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [handleNextInternal],\n  );\n\n  const handlePrevious = React.useCallback(\n    (event?: React.MouseEvent | React.KeyboardEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      handlePreviousInternal();\n      // Explicitly refocus button after navigation to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [handlePreviousInternal],\n  );\n\n  const handleFirst = React.useCallback(\n    (event?: React.MouseEvent | React.KeyboardEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      handleFirstInternal();\n      // Explicitly refocus button after navigation to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [handleFirstInternal],\n  );\n\n  const handleLast = React.useCallback(\n    (event?: React.MouseEvent | React.KeyboardEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      handleLastInternal();\n      // Explicitly refocus button after navigation to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [handleLastInternal],\n  );\n\n  // Wrap toggleDarkMode to prevent focus stealing (WCAG 2.4.3)\n  const handleToggleDarkMode = React.useCallback(\n    (event?: React.MouseEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      toggleDarkMode?.();\n      // Explicitly refocus button after action to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [toggleDarkMode],\n  );\n\n  // Wrap onRestartSlideshow to prevent focus stealing (WCAG 2.4.3)\n  const handleRestartSlideshow = React.useCallback(\n    (event?: React.MouseEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      onRestartSlideshow?.();\n      // Explicitly refocus button after action to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [onRestartSlideshow],\n  );\n\n  // Wrap onPaused to prevent focus stealing (WCAG 2.4.3)\n  const handlePausedWrapper = React.useCallback(\n    (event?: React.MouseEvent) => {\n      const clickedButton = (event?.currentTarget as HTMLElement) || null;\n      isToolbarNavigationRef.current = true;\n      setIsKeyboardNavigation(false);\n      onPaused?.();\n      // Explicitly refocus button after action to prevent focus stealing\n      requestAnimationFrame(() => {\n        if (clickedButton) {\n          try {\n            clickedButton.focus({ preventScroll: true });\n          } catch (_) {\n            // Silently ignore focus errors\n          }\n        }\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [onPaused],\n  );\n\n  // Wrap popover callbacks to prevent focus stealing to timeline items\n  // These callbacks trigger timeline state changes that would normally cause focus to jump to timeline items\n  // By setting isToolbarNavigationRef.current = true, we signal to the main focus useEffect to skip timeline focus\n  const wrappedOnActivateTimelineItem = React.useCallback(\n    (itemId?: string) => {\n      isToolbarNavigationRef.current = true;\n      handleTimelineItemClick(itemId);\n      // Note: RAF cleanup happens in handleTimelineItemClick via isToolbarNavigationRef reset\n    },\n    [handleTimelineItemClick],\n  );\n\n  const wrappedOnUpdateTimelineMode = React.useCallback(\n    (newMode: string) => {\n      isToolbarNavigationRef.current = true;\n      handleTimelineUpdate(newMode);\n      // Reset after state update completes\n      requestAnimationFrame(() => {\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [handleTimelineUpdate],\n  );\n\n  const wrappedOnUpdateTextContentDensity = React.useCallback(\n    (density: string) => {\n      isToolbarNavigationRef.current = true;\n      updateTextContentDensity(density as TextDensity);\n      // Reset after state update completes\n      requestAnimationFrame(() => {\n        isToolbarNavigationRef.current = false;\n      });\n    },\n    [updateTextContentDensity],\n  );\n\n  // Sync activeItemIndex with activeTimelineItem prop\n  // FOCUS COORDINATION STRATEGY:\n  // This effect manages timeline item focus when activeTimelineItem changes.\n  // It coordinates with other focus operations through several mechanisms:\n  // 1. Search input focus is protected - never stolen during search\n  // 2. Toolbar button focus is protected - never stolen while using toolbar\n  // 3. All focus operations use requestAnimationFrame for proper sequencing\n  // 4. Popover focus is restored to trigger button via useCloseClickOutside\n  // 5. Search navigation returns focus to search input via useTimelineSearch\n  // Order of precedence: Search focus > Toolbar focus > Timeline focus\n  useEffect(() => {\n    // For defined activeTimelineItem, always sync\n    if (activeTimelineItem !== undefined) {\n      if (activeTimelineItem !== activeItemIndex.current) {\n        syncActiveItemIndex(activeTimelineItem);\n      }\n    } else {\n      // For undefined activeTimelineItem (no selection), reset to -1 to indicate no selection\n      // This helps with navigation logic\n      if (activeItemIndex.current !== -1) {\n        activeItemIndex.current = -1;\n      }\n    }\n\n    // CRITICAL: Only focus timeline items during search navigation (WCAG 2.1.1: Keyboard)\n    // Timeline items should NOT auto-focus for keyboard navigation, toolbar buttons, slideshow, etc.\n    if (!isSearchNavigationRef.current) {\n      return;\n    }\n\n    if (activeTimelineItem !== undefined) {\n      // Move keyboard focus to the active element once activation changes\n      // This is ONLY called during search navigation\n      // CRITICAL: Capture search state NOW before scheduling RAF to avoid timing issues\n      const activeElement = document.activeElement;\n      const wasSearchActive =\n        activeElement?.tagName === 'INPUT' &&\n        (activeElement as HTMLInputElement).type === 'search';\n\n      // Don't steal focus from toolbar buttons (navigation, play, dark mode, popovers, fullscreen)\n      const isToolbarFocused =\n        activeElement?.closest('[role=\"toolbar\"]') !== null;\n\n      if (timelineMode === 'HORIZONTAL' || timelineMode === 'HORIZONTAL_ALL') {\n        requestAnimationFrame(() => {\n          // Only focus if search is still marked as active and conditions allow focus\n          if (\n            !isSearchNavigationRef.current ||\n            wasSearchActive ||\n            isToolbarFocused\n          )\n            return;\n\n          const activeId = items[activeTimelineItem ?? 0]?.id;\n          if (activeId) {\n            // Prefer focusing the card container in horizontal modes\n            const cardContainer = document.getElementById(\n              `timeline-card-${activeId}`,\n            );\n            if (cardContainer) {\n              try {\n                (cardContainer as HTMLElement).focus({ preventScroll: false });\n                return;\n              } catch (_) {\n                // fall through to point focus\n              }\n            }\n\n            const circle = document.querySelector(\n              `button[data-testid=\"timeline-circle\"][data-item-id=\"${activeId}\"]`,\n            ) as HTMLButtonElement | null;\n            if (circle) {\n              try {\n                circle.focus({ preventScroll: false });\n                return;\n              } catch (_) {\n                // fall through\n              }\n            }\n          }\n          const ele = timelineMainRef.current;\n          if (ele) {\n            ele.focus({ preventScroll: false });\n          }\n        });\n      } else if (\n        timelineMode === 'VERTICAL' ||\n        timelineMode === 'VERTICAL_ALTERNATING'\n      ) {\n        // In vertical modes, focus the vertical row (li) for the active item\n        requestAnimationFrame(() => {\n          // Only focus if search is still marked as active and conditions allow focus\n          if (\n            !isSearchNavigationRef.current ||\n            wasSearchActive ||\n            isToolbarFocused\n          )\n            return;\n\n          const activeId = items[activeTimelineItem ?? 0]?.id;\n          if (activeId) {\n            const verticalRow = document.querySelector(\n              `[data-testid=\"vertical-item-row\"][data-item-id=\"${activeId}\"]`,\n            ) as HTMLElement | null;\n            if (verticalRow) {\n              try {\n                verticalRow.focus({ preventScroll: false });\n                return;\n              } catch (_) {\n                // fall back to container focus\n              }\n            }\n          }\n          const ele = timelineMainRef.current;\n          if (ele) {\n            ele.focus({ preventScroll: false });\n          }\n        });\n      }\n\n      // Clear search navigation marker after focus operations are scheduled\n      // This ensures the ref is reset for next search navigation\n      requestAnimationFrame(() => {\n        isSearchNavigationRef.current = false;\n      });\n    }\n  }, [\n    activeTimelineItem,\n    syncActiveItemIndex,\n    mode,\n    timelineMode,\n    timelineMainRef,\n    items,\n  ]);\n\n  // Wrapper callbacks for search navigation that mark it as search-triggered\n  // This ensures timeline items only receive focus during search (WCAG 2.1.1: Keyboard)\n  const wrappedOnTimelineUpdated = useCallback(\n    (index: number) => {\n      isSearchNavigationRef.current = true;\n      (onTimelineUpdated || (() => {}))(index);\n    },\n    [onTimelineUpdated],\n  );\n\n  const wrappedHandleTimelineItemClick = useCallback(\n    (itemId?: string) => {\n      isSearchNavigationRef.current = true;\n      handleTimelineItemClick(itemId);\n    },\n    [handleTimelineItemClick],\n  );\n\n  const {\n    searchQuery,\n    searchResults,\n    currentMatchIndex,\n    searchInputRef,\n    handleSearchChange,\n    triggerSearch,\n    clearSearch,\n    handleNextMatch,\n    handlePreviousMatch,\n    handleSearchKeyDown,\n  } = useTimelineSearch({\n    items: useMemo(\n      () => items.map((item) => ({ ...item, wrapperId: id })),\n      [items, id],\n    ),\n    onTimelineUpdated: wrappedOnTimelineUpdated,\n    handleTimelineItemClick: wrappedHandleTimelineItemClick,\n  });\n\n  // Overall slideshow progress hook\n  useSlideshowProgress({\n    slideShowRunning: slideShowRunning ?? false,\n    activeTimelineItem: activeTimelineItem ?? 0,\n  });\n\n  useTimelineMedia({\n    mode,\n    timelineMainRef,\n  });\n\n  // Memoize classes and display flags\n  const wrapperClass = useMemo(\n    () =>\n      cls(mode.toLocaleLowerCase(), ve.wrapper, {\n        'focus-visible': !isChild,\n        'js-focus-visible': !isChild,\n      }),\n    [mode, isChild],\n  );\n\n  const canShowToolbar = useMemo(\n    () => !disableToolbar && !isChild,\n    [isChild, disableToolbar],\n  );\n\n  // Handle keyboard events\n  const handleKeyDown = React.useCallback(\n    (evt: React.KeyboardEvent<HTMLDivElement>) => {\n      if (!disableNavOnKey && !slideShowRunning) {\n        const isNavigationKey = [\n          'ArrowLeft',\n          'ArrowRight',\n          'ArrowUp',\n          'ArrowDown',\n          'Home',\n          'End',\n        ].includes(evt.key);\n\n        if (isNavigationKey) {\n          setHasFocus(true);\n          setIsKeyboardNavigation(true);\n          isToolbarNavigationRef.current = false;\n          handleKeySelection(evt);\n\n          // Clear keyboard navigation flag after scroll animation completes\n          if (keyboardTimeoutRef.current) {\n            clearTimeout(keyboardTimeoutRef.current);\n          }\n          keyboardTimeoutRef.current = setTimeout(() => {\n            setIsKeyboardNavigation(false);\n            keyboardTimeoutRef.current = null;\n          }, 400); // Slightly longer than scroll animation (300ms)\n        }\n      }\n    },\n    [disableNavOnKey, slideShowRunning, handleKeySelection],\n  );\n\n  // Handle focus events to maintain proper focus state\n  const handleFocus = React.useCallback(\n    (evt: React.FocusEvent<HTMLDivElement>) => {\n      // Don't manage focus if it's coming from within toolbar (search, buttons, etc)\n      const timelineToolbar = (evt.currentTarget as HTMLElement).querySelector(\n        '[role=\"toolbar\"]',\n      );\n      const isFocusFromToolbar = timelineToolbar?.contains(evt.target as Node);\n\n      if (isFocusFromToolbar) {\n        return; // Let toolbar items operate independently\n      }\n\n      if (!slideShowRunning) {\n        setHasFocus(true);\n      }\n    },\n    [slideShowRunning],\n  );\n\n  const handleBlur = React.useCallback(\n    (evt: React.FocusEvent<HTMLDivElement>) => {\n      // Don't manage focus if blur is due to focus moving within toolbar\n      const timelineToolbar = (evt.currentTarget as HTMLElement).querySelector(\n        '[role=\"toolbar\"]',\n      );\n      const isBlurWithinToolbar = timelineToolbar?.contains(\n        evt.relatedTarget as Node,\n      );\n\n      if (isBlurWithinToolbar) {\n        return; // Let toolbar items manage their own focus\n      }\n\n      // Only lose focus if focus is moving outside the timeline entirely\n      const relatedTarget = evt.relatedTarget as HTMLElement;\n      const currentTarget = evt.currentTarget as HTMLElement;\n\n      // Check if focus is moving to a child element (like timeline cards)\n      if (!currentTarget.contains(relatedTarget)) {\n        // Only set hasFocus to false if focus is truly leaving the timeline\n        setHasFocus(false);\n      }\n    },\n    [],\n  );\n\n  // Update active item information\n  useEffect(() => {\n    // CRITICAL: Capture search state NOW to prevent timing issues with RAF callbacks\n    // This ensures we check the state at the moment this effect runs, not later\n    const wasSearchActive =\n      document.activeElement?.tagName === 'INPUT' &&\n      (document.activeElement as HTMLInputElement).type === 'search';\n\n    if (wasSearchActive) {\n      return; // Don't do any focus-stealing operations while searching\n    }\n\n    const activeItem = items[activeTimelineItem ?? 0];\n\n    if (slideShowRunning) {\n      activeItemIndex.current = activeTimelineItem ?? 0;\n    }\n\n    if (!items.length || !activeItem) return;\n\n    const { title, cardTitle, cardSubtitle, cardDetailedText } = activeItem;\n\n    // Use the activeTimelineItem directly instead of activeItemIndex.current\n    // to prevent infinite loops caused by ref changes\n    onItemSelected?.({\n      cardDetailedText,\n      cardSubtitle,\n      cardTitle,\n      index: activeTimelineItem ?? 0,\n      title,\n    });\n\n    // Determine if we should focus elements\n    // During initial mount (tracked by isInitialRenderRef): only focus if focusActiveItemOnLoad is true\n    // After mount: always focus for subsequent navigations\n    const shouldFocus = isInitialRenderRef.current\n      ? focusActiveItemOnLoad\n      : true;\n\n    // Mark that initial render is complete AFTER this effect runs\n    // Use setTimeout to ensure this happens after all synchronous code\n    if (isInitialRenderRef.current) {\n      setTimeout(() => {\n        isInitialRenderRef.current = false;\n      }, 0);\n    }\n\n    console.log('Timeline focus decision:', {\n      isInitialRender: isInitialRenderRef.current,\n      focusActiveItemOnLoad,\n      shouldFocus,\n      activeTimelineItem,\n      timelineMode,\n    });\n\n    // Handle centering for both slideshow and manual navigation\n    if (timelineMode === 'HORIZONTAL' || timelineMode === 'HORIZONTAL_ALL') {\n      const card = horizontalContentRef.current?.querySelector(\n        `#timeline-card-${activeItem.id}`,\n      );\n\n      if (card && horizontalContentRef.current) {\n        const cardRect = card.getBoundingClientRect();\n        const contentRect =\n          horizontalContentRef.current.getBoundingClientRect();\n\n        if (cardRect && contentRect) {\n          const { width: cardWidth, left: cardLeft } = cardRect;\n          const { width: contentWidth, left: contentLeft } = contentRect;\n\n          requestAnimationFrame(() => {\n            const ele = horizontalContentRef.current as HTMLElement;\n            if (!ele) return;\n\n            ele.style.scrollBehavior = 'smooth';\n            const targetScrollLeft =\n              cardLeft - contentLeft + cardWidth / 2 - contentWidth / 2;\n            ele.scrollLeft += targetScrollLeft;\n\n            // Only focus if conditions allow and it's not initial render (unless focusActiveItemOnLoad is true)\n            if (!wasSearchActive && shouldFocus) {\n              (card as HTMLElement).focus({ preventScroll: true });\n            }\n          });\n        }\n      }\n\n      // Also ensure timeline point is visible\n      const point = document.querySelector(\n        `button[data-testid=\"timeline-circle\"][data-item-id=\"${activeItem.id}\"]`,\n      ) as HTMLButtonElement | null;\n\n      if (point && shouldFocus) {\n        requestAnimationFrame(() => {\n          // Check if scrollIntoView is available (not available in JSDOM)\n          if (point.scrollIntoView) {\n            point.scrollIntoView({\n              behavior: 'smooth',\n              inline: 'center',\n              block: 'nearest',\n            });\n          }\n        });\n      }\n    } else if (\n      timelineMode === 'VERTICAL' ||\n      timelineMode === 'VERTICAL_ALTERNATING'\n    ) {\n      const verticalItemRow = document.querySelector(\n        `[data-testid=\"vertical-item-row\"][data-item-id=\"${activeItem.id}\"]`,\n      );\n\n      if (verticalItemRow) {\n        requestAnimationFrame(() => {\n          // Only scroll into view if it's not initial render or if focusOnLoad is enabled\n          // scrollIntoView can trigger browser focus behavior\n          if ((verticalItemRow as HTMLElement).scrollIntoView && shouldFocus) {\n            (verticalItemRow as HTMLElement).scrollIntoView({\n              behavior: 'smooth',\n              block: 'center',\n            });\n          }\n        });\n      }\n    }\n  }, [\n    activeTimelineItem,\n    items,\n    slideShowRunning,\n    mode,\n    onItemSelected,\n    horizontalContentRef,\n  ]);\n\n  // Update scroll position when offset changes\n  useEffect(() => {\n    const ele = timelineMainRef.current;\n    if (!ele) return;\n\n    if (timelineMode === 'HORIZONTAL') {\n      ele.scrollLeft = Math.max(newOffSet, 0);\n    } else {\n      ele.scrollTop = newOffSet;\n    }\n  }, [newOffSet, mode, timelineMainRef]);\n\n  // Use Vanilla Extract styles with proper CSS variables\n  const wrapperHeight = useMemo(() => {\n    return typeof props.timelineHeight === 'number'\n      ? `${props.timelineHeight}px`\n      : props.timelineHeight || '100%';\n  }, [props.timelineHeight]);\n\n  // Memoize theme CSS variables to prevent re-creation on every render\n  // Only compute vars for custom themes - default themes use vanilla-extract classes\n  const themeCssVars = useMemo(\n    () => computeCssVarsFromTheme(theme, darkMode),\n    [theme, darkMode],\n  );\n\n  // Memoize search width CSS variables\n  const searchWidthVars = useMemo(() => {\n    if (!toolbarSearchConfig) return {};\n\n    return {\n      '--timeline-search-width': toolbarSearchConfig.width,\n      '--timeline-search-max-width': toolbarSearchConfig.maxWidth,\n      '--timeline-search-min-width': toolbarSearchConfig.minWidth,\n      '--timeline-search-input-width': toolbarSearchConfig.inputWidth,\n      '--timeline-search-input-max-width': toolbarSearchConfig.inputMaxWidth,\n    };\n  }, [toolbarSearchConfig]);\n\n  return (\n    <FontProvider googleFonts={googleFonts}>\n      <div\n        ref={wrapperRef}\n        onKeyDown={handleKeyDown}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        className={`timeline-wrapper ${mode.toLowerCase()} ${ve.wrapper({ fullscreen: isFullscreen })} ${darkMode ? darkThemeClass : lightThemeClass}`}\n        style={{\n          ...themeCssVars,\n          ...searchWidthVars,\n          height: wrapperHeight,\n        }}\n        data-mode={timelineMode}\n        data-fullscreen={isFullscreen}\n        data-keyboard-focus={isKeyboardNavigation}\n        data-toolbar-navigation={isToolbarNavigationRef.current}\n        onMouseDown={(evt) => {\n          // Don't steal focus from search input or toolbar\n          // Check if click is within toolbar (which contains search input)\n          const timelineToolbar = (\n            evt.currentTarget as HTMLElement\n          ).querySelector('[role=\"toolbar\"]');\n          const isWithinToolbar = timelineToolbar?.contains(evt.target as Node);\n\n          if (!isWithinToolbar) {\n            setHasFocus(true);\n          }\n        }}\n        onKeyUp={(evt) => {\n          if (evt.key === 'Escape') {\n            onPaused?.();\n          }\n        }}\n        tabIndex={isChild ? -1 : 0}\n        role=\"region\"\n        aria-roledescription=\"interactive timeline\"\n        aria-label=\"Timeline navigation\"\n        aria-keyshortcuts={\n          timelineMode === 'VERTICAL' || timelineMode === 'VERTICAL_ALTERNATING'\n            ? 'ArrowUp ArrowDown Home End'\n            : 'ArrowLeft ArrowRight Home End'\n        }\n      >\n        {/* Visually hidden live region for screen reader announcements */}\n        <div\n          aria-live=\"polite\"\n          aria-atomic=\"true\"\n          style={{\n            position: 'absolute',\n            left: '-10000px',\n            width: '1px',\n            height: '1px',\n            overflow: 'hidden',\n          }}\n        >\n          {activeTimelineItem !== undefined && items[activeTimelineItem] && (\n            <>\n              Viewing item {activeTimelineItem + 1} of {items.length}\n              {items[activeTimelineItem].title &&\n                `: ${items[activeTimelineItem].title}`}\n            </>\n          )}\n        </div>\n\n        {canShowToolbar && (\n          <div\n            className={ve.toolbarContainer({\n              position: toolbarPosition as 'top' | 'bottom',\n              sticky: Boolean(props.stickyToolbar),\n            })}\n          >\n            <TimelineToolbar\n              activeTimelineItem={activeTimelineItem ?? 0}\n              totalItems={items.length}\n              slideShowEnabled={!!slideShowEnabled}\n              slideShowRunning={!!slideShowRunning}\n              onFirst={handleFirst}\n              onLast={handleLast}\n              onNext={handleNext}\n              onPrevious={handlePrevious}\n              onRestartSlideshow={handleRestartSlideshow}\n              darkMode={darkMode}\n              toggleDarkMode={handleToggleDarkMode}\n              onPaused={handlePausedWrapper}\n              id={id}\n              flipLayout={!!flipLayout}\n              items={items}\n              onActivateTimelineItem={wrappedOnActivateTimelineItem}\n              onUpdateTimelineMode={wrappedOnUpdateTimelineMode}\n              onUpdateTextContentDensity={wrappedOnUpdateTextContentDensity}\n              mode={timelineMode}\n              searchQuery={searchQuery}\n              onSearchChange={handleSearchChange}\n              onTriggerSearch={triggerSearch}\n              onClearSearch={clearSearch}\n              onNextMatch={handleNextMatch}\n              onPreviousMatch={handlePreviousMatch}\n              totalMatches={searchResults.length}\n              currentMatchIndex={currentMatchIndex}\n              onSearchKeyDown={handleSearchKeyDown}\n              searchInputRef={\n                searchInputRef as unknown as React.RefObject<HTMLInputElement>\n              }\n              timelineRef={\n                wrapperRef as unknown as React.RefObject<HTMLElement>\n              }\n              onEnterFullscreen={() => {\n                setIsFullscreen(true);\n              }}\n              onExitFullscreen={() => {\n                setIsFullscreen(false);\n              }}\n              onFullscreenError={(_error: string) => {\n                setIsFullscreen(false);\n              }}\n              stickyToolbar={props.stickyToolbar ?? false}\n            />\n          </div>\n        )}\n\n        {/* Overall slideshow progress bar - positioned below toolbar */}\n        {/* {slideShowRunning && showOverallSlideshowProgress && (\n        <SlideshowProgress\n          activeItemIndex={activeTimelineItem ?? 0}\n          totalItems={items.length}\n          isRunning={slideShowRunning}\n          slideItemDuration={slideItemDuration}\n          isPaused={isPaused}\n        />\n      )} */}\n\n        <div\n          ref={timelineMainRef}\n          className={`timeline-main-wrapper ${timelineMode.toLowerCase()} ${ve.mainWrapper(\n            {\n              mode:\n                timelineMode === 'VERTICAL'\n                  ? 'vertical'\n                  : timelineMode === 'VERTICAL_ALTERNATING'\n                    ? 'alternating'\n                    : timelineMode === 'HORIZONTAL_ALL'\n                      ? 'horizontalAll'\n                      : 'horizontal',\n            },\n          )}`}\n          id=\"timeline-main-wrapper\"\n          data-testid=\"timeline-main-wrapper\"\n          onScroll={handleMainScroll}\n        >\n          <TimelineView\n            timelineMode={timelineMode}\n            activeTimelineItem={activeTimelineItem ?? 0}\n            autoScroll={handleScroll}\n            contentDetailsChildren={contentDetailsChildren}\n            hasFocus={hasFocus}\n            iconChildren={iconChildren}\n            items={items}\n            handleTimelineItemClick={handleTimelineItemClick}\n            handleTimelineItemElapsed={handleTimelineItemElapsed}\n            slideShowRunning={!!slideShowRunning}\n            id={id}\n            theme={theme}\n            lineWidth={lineWidth}\n            onOutlineSelection={onOutlineSelection || (() => {})}\n            nestedCardHeight={nestedCardHeight ?? 0}\n          />\n        </div>\n\n        {/* Only render content renderer for horizontal modes */}\n        {(timelineMode === 'HORIZONTAL' ||\n          timelineMode === 'HORIZONTAL_ALL') && (\n          <div\n            id={id}\n            ref={horizontalContentRef}\n            className={`timeline-content-render ${ve.contentRenderer({\n              mode:\n                timelineMode === 'HORIZONTAL_ALL'\n                  ? 'horizontalAll'\n                  : 'horizontal',\n            })}`}\n            style={\n              {\n                // Pass card height as CSS variable for dynamic height calculation\n                '--card-height': `${cardHeight || 350}px`,\n              } as React.CSSProperties\n            }\n          />\n        )}\n      </div>\n    </FontProvider>\n  );\n};\n\nTimeline.displayName = 'Timeline';\n\nexport default React.memo(Timeline);\n","import React, { Component, ErrorInfo, ReactNode } from 'react';\nimport {\n  errorBoundaryContainer,\n  errorMessage,\n  errorTitle,\n  retryButton,\n} from './error-boundary.css';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n}\n\nexport class TimelineErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    // Update state so the next render will show the fallback UI\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Log error to console or external service\n    console.error('Timeline Error:', error, errorInfo);\n\n    // Call optional error handler\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n  }\n\n  handleReset = () => {\n    this.setState({ hasError: false, error: null });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Use custom fallback if provided\n      if (this.props.fallback) {\n        return <>{this.props.fallback}</>;\n      }\n\n      // Default error UI\n      return (\n        <div className={errorBoundaryContainer}>\n          <h2 className={errorTitle}>Something went wrong</h2>\n          <p className={errorMessage}>\n            {this.state.error?.message ||\n              'An unexpected error occurred in the timeline component.'}\n          </p>\n          <button\n            className={retryButton}\n            onClick={this.handleReset}\n            type=\"button\"\n          >\n            Try Again\n          </button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","import { TimelineItemModel } from '@models/TimelineItemModel';\nimport { TimelineProps } from '@models/TimelineModel';\nimport { TimelinePropsV2 } from '@models/TimelinePropsV2';\nimport { migrateLegacyProps, warnDeprecatedProps } from '@utils/propMigration';\nimport { getUniqueID } from '@utils/index';\nimport { safeValidateTimelineProps } from '@utils/validation';\nimport dayjs from 'dayjs';\nimport React, {\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n  useMemo,\n} from 'react';\nimport { TimelineContextProvider } from './contexts/TimelineContextProvider';\nimport Timeline from './timeline/timeline';\nimport { computeCssVarsFromTheme } from '../styles/theme-bridge';\nimport { lightThemeClass, darkThemeClass } from '../styles/themes.css';\nimport { pickDefined } from '../utils/propUtils';\nimport { TimelineErrorBoundary } from './common/error-boundary';\nconst toReactArray = React.Children.toArray;\n\n/**\n * Converts new grouped props back to legacy format for internal compatibility\n */\nfunction convertToLegacyProps(props: TimelinePropsV2): TimelineProps {\n  return pickDefined({\n    // Core props\n    items: props.items,\n    children: props.children,\n    theme: props.theme,\n    activeItemIndex: props.activeItemIndex,\n    allowDynamicUpdate: props.allowDynamicUpdate,\n    uniqueId: props.id,\n    onItemSelected: props.onItemSelected\n      ? (data: any) => {\n          // Convert from legacy flat structure to new nested structure\n          if ('item' in data) {\n            // Already in new format\n            props.onItemSelected!(data);\n          } else {\n            // Convert from legacy format\n            const { index, ...item } = data;\n            props.onItemSelected!({ item, index });\n          }\n        }\n      : undefined,\n    onScrollEnd: props.onScrollEnd,\n    onThemeChange: props.onThemeChange as any,\n    onRestartSlideshow: props.onRestartSlideshow,\n\n    // Mode conversion\n    mode: mapNewModeToLegacy(props.mode),\n\n    // Layout props\n    cardWidth: props.layout?.cardWidth,\n    cardHeight: props.layout?.cardHeight,\n    timelinePointDimension: props.layout?.pointSize,\n    lineWidth: props.layout?.lineWidth,\n    itemWidth: props.layout?.itemWidth,\n    timelineHeight: props.layout?.timelineHeight,\n    responsiveBreakPoint: props.layout?.responsive?.breakpoint,\n    enableBreakPoint: props.layout?.responsive?.enabled,\n    cardPositionHorizontal: mapNewCardPositionToLegacy(\n      props.layout?.positioning?.cardPosition,\n    ),\n    flipLayout: props.layout?.positioning?.flipLayout,\n\n    // Interaction props\n    disableNavOnKey:\n      props.interaction?.keyboardNavigation === false ? true : undefined,\n    disableClickOnCircle:\n      props.interaction?.pointClick === false ? true : undefined,\n    disableAutoScrollOnClick:\n      props.interaction?.autoScroll === false ? true : undefined,\n    focusActiveItemOnLoad: props.interaction?.focusOnLoad,\n    highlightCardsOnHover: props.interaction?.cardHover,\n    disableInteraction: props.interaction?.disabled,\n\n    // Content props\n    parseDetailsAsHTML: props.content?.allowHTML,\n    useReadMore: props.content?.readMore,\n    textOverlay: props.content?.textOverlay,\n    titleDateFormat: props.content?.dateFormat,\n    textDensity: props.content?.compactText ? 'LOW' : 'HIGH',\n    semanticTags: props.content?.semanticTags\n      ? pickDefined({\n          cardTitle: props.content.semanticTags.title,\n          cardSubtitle: props.content.semanticTags.subtitle,\n        })\n      : undefined,\n    contentAlignment: props.content?.alignment\n      ? {\n          horizontal: props.content.alignment.horizontal || 'left',\n          vertical: props.content.alignment.vertical || 'top',\n        }\n      : { horizontal: 'left' as const, vertical: 'top' as const },\n\n    // Display props\n    borderLessCards: props.display?.borderless,\n    cardLess: props.display?.cardsDisabled,\n    disableTimelinePoint: props.display?.pointsDisabled,\n    timelinePointShape: props.display?.pointShape,\n    showAllCardsHorizontal: props.display?.allCardsVisible,\n    disableToolbar:\n      props.display?.toolbar?.enabled === false ? true : undefined,\n    toolbarPosition: props.display?.toolbar?.position,\n    toolbarSearchConfig: props.display?.toolbar?.search,\n    scrollable: props.display?.scrollable,\n\n    // Media props\n    mediaHeight: props.media?.height,\n    mediaSettings: props.media\n      ? pickDefined({\n          align: props.media?.align,\n          fit: props.media?.fit as\n            | 'cover'\n            | 'contain'\n            | 'fill'\n            | 'none'\n            | undefined,\n        })\n      : undefined,\n\n    // Animation props\n    slideShow: props.animation?.slideshow?.enabled,\n    slideItemDuration: props.animation?.slideshow?.duration,\n    slideShowType: mapNewSlideshowTypeToLegacy(\n      props.animation?.slideshow?.type,\n    ) as any,\n    showProgressOnSlideshow: props.animation?.slideshow?.showProgress,\n    showOverallSlideshowProgress:\n      props.animation?.slideshow?.showOverallProgress,\n\n    // Style props\n    classNames: props.style?.classNames,\n    fontSizes: props.style?.fontSizes,\n    googleFonts: props.style?.googleFonts,\n\n    // Accessibility props\n    buttonTexts: props.accessibility?.buttonTexts as any,\n\n    // i18n props\n    i18nConfig: props.i18n?.texts,\n\n    // Dark mode\n    darkMode: props.darkMode?.enabled,\n    enableDarkToggle: props.darkMode?.showToggle,\n  }) as TimelineProps;\n}\n\nfunction mapNewModeToLegacy(mode?: TimelinePropsV2['mode']): string {\n  switch (mode) {\n    case 'horizontal':\n      return 'HORIZONTAL';\n    case 'vertical':\n      return 'VERTICAL';\n    case 'alternating':\n      return 'VERTICAL_ALTERNATING';\n    case 'horizontal-all':\n      return 'HORIZONTAL_ALL';\n    default:\n      return 'VERTICAL_ALTERNATING';\n  }\n}\n\nfunction mapNewCardPositionToLegacy(\n  position?: 'top' | 'bottom',\n): 'TOP' | 'BOTTOM' | undefined {\n  switch (position) {\n    case 'top':\n      return 'TOP';\n    case 'bottom':\n      return 'BOTTOM';\n    default:\n      return undefined;\n  }\n}\n\nfunction mapNewSlideshowTypeToLegacy(\n  type?: 'reveal' | 'slide' | 'fade',\n): string | undefined {\n  switch (type) {\n    case 'reveal':\n      return 'reveal';\n    case 'slide':\n      return 'slide_in';\n    case 'fade':\n      return 'slide_from_sides';\n    default:\n      return undefined;\n  }\n}\n\n// Union type to accept both old and new prop formats\ntype ChronoProps = TimelineProps | TimelinePropsV2;\n\nconst Chrono: React.FunctionComponent<ChronoProps> = (\n  inputProps: ChronoProps,\n) => {\n  // Handle backward compatibility and migration\n  const props = useMemo(() => {\n    // Check if using new grouped prop structure\n    const hasNewProps =\n      'layout' in inputProps ||\n      'interaction' in inputProps ||\n      'content' in inputProps ||\n      'display' in inputProps ||\n      'media' in inputProps ||\n      'animation' in inputProps;\n\n    if (hasNewProps) {\n      // Already using new format\n      return inputProps as TimelinePropsV2;\n    } else {\n      // Migrate legacy props and warn about deprecations\n      if (process.env.NODE_ENV === 'development') {\n        warnDeprecatedProps(inputProps as TimelineProps);\n      }\n      return migrateLegacyProps(inputProps as TimelineProps);\n    }\n  }, [inputProps]);\n\n  // Validate props early with development warnings\n  if (process.env.NODE_ENV === 'development') {\n    // Convert back to legacy format for existing validation\n    const legacyProps = convertToLegacyProps(props);\n    const validationResult = safeValidateTimelineProps(legacyProps);\n    if (!validationResult.success) {\n      console.warn(\n        'Timeline props validation warnings:',\n        validationResult.errors\n          .map((error) => `${error.path.join('.')}: ${error.message}`)\n          .join(', '),\n      );\n    }\n  }\n\n  // Extract props with new grouped structure\n  const {\n    allowDynamicUpdate = false,\n    children,\n    items = [],\n    onScrollEnd,\n    activeItemIndex,\n    mode = 'alternating',\n    onThemeChange,\n    onRestartSlideshow,\n    content,\n    animation,\n  } = props;\n\n  // Extract specific values from grouped configs with defaults\n  const slideShow = animation?.slideshow?.enabled || false;\n  const slideItemDuration = animation?.slideshow?.duration || 2000;\n  const titleDateFormat = content?.dateFormat || 'MMM DD, YYYY';\n\n  const [timeLineItems, setTimeLineItems] = useState<TimelineItemModel[]>([]);\n  const timeLineItemsRef = useRef<TimelineItemModel[]>([]);\n  const [slideShowActive, setSlideShowActive] = useState(false);\n  // Auto-select first item when activeItemIndex is not provided\n  const [activeTimelineItem, setActiveTimelineItem] = useState(\n    activeItemIndex !== undefined ? activeItemIndex : 0,\n  );\n\n  // Track the previous prop value to avoid circular updates\n  const previousActiveItemIndexRef = useRef(activeItemIndex);\n\n  // Cache the last processed items to avoid unnecessary reprocessing\n  const itemsHashRef = useRef<string>('');\n  const processedItemsCache = useRef<TimelineItemModel[]>([]);\n\n  // Store the last original items array for comparison (to detect append vs replace)\n  const lastOriginalItemsRef = useRef<any[]>([]);\n\n  // Store scroll position to preserve it during item updates\n  const scrollPositionRef = useRef<{ scrollLeft?: number; scrollTop?: number }>(\n    {},\n  );\n\n  // Track children count for Array.map() pattern detection\n  const childrenCount = React.Children.count(children);\n\n  // Memoize the initItems function\n  const initItems = useCallback(\n    (lineItems?: TimelineItemModel[]): TimelineItemModel[] => {\n      if (lineItems?.length) {\n        return lineItems.map((item, index) => {\n          const id = getUniqueID();\n          const hasNestedItems = !!item.items?.length;\n\n          return {\n            ...item,\n            _dayjs: dayjs(item.date),\n            active: index === (activeTimelineItem ?? 0),\n            id,\n            hasNestedItems,\n            items:\n              item.items?.map((subItem) => ({\n                ...subItem,\n                _dayjs: dayjs(subItem.date),\n                id: getUniqueID(),\n                isNested: true,\n                visible: true,\n              })) || [],\n            title: item.date\n              ? dayjs(item.date).format(titleDateFormat)\n              : item.title,\n            visible: true,\n          };\n        });\n      }\n\n      const itemLength = React.Children.toArray(children).filter(\n        (item) =>\n          (item as React.ReactElement<any>).props.className !== 'chrono-icons',\n      ).length;\n\n      return Array.from({ length: itemLength }).map((_, index) => ({\n        active: index === (activeTimelineItem ?? 0),\n        id: getUniqueID(),\n        visible: true,\n      }));\n    },\n    [activeTimelineItem, titleDateFormat, children],\n  );\n\n  // Optimize updateItems function - only for truly appending items\n  // This function merges existing items with new ones, preserving existing item states\n  const updateItems = useCallback(\n    (lineItems: TimelineItemModel[], existingItems: TimelineItemModel[]) => {\n      if (lineItems && existingItems.length > 0) {\n        // Merge existing items with new ones, preserving existing item states\n        const existingItemsMap = new Map(\n          existingItems.map((item, idx) => [idx, item]),\n        );\n\n        return lineItems.map((item, index) => {\n          // If this is an existing item, preserve its state\n          const existingItem = existingItemsMap.get(index);\n          if (existingItem) {\n            return {\n              ...item,\n              ...(existingItem.id !== undefined && { id: existingItem.id }),\n              ...(existingItem.active !== undefined && {\n                active: existingItem.active,\n              }),\n              ...(existingItem.visible !== undefined && {\n                visible: existingItem.visible,\n              }),\n            };\n          }\n          // New item - set visible and inactive (active will be set by active item logic)\n          return {\n            ...item,\n            active: false,\n            visible: true,\n          };\n        });\n      } else {\n        return [];\n      }\n    },\n    [], // No dependencies - function is pure\n  );\n\n  // Helper function to convert ReactNode to hashable string\n  const getHashableValue = useCallback((value: any, itemId: string): string => {\n    if (!value) return '';\n    if (typeof value === 'string') return value;\n    if (typeof value === 'number') return String(value);\n\n    // For ReactNode, use a stable identifier\n    // If it's a React element, try to get a stable key\n    if (React.isValidElement(value)) {\n      const key = value.key;\n      const type =\n        typeof value.type === 'string'\n          ? value.type\n          : value.type?.name || 'Component';\n      return `[ReactNode:${type}${key ? `:${key}` : ''}]`;\n    }\n\n    // For other ReactNode types (arrays, fragments, etc.), use item id as fallback\n    return `[ReactNode:${itemId}]`;\n  }, []);\n\n  // Create a stable hash for items comparison - optimized version\n  const createItemsHash = useCallback(\n    (items: any[]) => {\n      if (!items?.length) return '';\n\n      // Only extract the needed properties and create a single string\n      return items\n        .map((item) => {\n          // Use simple string concatenation which is more efficient than JSON.stringify\n          const id = item.id || '';\n          const date = item.date || '';\n          const title = getHashableValue(item.title, id);\n          const cardTitle = getHashableValue(item.cardTitle, id);\n          return `${id}:${date}:${title}:${cardTitle}`;\n        })\n        .join('|');\n    },\n    [getHashableValue],\n  );\n\n  useEffect(() => {\n    const _items = items?.filter((item) => item);\n    let newItems: TimelineItemModel[] = [];\n\n    // FIX for Issue #291: Handle children pattern (Array.map())\n    // When items array is not provided but children exist, track children count changes\n    if (!_items?.length && children) {\n      const currentChildrenHash = String(childrenCount);\n\n      // Check if children count changed or if dynamic updates are allowed\n      if (allowDynamicUpdate || currentChildrenHash !== itemsHashRef.current) {\n        itemsHashRef.current = currentChildrenHash;\n        const lineItems = initItems();\n        setTimeLineItems(lineItems);\n\n        // For dynamic updates via children, focus on first new item if no active item\n        if (\n          allowDynamicUpdate &&\n          timeLineItems.length > 0 &&\n          lineItems.length > timeLineItems.length\n        ) {\n          if (activeTimelineItem === undefined || activeTimelineItem === null) {\n            setActiveTimelineItem(timeLineItems.length);\n          }\n        }\n      }\n      return;\n    }\n\n    if (!_items?.length) {\n      const lineItems = initItems();\n      setTimeLineItems(lineItems);\n      lastOriginalItemsRef.current = [];\n      return;\n    }\n\n    // Use efficient comparison instead of JSON.stringify on entire array\n    const currentHash = createItemsHash(_items);\n\n    // Check if hash has changed - if not, skip processing (even with allowDynamicUpdate)\n    // This prevents unnecessary re-renders when only active state changes\n    if (currentHash === itemsHashRef.current) {\n      return; // No changes to items data, skip processing\n    }\n\n    // Capture scroll position before items update (for horizontal/vertical modes)\n    const timelineElement = document.querySelector(\n      '[data-testid=\"timeline-main-wrapper\"]',\n    ) as HTMLElement | null;\n\n    if (timelineElement) {\n      scrollPositionRef.current = {\n        scrollLeft: timelineElement.scrollLeft,\n        scrollTop: timelineElement.scrollTop,\n      };\n    }\n\n    itemsHashRef.current = currentHash;\n\n    const previousItemsLength = timeLineItems.length;\n\n    // Check if items are truly appended (same items + new ones at end) vs replaced (completely different)\n    // Compare first N items (where N = previous length) to see if they match\n    const isTrulyAppended =\n      allowDynamicUpdate &&\n      timeLineItems.length > 0 &&\n      _items.length > timeLineItems.length &&\n      lastOriginalItemsRef.current.length > 0 &&\n      // Verify existing items are preserved at the beginning by comparing original items\n      (() => {\n        const previousOriginalSlice = lastOriginalItemsRef.current;\n        const newItemsSlice = _items.slice(0, previousOriginalSlice.length);\n\n        // Compare by hash (which uses id, date, title, cardTitle from original items)\n        const previousHash = createItemsHash(previousOriginalSlice);\n        const newHash = createItemsHash(newItemsSlice);\n        return previousHash === newHash && previousHash !== '';\n      })();\n\n    if (isTrulyAppended) {\n      // Items are truly appended - use updateItems to merge\n      newItems = updateItems(_items, timeLineItems);\n    } else if (_items.length) {\n      // Items are replaced or initial load - use initItems\n      newItems = initItems(_items);\n    }\n\n    if (newItems.length) {\n      timeLineItemsRef.current = newItems;\n      setTimeLineItems(newItems);\n\n      // Validate and clamp activeTimelineItem to valid range\n      let validActiveIndex: number | undefined;\n      if (isTrulyAppended && allowDynamicUpdate && previousItemsLength > 0) {\n        // For truly appended items, preserve current active item if valid\n        if (activeTimelineItem !== undefined && activeTimelineItem !== null) {\n          validActiveIndex = Math.min(activeTimelineItem, newItems.length - 1);\n        } else {\n          // No active item - focus on first newly loaded item\n          validActiveIndex = previousItemsLength;\n        }\n      } else {\n        // For replaced items or initial load, respect the initial activeItemIndex setting\n        const initialIndex =\n          activeItemIndex !== undefined ? activeItemIndex : 0;\n        validActiveIndex = Math.min(initialIndex, newItems.length - 1);\n      }\n\n      // Ensure validActiveIndex is within bounds\n      if (validActiveIndex !== undefined && validActiveIndex < 0) {\n        validActiveIndex = 0;\n      }\n\n      setActiveTimelineItem(validActiveIndex);\n\n      // Restore scroll position after DOM update\n      if (\n        timelineElement &&\n        (scrollPositionRef.current.scrollLeft !== undefined ||\n          scrollPositionRef.current.scrollTop !== undefined)\n      ) {\n        requestAnimationFrame(() => {\n          const updatedElement = document.querySelector(\n            '[data-testid=\"timeline-main-wrapper\"]',\n          ) as HTMLElement | null;\n\n          if (updatedElement) {\n            const mappedMode = mapNewModeToLegacy(mode);\n            // For horizontal mode, preserve scrollLeft (clamped to valid range)\n            if (\n              scrollPositionRef.current.scrollLeft !== undefined &&\n              (mappedMode === 'HORIZONTAL' || mappedMode === 'HORIZONTAL_ALL')\n            ) {\n              const maxScrollLeft =\n                updatedElement.scrollWidth - updatedElement.clientWidth;\n              updatedElement.scrollLeft = Math.max(\n                0,\n                Math.min(scrollPositionRef.current.scrollLeft, maxScrollLeft),\n              );\n            }\n            // For vertical modes, preserve scrollTop (clamped to valid range)\n            if (\n              scrollPositionRef.current.scrollTop !== undefined &&\n              (mappedMode === 'VERTICAL' ||\n                mappedMode === 'VERTICAL_ALTERNATING')\n            ) {\n              const maxScrollTop =\n                updatedElement.scrollHeight - updatedElement.clientHeight;\n              updatedElement.scrollTop = Math.max(\n                0,\n                Math.min(scrollPositionRef.current.scrollTop, maxScrollTop),\n              );\n            }\n          }\n        });\n      }\n\n      processedItemsCache.current = newItems;\n\n      // Store the original items for next comparison\n      lastOriginalItemsRef.current = _items;\n    }\n  }, [\n    items,\n    children,\n    childrenCount,\n    allowDynamicUpdate,\n    timeLineItems.length,\n    initItems,\n    updateItems,\n    createItemsHash,\n    activeTimelineItem,\n    mode,\n    activeItemIndex,\n  ]);\n\n  const handleTimelineUpdate = useCallback(\n    (actvTimelineIndex: number) => {\n      setTimeLineItems((lineItems) =>\n        lineItems.map((item, index) => ({\n          ...item,\n          active: index === actvTimelineIndex,\n          // Always keep horizontal items visible so points are always shown\n          visible: true,\n        })),\n      );\n\n      setActiveTimelineItem(actvTimelineIndex);\n\n      if (items) {\n        if (items.length - 1 === actvTimelineIndex) {\n          setSlideShowActive(false);\n        }\n      }\n    },\n    [items, mode],\n  );\n\n  useEffect(() => {\n    // Only update if the activeItemIndex prop has actually changed from its previous value\n    // This prevents unwanted resets during dynamic loading and circular updates\n    if (activeItemIndex !== previousActiveItemIndexRef.current) {\n      previousActiveItemIndexRef.current = activeItemIndex;\n      if (activeItemIndex !== undefined) {\n        handleTimelineUpdate(activeItemIndex);\n      }\n    }\n  }, [activeItemIndex, handleTimelineUpdate]);\n\n  // Sync items' active property when activeTimelineItem is auto-set\n  useEffect(() => {\n    // Only sync if activeTimelineItem is set and items exist\n    // Skip if this was triggered by activeItemIndex prop change (handled separately)\n    if (\n      activeTimelineItem !== undefined &&\n      timeLineItems.length > 0 &&\n      activeItemIndex === undefined\n    ) {\n      // Check if items need active property update\n      const hasActiveItem = timeLineItems.some(\n        (item, idx) => item.active && idx === activeTimelineItem,\n      );\n      if (!hasActiveItem) {\n        handleTimelineUpdate(activeTimelineItem);\n      }\n    }\n  }, [activeTimelineItem, timeLineItems.length, activeItemIndex, handleTimelineUpdate]);\n\n  const restartSlideShow = useCallback(() => {\n    handleTimelineUpdate(-1);\n\n    setTimeout(() => {\n      setSlideShowActive(true);\n      handleTimelineUpdate(0);\n    }, 0);\n  }, [handleTimelineUpdate]);\n\n  // Only sync slideshow state when slideShow prop changes, don't auto-start\n  useEffect(() => {\n    if (!slideShow) {\n      setSlideShowActive(false);\n    }\n    // Note: slideshow should be started manually by user interaction, not auto-started\n  }, [slideShow]);\n\n  const handleOnNext = useCallback(() => {\n    if (!timeLineItems.length) {\n      return;\n    }\n    if (\n      activeTimelineItem !== undefined &&\n      activeTimelineItem < timeLineItems.length - 1\n    ) {\n      const newTimeLineItem = activeTimelineItem + 1;\n\n      // Update timeline state and trigger smooth navigation\n      handleTimelineUpdate(newTimeLineItem);\n      setActiveTimelineItem(newTimeLineItem);\n\n      if (\n        mapNewModeToLegacy(mode) === 'HORIZONTAL' &&\n        slideShowActive &&\n        items &&\n        items.length - 1 === newTimeLineItem\n      ) {\n        setSlideShowActive(false);\n      }\n    }\n  }, [\n    timeLineItems.length,\n    activeTimelineItem,\n    handleTimelineUpdate,\n    mode,\n    slideShowActive,\n    items,\n  ]);\n\n  const handleOnPrevious = useCallback(() => {\n    if (activeTimelineItem !== undefined && activeTimelineItem > 0) {\n      const newTimeLineItem = activeTimelineItem - 1;\n\n      // Update timeline state and trigger smooth navigation\n      handleTimelineUpdate(newTimeLineItem);\n      setActiveTimelineItem(newTimeLineItem);\n    }\n  }, [activeTimelineItem, handleTimelineUpdate]);\n\n  const handleFirst = useCallback(() => {\n    setActiveTimelineItem(0);\n    handleTimelineUpdate(0);\n  }, [handleTimelineUpdate]);\n\n  const handleLast = useCallback(() => {\n    if (timeLineItems.length) {\n      const idx = timeLineItems.length - 1;\n      setActiveTimelineItem(idx);\n      handleTimelineUpdate(idx);\n    }\n  }, [timeLineItems.length, handleTimelineUpdate]);\n\n  const handleOutlineSelection = useCallback(\n    (index: number) => {\n      if (index >= 0) {\n        setActiveTimelineItem(index);\n        handleTimelineUpdate(index);\n      }\n    },\n    [handleTimelineUpdate],\n  );\n\n  const onPaused = useCallback(() => {\n    setSlideShowActive(false);\n  }, []);\n\n  // Memoize icon children processing\n  const iconChildren = useMemo(() => {\n    let iconChildArray = toReactArray(children).filter(\n      (item) =>\n        item &&\n        (item as any).props &&\n        (item as any).props.className === 'chrono-icons',\n    );\n\n    if (iconChildArray.length) {\n      return (iconChildArray[0] as any).props.children;\n    }\n    return iconChildArray;\n  }, [children]);\n\n  // Memoize content details children\n  const contentDetailsChildren = useMemo(() => {\n    return toReactArray(children).filter(\n      (item) =>\n        item &&\n        (item as any).props &&\n        (item as any).props.className !== 'chrono-icons',\n    );\n  }, [children]);\n\n  // Determine if we should use dark mode based on theme properties\n  const isDarkMode = useMemo(() => {\n    const t = props.theme;\n    return (\n      t?.timelineBgColor === '#000000' ||\n      t?.cardBgColor === '#1f2937' ||\n      t?.textColor === '#ffffff' ||\n      t?.textColor === '#f9fafb'\n    );\n  }, [props.theme]);\n\n  // Convert to legacy props for internal compatibility\n  const legacyProps = useMemo(() => convertToLegacyProps(props), [props]);\n\n  return (\n    <TimelineErrorBoundary>\n      <TimelineContextProvider {...legacyProps}>\n        <div\n          className={isDarkMode ? darkThemeClass : lightThemeClass}\n          style={{ ...computeCssVarsFromTheme(props.theme), width: '100%' }}\n          id=\"testette\"\n        >\n          <Timeline\n            activeTimelineItem={activeTimelineItem || 0}\n            contentDetailsChildren={contentDetailsChildren}\n            iconChildren={iconChildren}\n            items={timeLineItems}\n            onFirst={handleFirst}\n            onLast={handleLast}\n            onNext={handleOnNext}\n            onPrevious={handleOnPrevious}\n            onRestartSlideshow={restartSlideShow}\n            onTimelineUpdated={handleTimelineUpdate}\n            slideShow={slideShow}\n            slideShowEnabled={slideShow}\n            slideShowRunning={slideShowActive}\n            slideItemDuration={slideItemDuration}\n            {...pickDefined({\n              onScrollEnd,\n              onItemSelected: legacyProps.onItemSelected,\n            })}\n            onOutlineSelection={handleOutlineSelection}\n            mode={mapNewModeToLegacy(mode)}\n            onPaused={onPaused}\n          />\n        </div>\n      </TimelineContextProvider>\n    </TimelineErrorBoundary>\n  );\n};\n\nexport default React.memo(Chrono);\n"],"names":["migrateLegacyProps","legacyProps","newProps","mapLegacyMode","hasLayoutProps","mapLegacyCardPosition","hasInteractionProps","hasContentProps","hasDisplayProps","hasMediaProps","hasAnimationProps","mapLegacySlideshowType","hasStyleProps","hasAccessibilityProps","warnDeprecatedProps","props","deprecationWarnings","warning","mode","position","type","getDefaultExportFromCjs","x","getDefaultWhiteList","whiteList","onAttr","name","value","options","onIgnoreAttr","REGEXP_URL_JAVASCRIPT","safeAttrValue","_default","util","arr","item","i","j","fn","scope","str","_","require$$0","parseStyle","css","cssLength","isParenthesisOpen","lastPos","retCSS","addNewAttr","source","ret","c","parser","DEFAULT","require$$1","require$$2","isNull","obj","shallowCopyObject","FilterCSS","me","sourcePosition","check","isWhite","opts","filterCSS","html","xss","exports","module","reg","match","getDefaultCSSWhiteList","defaultCSSFilter","onTag","tag","onIgnoreTag","onTagAttr","onIgnoreTagAttr","escapeHtml","REGEXP_LT","REGEXP_GT","cssFilter","friendlyAttrValue","REGEXP_DEFAULT_ON_TAG_ATTR_4","REGEXP_DEFAULT_ON_TAG_ATTR_7","REGEXP_DEFAULT_ON_TAG_ATTR_8","escapeAttrValue","REGEXP_QUOTE","REGEXP_QUOTE_2","REGEXP_ATTR_VALUE_1","REGEXP_ATTR_VALUE_COLON","REGEXP_ATTR_VALUE_NEWLINE","escapeQuote","unescapeQuote","escapeHtmlEntities","code","escapeDangerHtml5Entities","clearNonPrintableCharacter","str2","len","onIgnoreTagStripAll","StripTagBody","tags","next","isRemoveAllTag","isRemoveTag","removeList","posStart","end","rethtml","pos","stripCommentTag","retHtml","stripBlankChar","chars","char","getTagName","tagName","isClosing","parseTag","tagStart","quoteStart","currentPos","currentTagName","currentHtml","chariterator","ic","REGEXP_ILLEGAL_ATTR_NAME","parseAttr","lastMarkPos","retAttrs","tmpName","addAttr","v","findNextQuotationMark","findNextEqual","findBeforeEqual","stripQuoteWrap","isQuoteWrapString","text","require$$3","getAttrs","keysToLowerCase","FilterXSS","attributeWrapSign","stripIgnoreTagBody","info","attrs","whiteAttrList","attrsHtml","isWhiteAttr","filterXSS","isWorkerEnv","libExports","defaultTheme","darkTheme","DEFAULT_CLASS_NAMES","DEFAULT_BUTTON_TEXTS","HEX_COLOR_REGEX","ID_CHARS","ID_LENGTH","hexToRGBA","hex","alpha","fullHex","hexValue","r","g","b","clampedAlpha","getDefaultThemeOrDark","isDark","getDefaultClassNames","getDefaultButtonTexts","getSlideShowType","getUniqueID","randomValues","byte","error","timestamp","performanceTime","seed","randomPart","index","isValidHexColor","color","isValidUrl","url","validateTimelineProps","errors","validModes","prop","safeValidateTimelineProps","dayjs_min$1","t","e","this","n","s","u","a","o","f","h","d","l","$","y","M","m","D","p","S","w","O","k","dayjs","dayjs_minExports","F","A","T","W","createMediaQuery","query","addMediaListeners","currentMedia","handleMediaChange","handleResize","removeMediaListeners","useMatchMedia","onMatch","enabled","debounceDelay","matches","setMatches","useState","mediaQuery","useRef","isCleanedUp","useCallback","event","useDebouncedCallback","currentMatches","useEffect","onMatchRef","defaultI18nTexts","mergeI18nConfig","userConfig","interpolateString","template","variables","key","useI18n","i18nConfig","texts","useMemo","getText","category","navigation","search","current","total","theme","layout","fullscreen","quickJump","title","content","status","accessibility","view","keyboard","createTextResolver","i18nHelper","buttonTexts","resolve","i18nGetter","legacyValue","defaultValue","i18nValue","TimelineContext","createContext","TimelineContextProvider","children","cardHeight","cardWidth","cardLess","flipLayout","itemWidth","lineWidth","mediaHeight","mediaSettings","timelinePointDimension","timelinePointShape","disableNavOnKey","disableAutoScrollOnClick","disableInteraction","disableClickOnCircle","disableTimelinePoint","enableBreakPoint","enableDarkToggle","enableLayoutSwitch","enableQuickJump","focusActiveItemOnLoad","highlightCardsOnHover","borderLessCards","cardPositionHorizontal","parseDetailsAsHTML","useReadMore","textOverlay","contentAlignment","horizontal","vertical","scrollable","scrollbar","toolbarPosition","disableToolbar","toolbarSearchConfig","slideItemDuration","showProgressOnSlideshow","showOverallSlideshowProgress","slideShow","slideShowType","titleDateFormat","uniqueId","nestedCardHeight","contentDetailsHeight","responsiveBreakPoint","noUniqueId","isChild","darkMode","showAllCardsHorizontal","textDensity","classNames","fontSizes","semanticTags","items","activeItemIndex","onScrollEnd","onThemeChange","isDarkMode","setIsDarkMode","showAllCards","setShowAllCards","isMobileDetected","setIsMobileDetected","textContentDensity","setTextContentDensity","toggleDarkMode","updateShowAllCardsHorizontal","state","updateTextContentDensity","density","computedCardHeight","Math","min","computedActiveItemIndex","length","computedMediaAlign","memoizedTheme","textResolver","memoizedButtonTexts","memoizedClassNames","memoizedFontSizes","cardSubtitle","cardText","cardTitle","googleFontsConfig","googleFonts","elements","size","fontFamily","weight","style","controls","weights","display","preconnect","memoizedMediaSettings","align","fit","memoizedContentAlignment","memoizedSemanticTags","memoizedSlideShowType","contextValue","max","isMobile","useTimelineContext","context","useContext","Error","useTimelineStaticConfig","useTimelineMemoizedObjects","classnames","hasOwn","classes","arg","appendClass","parseValue","newClass","cls","classnamesExports","useNewScrollPosition","newOffset","setNewOffset","computeHorizontalOffset","scrollLeft","clientWidth","pointOffset","pointWidth","contrRight","circRight","isVisible","isPartiallyVisible","leftGap","rightGap","computeVerticalOffset","scrollTop","clientHeight","contentOffset","contentHeight","contrBottom","circBottom","nOffset","notVisible","computeNewOffset","parent","scroll","useSlideshowProgress","slideShowRunning","activeTimelineItem","isPaused","setIsPaused","lastActiveItem","pauseProgress","resumeProgress","toPrimitive","toPropertyKey","_defineProperty","ownKeys","_objectSpread2","mapValues","input","result","_key","shouldApplyCompound","compoundCheck","selections","defaultVariants","_selections$key","createRuntimeFn","config","runtimeFn","className","variantName","_selections$variantNa","variantSelection","selection","selectionClassName","compoundClassName","getVarName","variable","assignInlineVars","varsOrContract","tokens","styles","_vars","varName","hasCustomTheme","computeCssVarsFromTheme","defaultBackground","defaultText","defaultCardBg","defaultMuted","defaultToolbarBg","defaultToolbarBtnBg","defaultToolbarText","defaultButtonBorder","defaultButtonHoverBg","defaultShadow","vars","useStableCallback","callback","ref","args","RGB_COLOR_REGEX","RGBA_COLOR_REGEX","HSL_COLOR_REGEX","HSLA_COLOR_REGEX","detectColorFormat","adjustRGBOpacity","opacity","adjustHSLOpacity","useBackground","format","useMeasure","onMeasure","property","delay","onError","node","measure","useMeasureHeight","onRender","useKeyHandler","keys","keyCodes","eventType","preventDefault","stopPropagation","metaKey","ctrlKey","altKey","shiftKey","stableCallback","lastEnabled","keyArray","keyCodeArray","handleKey","keyMatch","keyCodeMatch","listenerOptions","useEscapeKey","useOutsideClick","el","excludeRefs","refs","allRefs","handleClick","target","element","useTimelineKeyboardNavigation","hasFocus","onNext","onPrevious","onFirst","onLast","getSearchableText","React","elementProps","validateVideoUrl","parsedUrl","hostname","pauseVideoEmbeds","iframe","src","validation","targetOrigin","message","toggleMediaVisibility","ele","findTimelineElement","itemId","timelineMode","portalId","elementId","targetElement","portalContainer","useRovingTabIndex","orientation","loop","initialActiveId","onActiveChange","focusOnLoad","getInitialActiveId","activeId","setActiveIdState","itemRefsMap","isInitialRenderRef","id","newActiveId","setActiveId","findNextItem","currentId","direction","currentIndex","nextIndex","attempts","maxAttempts","handleKeyDown","isHorizontal","isVertical","nextId","handleFocus","getItemProps","isActive","isDisabled","tabIndex","useAriaLiveRegion","politeness","atomic","relevant","containerId","messages","setMessages","regionId","random","toString","substr","messageTimeoutsRef","Map","announce","trim","messageKey","Date","now","prev","existingTimeout","get","clearTimeout","timeout","setTimeout","filter","delete","set","forEach","LiveRegion","ReactDOM","createPortal","jsx","left","width","height","overflow","clip","whiteSpace","map","msg","document","body","usePrefersReducedMotion","getInitialState","prefersReducedMotion","setPrefersReducedMotion","handleChange","DEFAULT_SCROLL_DURATION","easeInOutQuart","smoothScrollTo","container","targetPosition","duration","onComplete","startPosition","distance","startTime","animateScroll","currentTime","elapsed","progress","easedProgress","newPosition","useTimelineScrolling","scrollTimeoutRef","lastScrollTarget","clearLastTargetTimeoutRef","forceScroll","isVerticalMode","containerRect","elementRect","targetScrollTop","targetScrollLeft","useTimelineItemNavigation","timelineId","isToolbarNavigationRef","onTimelineUpdated","scrollToElement","stableOnTimelineUpdated","itemsMap","findTargetElement","verticalItemRow","cardContent","row","anyElement","cardElement","timelinePointElement","updateTimelinePosition","targetIndex","isSlideShow","syncActiveItemIndex","newIndex","handleTimelineItemClick","wasSearchActive","isToolbarActive","wrapper","handleTimelineItemElapsed","nextItemId","firstItemId","pickDefined","useTimelineNavigation","isKeyboardNavigation","stableOnNext","stableOnPrevious","stableOnFirst","stableOnLast","handleNext","targetItem","handlePrevious","prevIndex","handleFirst","handleLast","lastIndex","handleKeySelection","MODE_MAPPINGS","useTimelineMode","initialMode","updateHorizontalAllCards","setTimelineMode","stableUpdateHorizontalAllCards","handleTimelineUpdate","newMode","mappedMode","useTimelineMedia","timelineMainRef","itemSelector","observerOptions","onIntersect","observer","observedElements","handleIntersection","entries","entry","createObserver","defaultOptions","observerInstance","elem","cleanup","throttle","limit","inThrottle","lastArgs","useTimelineScroll","scrollEndThrottleMs","onNextItem","onPreviousItem","totalItems","horizontalContentRef","setNewOffsetRef","onScrollEndRef","onNextItemRef","onPreviousItemRef","handleScroll","throttledScrollHandler","scrolled","threshold","handleMainScroll","ev","useTimelineSearch","searchQuery","setSearchQuery","searchResults","setSearchResults","currentMatchIndex","setCurrentMatchIndex","searchInputRef","isFirstSearchRef","onTimelineUpdatedRef","handleTimelineItemClickRef","searchableContent","textParts","focusSearchInput","forceRefocus","findMatches","trimmedQuery","queryLower","results","maxResults","firstResult","handleSearchChange","triggerSearch","clearSearch","preservePosition","navigateMatches","newTimelineIndex","matchData","ariaLiveRegion","handleNextMatch","handlePreviousMatch","handleSearchKeyDown","calculateTextContentSize","scrollHeight","useCardSize","containerRef","detailsRef","setStartWidth","dimensions","setDimensions","measurementsCache","rafId","isUnmounted","detailsEle","updateCardSize","offsetHeight","offsetTop","containerHeight","cardActualHeight","detailsHeight","textContentLarge","cache","getBrowserInfo","userAgent","vendor","useFullscreen","elementRef","isFullscreen","setIsFullscreen","setError","isSupported","doc","browserInfo","hasEnabledProperty","hasRequestMethod","hasExitMethod","isSecureContext","getFullscreenElement","enterFullscreen","errorMsg","requestMethod","err","exitFullscreen","exitMethod","toggleFullscreen","updateFullscreenState","fullscreenElement","newIsFullscreen","events","errorEvents","handleFullscreenError","ArrowDownIcon","CheckIcon","ChevDownIcon","ChevronDown","memo","ChevronLeft","ChevronLeft$1","ChevronRightIcon","ChevronIcon","SvgComponent","LayoutIcon","MaximizeIcon","MinimizeIcon","MinusIcon","MoonIcon","PlusIcon","StopIcon","jsxs","SunIcon","ParaIcon","ChevronsLeftIcon","ChevronsRightIcon","ReplayIcon","Controls","disableLeft","disableRight","onReplay","slideShowEnabled","onToggleDarkMode","onPaused","flippedHorizontally","canDisableLeft","canDisableRight","handlePause","handlePlay","previousTitle","previous","nextTitle","playOrPauseTile","stop","play","jumpToLastTitle","first","last","jumpToFirstTitle","undefined","timelineControlContainer","navWrapper","navItem","navItemDisabled","navButton","navButtonHover","navButtonActive","navButtonFocus","navButtonSvg","light","dark","displayName","FullscreenButton","forwardRef","onToggle","disabled","ariaLabel","testId","rest","defaultAriaLabel","defaultTitle","buttonAriaLabel","buttonTitle","classNameComputed","fullscreenButton","FullscreenControl","targetRef","onEnterFullscreen","onExitFullscreen","onEnter","onExit","catch","errorMessage","ListItem","description","onClick","active","selected","selectable","rovingProps","handleOnClick","onKeyDown","defaultPrevented","itemClass","listItem","listItemActive","listItemRecipe","onFocus","checkboxWrapper","checkbox","checkboxSelected","styleAndDescription","titleClass","descriptionClass","List","multiSelectable","listItems","rovingItems","handleItemSelection","onSelect","startTransition","includes","renderListItem","list","MemoizedContent","PopOver","placeholder","icon","$isMobile","onItemSelect","triggerButtonRef","popoverRef","closeReasonRef","isOpen","setIsOpen","setIsVisible","popoverLayout","setPopoverLayout","top","horizontalPosition","setPortalContainer","focusTrapRef","themeCssVars","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","updatePortalContainer","fullscreenEl","addEventListener","removeEventListener","toggleOpen","closePopover","closeReason","requestAnimationFrame","focus","preventScroll","handleItemSelect","handleKeyPress","firstMenuItem","querySelector","HTMLElement","firstFocusable","menuItems","querySelectorAll","lastMenuItem","focusableElements","lastFocusable","calculatePopoverPosition","triggerRect","getBoundingClientRect","viewportWidth","window","innerWidth","viewportHeight","innerHeight","popoverWidth","horizontalPos","preferredLeft","right","gap","bottom","popoverHeight","spaceBelow","spaceAbove","useLayoutEffect","handlePositionUpdate","passive","cancelAnimationFrame","wrappedChildren","Children","child","isValidElement","typedChild","hasOnClick","isMultiSelectable","cloneElement","Fragment","popoverWrapper","selecter","selecterLabel","selecterIcon","selecterIconOpen","join","popoverHolder","popoverHolderRecipe","visible","leftMobile","zIndex","transform","pointerEvents","header","closeButton","CloseIcon","LayoutSwitcher","onUpdateTimelineMode","LayoutIconMemo","activeTimelineMode","layoutOptions","alternating","changeLayoutOptions","horizontal_all","verticalItems","helpText","horizontalItems","changeLayout","QuickJump","activeItem","onActivateItem","ArrowDownIconMemo","jumpTo","label","ChangeDensity","onChange","selectedDensity","ParaIconMemo","changeDensity","getTextFromNode","String","TimelineToolbar","onRestartSlideshow","onActivateTimelineItem","onUpdateTextContentDensity","onSearchChange","onTriggerSearch","onClearSearch","onNextMatch","onPreviousMatch","totalMatches","onSearchKeyDown","timelineRef","onFullscreenError","stickyToolbar","quickJumpItems","isLeftDisabled","isRightDisabled","hideExtraControls","canShowDensity","every","cardDetailedText","handleInputChange","handleClearSearch","disableSearchNav","searchInfoId","veToolbarWrapper","sticky","Boolean","veNavigationGroup","veSearchGroup","hideOnMobile","veSearchWrapper","searchPlaceholder","searchAriaLabel","veSearchInput","veSearchButton","veSearchButtonIcon","veSearchControls","padding","margin","border","veSearchInfo","noSearchResults","previousMatch","nextMatch","ChevronRight","veActionGroup","veExtraControls","visibility","veExtraControlChild","modeString","FONT_WEIGHT_MAP","normalizeFontWeight","generateGoogleFontsUrl","weightSet","numericWeight","suffix","weightsParam","loadGoogleFonts","reject","fontUrl","link","preconnectStatic","generateFontCssVars","cssVars","elementType","elementConfig","prefix","FontProvider","fontLoaded","setFontLoaded","fontError","setFontError","then","console","warn","Object","documentElement","setProperty","removeProperty","containerStyle","TimelineItemTitle","classString","TITLE_CLASS","isHorizontalMode","cardTitleRecipe","hasMarginBottom","titleWrapper","textAlign","titleActive","useTimelineCard","autoScroll","iconChild","circleRef","wrapperRef","contentRef","circle","circleOffsetLeft","wrapperOffsetLeft","modeLower","containerClass","circleClass","canShowTimelineContent","TimelinePoint","usingIcon","shapeWrapper","timelinePoint","shape","hasIcon","background","iconBackgroundColor","primary","secondary","round","shallowEqual","obj1","obj2","keys1","keys2","arrayEqual","arr1","arr2","item1","item2","mediaEqual","media1","media2","useSlideshow","slideShowActive","onElapsed","timerRef","rafRef","startWidth","paused","setPaused","slideShowElapsed","remainInterval","setRemainInterval","isRunning","cleanupTimer","handleTimerComplete","setupTimer","interval","endTime","animationStep","tryPause","tryResume","remainingInterval","useMediaLoad","onMediaStateChange","loadFailed","setLoadFailed","mediaLoaded","setMediaLoaded","handleMediaLoaded","handleError","useYouTubeDetection","useToggleControls","expandDetails","setExpandDetails","showText","setShowText","toggleExpand","toggleText","useViewOptions","detailsText","canShowTextMemo","canShowTextContent","canExpand","gradientColor","canShowGradient","getCardHeight","LazyErrorMessage","VideoPlayer","videoRef","pause","cardVideo","playing","YoutubePlayer","iframeVideo","ImageDisplay","imageFit","imageWrapper","cardImage","imageVisible","imageHidden","imageRounded","objectFit","MediaContent","media","isYouTube","TitleMemoComponent","dir","fontSize","Tag","titleStyles","card","TitleMemo","ExpandButton","button","buttonIcon","ShowHideTextButton","ButtonWrapper","buttonWrapper","ShowOrHideTextButtonMemo","show","ExpandButtonMemo","expanded","onExpand","SubTitleMemo","subtitleStyles","cardSubtitleColor","arePropsEqual","expand","cardDetailsBackGround","DetailsTextMemo","Text","measureRef","detailsTextWrapper","ContentDisplayComponent","onDetailsTextRef","moreRef","isExpanded","setIsExpanded","showReadMore","setShowReadMore","toggleReadMore","checkOverflow","totalChildrenHeight","hasInternalOverflow","Array","from","childElement","childHeight","childScrollHeight","log","childTagName","childClassName","hasOverflow","hasDetailsText","hasContent","timeoutId1","timeoutId2","timeoutId3","resizeObserver","ResizeObserver","observe","disconnect","mediaDetailsWrapper","mediaDetailsAbsolute","mediaDetailsCard","mediaDetailsGradient","mediaDetailsMaximized","mediaDetailsExpanded","gradientVar","cardMediaHeader","cardTitleColor","titleColor","cardSubTitle","readMoreButton","ContentDisplay","CardMedia","slideshowActive","mediaWrapper","cardMedia","justifyEnd","justifyStart","minHeight","prevProps","nextProps","ContentFooter","showMore","textContentIsLarge","canShow","buttonClassName","iconWrapperClassName","canShowMore","showMoreButton","chevronIconWrapper","ContentHeader","isNotMedia","timelineCardHeader","fontWeight","lineHeight","renderTextArray","detailedText","cardTextClassName","dangerouslySetInnerHTML","__html","timelineSubContent","cardDetailsColor","substring","getTextOrContent","timelineContent","TextOrContent","isTextArray","isArray","shouldNotShowText","getTextContent","getTextContentProps","textContent","renderDetailedContent","textContentProps","timelineContentDetails","detailsColor","details","renderTimelineContent","DetailsText","customContent","contentDetailsClass","TextContent","contentDetailsWrapperRecipe","alignHorizontal","alignVertical","overflowY","cardBg","maxHeight","NestedTimelineCards","containerStyles","flexDirection","centerLineStyles","itemWrapperStyles","justifyContent","alignItems","cardContainerStyles","maxWidth","nestedCardBg","buttonBorder","borderRadius","boxShadow","nestedCardTitle","nestedCardSubtitle","getDetailsStyles","nestedCardDetails","linkStyles","marginTop","textDecoration","NestedTimelineRenderer","TimelineCardContent","onShowMore","flip","branchDir","isNested","focusable","setShowMore","progressRef","isFirstRender","hasBeenActivated","setHasBeenActivated","isResuming","setIsResuming","canShowProgressBar","canShowReadMore","canShowNestedTimeline","canShowDetailsText","handleMediaState","ended","handleCardClick","closest","toggleShowMore","triangleDir","cardBgColor","accessibleLabel","detailsTextComponent","cardMinHeight","baseCard","borderless","itemContentWrapper","contentDetailsWrapper","nestedTimelineWrapper","TimelineCardPortal","wrapperId","handleOnShowMore","Content","veCardWrapper","minWidth","Number","isFinite","transition","renderedPortal","getElementById","TimelineCard","formattedDetailedText","timelinePointProps","TimelineHorizontal","handleItemClick","contentDetailsChildren","iconChildren","propMode","propTheme","propLineWidth","contextTheme","contextMode","wrapperClass","toLowerCase","listRef","rovingItemsConfig","find","activePoint","iconChildColln","toArray","timelineItems","timelineItemWrapper","hasNestedItems","timelineHorizontalWrapper","onActive","contextDisableClickOnCircle","contextDisableInteraction","contextDisableAutoScrollOnClick","finalDisableClickOnCircle","finalDisableInteraction","finalDisableAutoScrollOnClick","canInvokeOnActive","clickHandlerProps","timelinePointLabel","timelinePointWrapper","timelinePointContainer","veShape","VerticalItem","alternateCards","calculateCardWidth","calculateJustifyContent","calculateCardOrder","calculatePointOrder","calculateEmptySpaceOrder","EmptySpace","emptySpaceOrder","order","flexShrink","flexGrow","handleOnActive","offset","handleShowMore","verticalItemClass","contentClass","TimelinePointMemo","accessibleTitle","verticalItemWrapper","alignment","verticalItemWrapperNested","timelineCardContentWrapper","timelineCardContentVisible","paddingLeft","paddingRight","timelineItemTitleWrapper","TimelineVertical","onOutlineSelection","wrapperOffset","renderItems","itemClassName","contentDetails","customIcon","TimelineVerticalItem","timelineVerticalWrapper","TimelineView","Timeline","onItemSelected","setHasFocus","setIsKeyboardNavigation","isSearchNavigationRef","keyboardTimeoutRef","handleFullscreenChange","isCurrentlyFullscreen","activeElement","firstItem","newOffSet","handleTimelineItemClickInternal","handleNextInternal","handlePreviousInternal","handleFirstInternal","handleLastInternal","clickedButton","currentTarget","handleToggleDarkMode","handleRestartSlideshow","handlePausedWrapper","wrappedOnActivateTimelineItem","wrappedOnUpdateTimelineMode","wrappedOnUpdateTextContentDensity","isToolbarFocused","cardContainer","verticalRow","wrappedOnTimelineUpdated","wrappedHandleTimelineItemClick","toLocaleLowerCase","ve","canShowToolbar","evt","contains","handleBlur","relatedTarget","shouldFocus","isInitialRender","cardRect","contentRect","cardLeft","contentWidth","contentLeft","scrollBehavior","point","scrollIntoView","behavior","inline","block","wrapperHeight","timelineHeight","searchWidthVars","inputWidth","inputMaxWidth","darkThemeClass","lightThemeClass","_error","TimelineErrorBoundary","Component","constructor","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","handleReset","setState","render","fallback","errorBoundaryContainer","errorTitle","retryButton","toReactArray","convertToLegacyProps","allowDynamicUpdate","data","mapNewModeToLegacy","pointSize","responsive","breakpoint","mapNewCardPositionToLegacy","positioning","cardPosition","interaction","keyboardNavigation","pointClick","cardHover","allowHTML","readMore","dateFormat","compactText","subtitle","cardsDisabled","pointsDisabled","pointShape","allCardsVisible","toolbar","animation","slideshow","mapNewSlideshowTypeToLegacy","showProgress","showOverallProgress","i18n","showToggle","Chrono","inputProps","process","env","NODE_ENV","validationResult","success","path","timeLineItems","setTimeLineItems","timeLineItemsRef","setSlideShowActive","setActiveTimelineItem","previousActiveItemIndexRef","itemsHashRef","processedItemsCache","lastOriginalItemsRef","scrollPositionRef","childrenCount","count","initItems","lineItems","_dayjs","date","subItem","itemLength","updateItems","existingItems","existingItemsMap","idx","existingItem","getHashableValue","createItemsHash","_items","newItems","currentChildrenHash","currentHash","timelineElement","previousItemsLength","isTrulyAppended","previousOriginalSlice","newItemsSlice","slice","previousHash","newHash","validActiveIndex","updatedElement","maxScrollLeft","scrollWidth","maxScrollTop","actvTimelineIndex","some","restartSlideShow","handleOnNext","newTimeLineItem","handleOnPrevious","handleOutlineSelection","iconChildArray","timelineBgColor","textColor"],"mappings":"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","x_google_ignoreList":[1,2,3,4,5,6,7,8,9,10,14,15,22,25,26,27]}